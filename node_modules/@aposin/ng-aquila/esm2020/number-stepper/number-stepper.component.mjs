import { coerceBooleanProperty } from '@angular/cdk/coercion';
import { ChangeDetectionStrategy, Component, EventEmitter, forwardRef, Input, Output, ViewChild, } from '@angular/core';
import { NG_VALIDATORS, NG_VALUE_ACCESSOR } from '@angular/forms';
import { MappedStyles } from '@aposin/ng-aquila/core';
import { mapClassNames, pad } from '@aposin/ng-aquila/utils';
import { Decimal } from 'decimal.js';
import { Subject } from 'rxjs';
import { takeUntil } from 'rxjs/operators';
import { NxAutoResizeDirective } from './auto-resize.directive';
import * as i0 from "@angular/core";
import * as i1 from "./number-stepper-intl";
import * as i2 from "@aposin/ng-aquila/button";
import * as i3 from "@aposin/ng-aquila/icon";
import * as i4 from "@angular/common";
import * as i5 from "./auto-resize.directive";
const SIZE_MAPPING = {
    big: 'nx-stepper--big',
    normal: '',
};
const DEFAULT_CLASSES = ['nx-stepper'];
const INPUT_CLASSES = ['nx-stepper__input'];
const ALLOWED_CHARACTERS = new RegExp(/^-?\d+(\.\d+)?$/g);
const CUSTOM_VALUE_ACCESSOR = {
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef(() => NxNumberStepperComponent),
    multi: true,
};
const CUSTOM_VALIDATOR = {
    provide: NG_VALIDATORS,
    useExisting: forwardRef(() => NxNumberStepperComponent),
    multi: true,
};
let nextUniqueId = 0;
/**
 * `Input('nxSize') classNames` defines the size of the number stepper.
 * Values: big | normal. Default: normal
 */
export class NxNumberStepperComponent extends MappedStyles {
    constructor(_cdr, _renderer, _elementRef, _intl) {
        super(SIZE_MAPPING, _elementRef, _renderer, DEFAULT_CLASSES);
        this._cdr = _cdr;
        this._intl = _intl;
        this._step = 1;
        this._min = 0;
        this._max = 100;
        this._value = 0;
        this._incrementAriaLabel = '';
        this._decrementAriaLabel = '';
        this._inputAriaLabel = '';
        this._resize = false;
        this._negative = false;
        this._leadingZero = true;
        this._disabled = false;
        /** @docs-private */
        this.inputClassNames = mapClassNames('regular', INPUT_CLASSES);
        /** @docs-private */
        this.inputId = `nx-number-stepper-${nextUniqueId++}`;
        /** @docs-private */
        this.ariaDescribedBy = null;
        /** An event emitted on value change. */
        this.valueChange = new EventEmitter();
        this._destroyed = new Subject();
        this.onChangeCallback = () => { };
        /** @docs-private */
        this.onTouchedCallback = () => { };
        this._intl.changes.pipe(takeUntil(this._destroyed)).subscribe(() => this._cdr.markForCheck());
    }
    /** Whether the input should be resized. Default: false */
    set resize(value) {
        this._resize = coerceBooleanProperty(value);
        this._cdr.markForCheck();
    }
    get resize() {
        return this._resize;
    }
    get label() {
        return this._label;
    }
    /** Defines the the label shown above the stepper input. */
    set label(value) {
        if (this._label !== value) {
            this._label = value;
            this._cdr.markForCheck();
        }
    }
    /** Sets the aria-label for the increment button. */
    set incrementAriaLabel(value) {
        this._incrementAriaLabel = value;
    }
    get incrementAriaLabel() {
        return this._incrementAriaLabel;
    }
    /** Sets the aria-label for the decrement button. */
    set decrementAriaLabel(value) {
        this._decrementAriaLabel = value;
    }
    get decrementAriaLabel() {
        return this._decrementAriaLabel;
    }
    /** Sets the aria-label for the input of the number stepper. */
    set inputAriaLabel(value) {
        this._inputAriaLabel = value;
    }
    get inputAriaLabel() {
        return this._inputAriaLabel;
    }
    /** Sets the step size. Default: 1 */
    set step(value) {
        // only internal changes no need to call markForCheck
        this._step = Number(value);
    }
    get step() {
        return this._step;
    }
    /** Sets the minimum accepted number. Default: 0 */
    set min(value) {
        this._min = Number(value);
    }
    get min() {
        return this._min;
    }
    /** Sets the maximum accepted number. Default: 100 */
    set max(value) {
        this._max = Number(value);
    }
    get max() {
        return this._max;
    }
    get value() {
        return this._value;
    }
    /** Sets the value of the number-stepper. */
    set value(value) {
        this._value = value;
        if (this._value) {
            this.setInputValue(this._value);
        }
        else {
            this.setInputValue(0);
        }
        this._cdr.markForCheck();
    }
    /** Whether the negative set of styling should be used. */
    set negative(value) {
        if (this._negative !== value) {
            this._negative = coerceBooleanProperty(value);
            this._cdr.markForCheck();
        }
    }
    get negative() {
        return this._negative;
    }
    /** Whether the number stepper value should have a leading zero.
     *
     * Default value is true.
     */
    set leadingZero(value) {
        if (this._leadingZero !== value) {
            this._leadingZero = coerceBooleanProperty(value);
            this.setInputValue(this.value);
            this._cdr.markForCheck();
        }
    }
    get leadingZero() {
        return this._leadingZero;
    }
    /** Whether the user input in the number stepper should be disabled.
     *
     * Default value is false.
     */
    set disabled(value) {
        this._disabled = coerceBooleanProperty(value);
    }
    get disabled() {
        return this._disabled;
    }
    ngAfterViewInit() {
        if (this.ngContentWrapper) {
            this.ariaDescribedBy = this.ngContentWrapper.nativeElement.children.length > 0 ? `label-for-${this.inputId}` : '';
        }
        this.setInputValue(this._value);
    }
    ngOnDestroy() {
        this._destroyed.next();
        this._destroyed.complete();
    }
    /** @docs-private */
    setInputValue(value) {
        const parsedValue = value ? value : 0;
        if (this.leadingZero) {
            this.numberInputValue = pad(parsedValue.toString(), 2);
        }
        else {
            this.numberInputValue = parsedValue.toString();
        }
        if (this.nativeInput) {
            // update the native input value with the transformed value.
            this.nativeInput.nativeElement.value = this.numberInputValue;
        }
        // use timeout to get the current value of numberInputValue
        setTimeout(() => {
            this.triggerResize();
        });
    }
    /* ControlValueAccessor Implementations */
    writeValue(value) {
        this.value = value;
    }
    registerOnChange(onChange) {
        this.onChangeCallback = onChange;
    }
    registerOnTouched(onTouched) {
        this.onTouchedCallback = onTouched;
    }
    /**
     * Disables the stepper. Part of the ControlValueAccessor interface required
     * to integrate with Angular's core forms API.
     *
     * @param isDisabled Sets whether the component is disabled.
     */
    setDisabledState(isDisabled) {
        this._disabled = isDisabled;
        this._cdr.markForCheck();
    }
    /** @docs-private */
    onInputChange(event) {
        if (this.validateUserInput(event.target.value)) {
            this._value = Number(event.target.value);
        }
        else {
            this._value = null;
        }
        // setInputValue() should be called so that numberInputValue is updated with the user input
        if (this._value !== null) {
            this.setInputValue(this._value);
        }
        this.valueChange.emit(this._value);
        this.onChangeCallback(this._value);
    }
    /** @docs-private */
    validateUserInput(input) {
        return !!input.match(ALLOWED_CHARACTERS);
    }
    /** @docs-private */
    incrementOnClick() {
        this._increment();
        this.onTouchedCallback();
    }
    /** @docs-private */
    incrementOnKey(event) {
        this._increment();
        event.preventDefault();
    }
    /** @docs-private */
    _increment() {
        let newValue;
        if (this.isBetweenLimits(this._value || 0)) {
            newValue = this.getNextGreaterValue(this._value || 0);
        }
        else {
            newValue = this.enforceLimits(this._value || 0);
        }
        this.value = newValue;
        this.setInputValue(this.value);
        this.valueChange.emit(this._value);
        this.onChangeCallback(this._value);
    }
    /** @docs-private */
    triggerResize() {
        if (this.resize) {
            this.autoResize.updateInputWidth();
            this._cdr.markForCheck();
        }
    }
    /** @docs-private */
    decrementOnClick() {
        this._decrement();
        this.onTouchedCallback();
    }
    /** @docs-private */
    decrementOnKey(event) {
        this._decrement();
        event.preventDefault();
    }
    /** @docs-private */
    _decrement() {
        let newValue;
        if (this.isBetweenLimits(this._value || 0)) {
            newValue = this.getNextLowerValue(this._value || 0);
        }
        else {
            newValue = this.enforceLimits(this._value || 0);
        }
        this.value = newValue;
        this.setInputValue(this.value);
        this.valueChange.emit(this._value);
        this.onChangeCallback(this._value);
    }
    /** @docs-private */
    enforceLimits(value) {
        if (value > this._max) {
            return this._max;
        }
        else if (value < this._min) {
            return this._min;
        }
        return value;
    }
    /** @docs-private */
    getNextLowerValue(start) {
        // if there is an invalid input start is null
        if (!start) {
            start = 0;
        }
        let next;
        if (this.isValidStep(start)) {
            next = new Decimal(start).minus(new Decimal(this._step)).toNumber();
        }
        else {
            next = new Decimal(start).toNearest(this._step, Decimal.ROUND_DOWN).toNumber();
        }
        return this.enforceLimits(next);
    }
    /** @docs-private */
    getNextGreaterValue(start) {
        let next;
        if (!start) {
            start = 0;
        }
        if (this.isValidStep(start)) {
            next = new Decimal(start).plus(new Decimal(this._step)).toNumber();
        }
        else {
            next = new Decimal(start).toNearest(this._step, Decimal.ROUND_UP).toNumber();
        }
        return this.enforceLimits(next);
    }
    /** @docs-private */
    isBetweenLimits(value) {
        return value <= this._max && value >= this._min;
    }
    /** @docs-private */
    isMinimum() {
        return this._value === this._min;
    }
    /** @docs-private */
    isMaximum() {
        return this._value === this._max;
    }
    /** @docs-private */
    isValidStep(value) {
        if (value === null) {
            value = new Decimal(0);
        }
        const min = new Decimal(this._min);
        const valueDec = new Decimal(value);
        const checkValue = min.minus(valueDec).mod(new Decimal(this._step)).toNumber();
        if (this.isBetweenLimits(value) && (this.isMinimum() || this.isMaximum() || checkValue === 0)) {
            return true;
        }
        return false;
    }
    /** @docs-private */
    userInputToNumber(value) {
        return parseInt(value, 10) || 0;
    }
    _validateFn() {
        // the manual user input must match min + n * step, e.g. minimum 1 step 2: 1, 3, 5, 7 etc.
        if (!this.isValidStep(this._value)) {
            return { nxNumberStepperStepError: 'Value is not a valid step' };
        }
        else if (this._value === null) {
            return { nxNumberStepperFormatError: 'Not a valid number' };
        }
        return null;
    }
    /** @docs-private */
    validate(c) {
        return this._validateFn();
    }
    get _buttonType() {
        return 'secondary' + (this.negative ? ' negative' : '');
    }
}
NxNumberStepperComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.3.1", ngImport: i0, type: NxNumberStepperComponent, deps: [{ token: i0.ChangeDetectorRef }, { token: i0.Renderer2 }, { token: i0.ElementRef }, { token: i1.NxNumberStepperIntl }], target: i0.ɵɵFactoryTarget.Component });
NxNumberStepperComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.3.1", type: NxNumberStepperComponent, selector: "nx-number-stepper", inputs: { classNames: ["nxSize", "classNames"], resize: ["nxResize", "resize"], label: ["nxLabel", "label"], incrementAriaLabel: "incrementAriaLabel", decrementAriaLabel: "decrementAriaLabel", inputAriaLabel: "inputAriaLabel", step: ["nxStep", "step"], min: ["nxMin", "min"], max: ["nxMax", "max"], value: ["nxValue", "value"], negative: "negative", leadingZero: "leadingZero", disabled: ["nxDisabled", "disabled"] }, outputs: { valueChange: "nxValueChange" }, host: { properties: { "class.is-negative": "negative", "class.is-disabled": "disabled" } }, providers: [CUSTOM_VALUE_ACCESSOR, CUSTOM_VALIDATOR], viewQueries: [{ propertyName: "ngContentWrapper", first: true, predicate: ["customLabel"], descendants: true }, { propertyName: "autoResize", first: true, predicate: NxAutoResizeDirective, descendants: true, static: true }, { propertyName: "nativeInput", first: true, predicate: ["nativeInput"], descendants: true }], usesInheritance: true, ngImport: i0, template: "<div *ngIf=\"label\" class=\"nx-stepper__label\">\n    <label [for]=\"inputId\">\n        {{ label }}\n    </label>\n</div>\n<div class=\"nx-stepper__label\" #customLabel *ngIf=\"!label\" [id]=\"ariaDescribedBy\">\n    <ng-content></ng-content>\n</div>\n<div class=\"nx-stepper__input-container\">\n    <button\n        [attr.aria-label]=\"decrementAriaLabel || _intl.decrementAriaLabel\"\n        [nxButton]=\"_buttonType\"\n        class=\"nx-stepper__down nx-stepper__control\"\n        (click)=\"decrementOnClick()\"\n        [disabled]=\"disabled || (value || 0) <= min\"\n        type=\"button\"\n    >\n        <nx-icon name=\"minus\" size=\"s\"></nx-icon>\n    </button>\n    <div class=\"nx-stepper__input-wrapper\">\n        <div class=\"nx-stepper__inner-wrapper\">\n            <ng-content select=\"nx-number-stepper-prefix\"></ng-content>\n\n            <input\n                type=\"number\"\n                [nxAutoResize]=\"resize\"\n                [attr.aria-describedby]=\"ariaDescribedBy\"\n                [attr.aria-label]=\"inputAriaLabel\"\n                [id]=\"inputId\"\n                [ngClass]=\"inputClassNames\"\n                (input)=\"onInputChange($event)\"\n                (blur)=\"onTouchedCallback()\"\n                (keydown.arrowup)=\"incrementOnKey($event)\"\n                (keydown.arrowdown)=\"decrementOnKey($event)\"\n                #nativeInput\n                spellcheck=\"false\"\n                [disabled]=\"disabled\"\n            />\n\n            <ng-content select=\"nx-number-stepper-suffix\"></ng-content>\n        </div>\n        <div class=\"nx-stepper__input-underline\"></div>\n    </div>\n\n    <button\n        [attr.aria-label]=\"incrementAriaLabel || _intl.incrementAriaLabel\"\n        [nxButton]=\"_buttonType\"\n        class=\"nx-stepper__up nx-stepper__control\"\n        (click)=\"incrementOnClick()\"\n        [disabled]=\"disabled || (value || 0) >= max\"\n        type=\"button\"\n    >\n        <nx-icon name=\"plus\" size=\"s\"></nx-icon>\n    </button>\n</div>\n", styles: [":host{display:block}:host input::-webkit-outer-spin-button,:host input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}:host input[type=number]{-moz-appearance:textfield}:host input[type=number]:invalid{box-shadow:none}:host label:not(:empty)+.nx-stepper__input-container,:host .nx-stepper__label:not(:empty)+.nx-stepper__input-container{margin-top:12px}:host input{padding:0}.nx-stepper__input-container{align-items:flex-end;display:flex}.nx-stepper__label{display:flex;font-size:var(--number-stepper-label-font-size);line-height:var(--number-stepper-label-line-height);font-weight:var(--number-stepper-label-font-weight);letter-spacing:var(--number-stepper-label-letter-spacing)}.nx-stepper__control{width:32px;height:32px;min-height:32px;font-size:24px;margin:0;padding:0}.nx-stepper__input{width:56px;min-width:56px}.nx-stepper__input:disabled{color:var(--number-stepper-disabled-color);-webkit-text-fill-color:var(--number-stepper-disabled-color);cursor:not-allowed}.nx-stepper__input,::ng-deep .nx-stepper__prefix,::ng-deep .nx-stepper__suffix{font-size:var(--number-stepper-small-font-size);line-height:var(--number-stepper-small-line-height);font-weight:var(--number-stepper-small-font-weight);letter-spacing:var(--number-stepper-small-letter-spacing);color:var(--number-stepper-color);background:0 0;outline:0;border:0;text-align:center}::ng-deep .nx-stepper__suffix{margin-left:4px}:host-context([dir=rtl]) ::ng-deep .nx-stepper__suffix{margin-left:0;margin-left:initial;margin-right:4px}::ng-deep .nx-stepper__prefix{margin-right:4px}:host-context([dir=rtl]) ::ng-deep .nx-stepper__prefix{margin-right:0;margin-right:initial;margin-left:4px}.nx-stepper__input-wrapper{display:flex;align-items:center;flex-direction:column;margin:0 16px}.nx-stepper__inner-wrapper{height:28px;display:flex;align-items:baseline}.nx-stepper__input-underline{width:100%;margin-top:2px;height:2px;background:var(--number-stepper-underline-color)}.nx-stepper__input-underline--disabled{background:var(--number-stepper-disabled-underline-color)}:host.nx-stepper--big .nx-stepper__control{width:72px;min-height:48px;margin-bottom:0}:host.nx-stepper--big .nx-stepper__input{width:72px;min-width:72px}:host.nx-stepper--big .nx-stepper__input,:host.nx-stepper--big ::ng-deep .nx-stepper__prefix,:host.nx-stepper--big ::ng-deep .nx-stepper__suffix{font-size:var(--number-stepper-large-font-size);line-height:var(--number-stepper-large-line-height);font-weight:var(--number-stepper-large-font-weight);letter-spacing:var(--number-stepper-large-letter-spacing);height:48px;padding:0;margin-bottom:0}:host.nx-stepper--big .nx-stepper__input-wrapper{margin:0 24px}:host.nx-stepper--big .nx-stepper__input-underline{margin-top:-nx-spacer(4xs)}:host.nx-stepper--big .nx-stepper__inner-wrapper{height:48px}:host.is-negative .nx-stepper__label,:host.is-negative ::ng-deep .nx-stepper__prefix,:host.is-negative ::ng-deep .nx-stepper__suffix{color:var(--negative)}:host.is-negative .nx-stepper__input{color:var(--negative)}:host.is-negative .nx-stepper__input-underline{background:var(--negative)}:host.is-disabled .nx-stepper__input-underline{background:var(--number-stepper-disabled-underline-color)}:host.is-disabled ::ng-deep .nx-stepper__prefix,:host.is-disabled ::ng-deep .nx-stepper__suffix{color:var(--number-stepper-disabled-color)}@media screen and (-ms-high-contrast: active){button.nx-stepper__control:disabled{border-color:GrayText;color:GrayText;opacity:1}.nx-stepper__input{color:buttonText}.nx-stepper__input:disabled{color:GrayText;-webkit-text-fill-color:GrayText}::ng-deep .nx-stepper__prefix,::ng-deep .nx-stepper__suffix,:host.nx-stepper--big ::ng-deep .nx-stepper__prefix,:host.nx-stepper--big ::ng-deep .nx-stepper__suffix{-ms-high-contrast-adjust:none;color:windowText}.nx-stepper__inner-wrapper{background:buttonFace}.nx-stepper__input-underline,:host.is-negative .nx-stepper__input-underline{background:buttonText}:host.is-disabled .nx-stepper__input-underline{background:GrayText}:host.is-disabled ::ng-deep .nx-stepper__prefix,:host.is-disabled ::ng-deep .nx-stepper__suffix{color:GrayText}}\n"], components: [{ type: i2.NxButtonComponent, selector: "button[nxButton]", inputs: ["nxButton"] }, { type: i3.NxIconComponent, selector: "nx-icon", inputs: ["name", "outline", "fill", "size", "font"] }], directives: [{ type: i4.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i5.NxAutoResizeDirective, selector: "input[nxAutoResize]", inputs: ["nxAutoResize"] }, { type: i4.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.3.1", ngImport: i0, type: NxNumberStepperComponent, decorators: [{
            type: Component,
            args: [{ selector: 'nx-number-stepper', changeDetection: ChangeDetectionStrategy.OnPush, inputs: ['classNames: nxSize'], host: {
                        '[class.is-negative]': 'negative',
                        '[class.is-disabled]': 'disabled',
                    }, providers: [CUSTOM_VALUE_ACCESSOR, CUSTOM_VALIDATOR], template: "<div *ngIf=\"label\" class=\"nx-stepper__label\">\n    <label [for]=\"inputId\">\n        {{ label }}\n    </label>\n</div>\n<div class=\"nx-stepper__label\" #customLabel *ngIf=\"!label\" [id]=\"ariaDescribedBy\">\n    <ng-content></ng-content>\n</div>\n<div class=\"nx-stepper__input-container\">\n    <button\n        [attr.aria-label]=\"decrementAriaLabel || _intl.decrementAriaLabel\"\n        [nxButton]=\"_buttonType\"\n        class=\"nx-stepper__down nx-stepper__control\"\n        (click)=\"decrementOnClick()\"\n        [disabled]=\"disabled || (value || 0) <= min\"\n        type=\"button\"\n    >\n        <nx-icon name=\"minus\" size=\"s\"></nx-icon>\n    </button>\n    <div class=\"nx-stepper__input-wrapper\">\n        <div class=\"nx-stepper__inner-wrapper\">\n            <ng-content select=\"nx-number-stepper-prefix\"></ng-content>\n\n            <input\n                type=\"number\"\n                [nxAutoResize]=\"resize\"\n                [attr.aria-describedby]=\"ariaDescribedBy\"\n                [attr.aria-label]=\"inputAriaLabel\"\n                [id]=\"inputId\"\n                [ngClass]=\"inputClassNames\"\n                (input)=\"onInputChange($event)\"\n                (blur)=\"onTouchedCallback()\"\n                (keydown.arrowup)=\"incrementOnKey($event)\"\n                (keydown.arrowdown)=\"decrementOnKey($event)\"\n                #nativeInput\n                spellcheck=\"false\"\n                [disabled]=\"disabled\"\n            />\n\n            <ng-content select=\"nx-number-stepper-suffix\"></ng-content>\n        </div>\n        <div class=\"nx-stepper__input-underline\"></div>\n    </div>\n\n    <button\n        [attr.aria-label]=\"incrementAriaLabel || _intl.incrementAriaLabel\"\n        [nxButton]=\"_buttonType\"\n        class=\"nx-stepper__up nx-stepper__control\"\n        (click)=\"incrementOnClick()\"\n        [disabled]=\"disabled || (value || 0) >= max\"\n        type=\"button\"\n    >\n        <nx-icon name=\"plus\" size=\"s\"></nx-icon>\n    </button>\n</div>\n", styles: [":host{display:block}:host input::-webkit-outer-spin-button,:host input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}:host input[type=number]{-moz-appearance:textfield}:host input[type=number]:invalid{box-shadow:none}:host label:not(:empty)+.nx-stepper__input-container,:host .nx-stepper__label:not(:empty)+.nx-stepper__input-container{margin-top:12px}:host input{padding:0}.nx-stepper__input-container{align-items:flex-end;display:flex}.nx-stepper__label{display:flex;font-size:var(--number-stepper-label-font-size);line-height:var(--number-stepper-label-line-height);font-weight:var(--number-stepper-label-font-weight);letter-spacing:var(--number-stepper-label-letter-spacing)}.nx-stepper__control{width:32px;height:32px;min-height:32px;font-size:24px;margin:0;padding:0}.nx-stepper__input{width:56px;min-width:56px}.nx-stepper__input:disabled{color:var(--number-stepper-disabled-color);-webkit-text-fill-color:var(--number-stepper-disabled-color);cursor:not-allowed}.nx-stepper__input,::ng-deep .nx-stepper__prefix,::ng-deep .nx-stepper__suffix{font-size:var(--number-stepper-small-font-size);line-height:var(--number-stepper-small-line-height);font-weight:var(--number-stepper-small-font-weight);letter-spacing:var(--number-stepper-small-letter-spacing);color:var(--number-stepper-color);background:0 0;outline:0;border:0;text-align:center}::ng-deep .nx-stepper__suffix{margin-left:4px}:host-context([dir=rtl]) ::ng-deep .nx-stepper__suffix{margin-left:0;margin-left:initial;margin-right:4px}::ng-deep .nx-stepper__prefix{margin-right:4px}:host-context([dir=rtl]) ::ng-deep .nx-stepper__prefix{margin-right:0;margin-right:initial;margin-left:4px}.nx-stepper__input-wrapper{display:flex;align-items:center;flex-direction:column;margin:0 16px}.nx-stepper__inner-wrapper{height:28px;display:flex;align-items:baseline}.nx-stepper__input-underline{width:100%;margin-top:2px;height:2px;background:var(--number-stepper-underline-color)}.nx-stepper__input-underline--disabled{background:var(--number-stepper-disabled-underline-color)}:host.nx-stepper--big .nx-stepper__control{width:72px;min-height:48px;margin-bottom:0}:host.nx-stepper--big .nx-stepper__input{width:72px;min-width:72px}:host.nx-stepper--big .nx-stepper__input,:host.nx-stepper--big ::ng-deep .nx-stepper__prefix,:host.nx-stepper--big ::ng-deep .nx-stepper__suffix{font-size:var(--number-stepper-large-font-size);line-height:var(--number-stepper-large-line-height);font-weight:var(--number-stepper-large-font-weight);letter-spacing:var(--number-stepper-large-letter-spacing);height:48px;padding:0;margin-bottom:0}:host.nx-stepper--big .nx-stepper__input-wrapper{margin:0 24px}:host.nx-stepper--big .nx-stepper__input-underline{margin-top:-nx-spacer(4xs)}:host.nx-stepper--big .nx-stepper__inner-wrapper{height:48px}:host.is-negative .nx-stepper__label,:host.is-negative ::ng-deep .nx-stepper__prefix,:host.is-negative ::ng-deep .nx-stepper__suffix{color:var(--negative)}:host.is-negative .nx-stepper__input{color:var(--negative)}:host.is-negative .nx-stepper__input-underline{background:var(--negative)}:host.is-disabled .nx-stepper__input-underline{background:var(--number-stepper-disabled-underline-color)}:host.is-disabled ::ng-deep .nx-stepper__prefix,:host.is-disabled ::ng-deep .nx-stepper__suffix{color:var(--number-stepper-disabled-color)}@media screen and (-ms-high-contrast: active){button.nx-stepper__control:disabled{border-color:GrayText;color:GrayText;opacity:1}.nx-stepper__input{color:buttonText}.nx-stepper__input:disabled{color:GrayText;-webkit-text-fill-color:GrayText}::ng-deep .nx-stepper__prefix,::ng-deep .nx-stepper__suffix,:host.nx-stepper--big ::ng-deep .nx-stepper__prefix,:host.nx-stepper--big ::ng-deep .nx-stepper__suffix{-ms-high-contrast-adjust:none;color:windowText}.nx-stepper__inner-wrapper{background:buttonFace}.nx-stepper__input-underline,:host.is-negative .nx-stepper__input-underline{background:buttonText}:host.is-disabled .nx-stepper__input-underline{background:GrayText}:host.is-disabled ::ng-deep .nx-stepper__prefix,:host.is-disabled ::ng-deep .nx-stepper__suffix{color:GrayText}}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.Renderer2 }, { type: i0.ElementRef }, { type: i1.NxNumberStepperIntl }]; }, propDecorators: { ngContentWrapper: [{
                type: ViewChild,
                args: ['customLabel']
            }], autoResize: [{
                type: ViewChild,
                args: [NxAutoResizeDirective, { static: true }]
            }], nativeInput: [{
                type: ViewChild,
                args: ['nativeInput']
            }], valueChange: [{
                type: Output,
                args: ['nxValueChange']
            }], resize: [{
                type: Input,
                args: ['nxResize']
            }], label: [{
                type: Input,
                args: ['nxLabel']
            }], incrementAriaLabel: [{
                type: Input
            }], decrementAriaLabel: [{
                type: Input
            }], inputAriaLabel: [{
                type: Input
            }], step: [{
                type: Input,
                args: ['nxStep']
            }], min: [{
                type: Input,
                args: ['nxMin']
            }], max: [{
                type: Input,
                args: ['nxMax']
            }], value: [{
                type: Input,
                args: ['nxValue']
            }], negative: [{
                type: Input
            }], leadingZero: [{
                type: Input
            }], disabled: [{
                type: Input,
                args: ['nxDisabled']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibnVtYmVyLXN0ZXBwZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvbmctYXF1aWxhL3NyYy9udW1iZXItc3RlcHBlci9udW1iZXItc3RlcHBlci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi9wcm9qZWN0cy9uZy1hcXVpbGEvc3JjL251bWJlci1zdGVwcGVyL251bWJlci1zdGVwcGVyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBZ0IscUJBQXFCLEVBQWUsTUFBTSx1QkFBdUIsQ0FBQztBQUN6RixPQUFPLEVBRUgsdUJBQXVCLEVBRXZCLFNBQVMsRUFFVCxZQUFZLEVBQ1osVUFBVSxFQUNWLEtBQUssRUFFTCxNQUFNLEVBRU4sU0FBUyxHQUNaLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBcUMsYUFBYSxFQUFFLGlCQUFpQixFQUFhLE1BQU0sZ0JBQWdCLENBQUM7QUFDaEgsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ3RELE9BQU8sRUFBRSxhQUFhLEVBQUUsR0FBRyxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDN0QsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFlBQVksQ0FBQztBQUNyQyxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQy9CLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUUzQyxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQzs7Ozs7OztBQUdoRSxNQUFNLFlBQVksR0FBRztJQUNqQixHQUFHLEVBQUUsaUJBQWlCO0lBQ3RCLE1BQU0sRUFBRSxFQUFFO0NBQ2IsQ0FBQztBQUNGLE1BQU0sZUFBZSxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDdkMsTUFBTSxhQUFhLEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO0FB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QUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtnQkFHeEIsV0FBVztzQkFBcEMsU0FBUzt1QkFBQyxhQUFhO2dCQUdDLFdBQVc7c0JBQW5DLE1BQU07dUJBQUMsZUFBZTtnQkFJbkIsTUFBTTtzQkFEVCxLQUFLO3VCQUFDLFVBQVU7Z0JBZWIsS0FBSztzQkFEUixLQUFLO3VCQUFDLFNBQVM7Z0JBVVosa0JBQWtCO3NCQURyQixLQUFLO2dCQVdGLGtCQUFrQjtzQkFEckIsS0FBSztnQkFXRixjQUFjO3NCQURqQixLQUFLO2dCQVdGLElBQUk7c0JBRFAsS0FBSzt1QkFBQyxRQUFRO2dCQVlYLEdBQUc7c0JBRE4sS0FBSzt1QkFBQyxPQUFPO2dCQVdWLEdBQUc7c0JBRE4sS0FBSzt1QkFBQyxPQUFPO2dCQWVWLEtBQUs7c0JBRFIsS0FBSzt1QkFBQyxTQUFTO2dCQWFaLFFBQVE7c0JBRFgsS0FBSztnQkFnQkYsV0FBVztzQkFEZCxLQUFLO2dCQWlCRixRQUFRO3NCQURYLEtBQUs7dUJBQUMsWUFBWSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJvb2xlYW5JbnB1dCwgY29lcmNlQm9vbGVhblByb3BlcnR5LCBOdW1iZXJJbnB1dCB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9jb2VyY2lvbic7XG5pbXBvcnQge1xuICAgIEFmdGVyVmlld0luaXQsXG4gICAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gICAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgQ29tcG9uZW50LFxuICAgIEVsZW1lbnRSZWYsXG4gICAgRXZlbnRFbWl0dGVyLFxuICAgIGZvcndhcmRSZWYsXG4gICAgSW5wdXQsXG4gICAgT25EZXN0cm95LFxuICAgIE91dHB1dCxcbiAgICBSZW5kZXJlcjIsXG4gICAgVmlld0NoaWxkLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBGb3JtQ29udHJvbCwgTkdfVkFMSURBVE9SUywgTkdfVkFMVUVfQUNDRVNTT1IsIFZhbGlkYXRvciB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7IE1hcHBlZFN0eWxlcyB9IGZyb20gJ0BhcG9zaW4vbmctYXF1aWxhL2NvcmUnO1xuaW1wb3J0IHsgbWFwQ2xhc3NOYW1lcywgcGFkIH0gZnJvbSAnQGFwb3Npbi9uZy1hcXVpbGEvdXRpbHMnO1xuaW1wb3J0IHsgRGVjaW1hbCB9IGZyb20gJ2RlY2ltYWwuanMnO1xuaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgdGFrZVVudGlsIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5pbXBvcnQgeyBOeEF1dG9SZXNpemVEaXJlY3RpdmUgfSBmcm9tICcuL2F1dG8tcmVzaXplLmRpcmVjdGl2ZSc7XG5pbXBvcnQgeyBOeE51bWJlclN0ZXBwZXJJbnRsIH0gZnJvbSAnLi9udW1iZXItc3RlcHBlci1pbnRsJztcblxuY29uc3QgU0laRV9NQVBQSU5HID0ge1xuICAgIGJpZzogJ254LXN0ZXBwZXItLWJpZycsXG4gICAgbm9ybWFsOiAnJyxcbn07XG5jb25zdCBERUZBVUxUX0NMQVNTRVMgPSBbJ254LXN0ZXBwZXInXTtcbmNvbnN0IElOUFVUX0NMQVNTRVMgPSBbJ254LXN0ZXBwZXJfX2lucHV0J107XG5cbmNvbnN0IEFMTE9XRURfQ0hBUkFDVEVSUyA9IG5ldyBSZWdFeHAoL14tP1xcZCsoXFwuXFxkKyk/JC9nKTtcbmNvbnN0IENVU1RPTV9WQUxVRV9BQ0NFU1NPUiA9IHtcbiAgICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcbiAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBOeE51bWJlclN0ZXBwZXJDb21wb25lbnQpLFxuICAgIG11bHRpOiB0cnVlLFxufTtcbmNvbnN0IENVU1RPTV9WQUxJREFUT1IgPSB7XG4gICAgcHJvdmlkZTogTkdfVkFMSURBVE9SUyxcbiAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBOeE51bWJlclN0ZXBwZXJDb21wb25lbnQpLFxuICAgIG11bHRpOiB0cnVlLFxufTtcblxubGV0IG5leHRVbmlxdWVJZCA9IDA7XG5cbi8qKlxuICogYElucHV0KCdueFNpemUnKSBjbGFzc05hbWVzYCBkZWZpbmVzIHRoZSBzaXplIG9mIHRoZSBudW1iZXIgc3RlcHBlci5cbiAqIFZhbHVlczogYmlnIHwgbm9ybWFsLiBEZWZhdWx0OiBub3JtYWxcbiAqL1xuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdueC1udW1iZXItc3RlcHBlcicsXG4gICAgdGVtcGxhdGVVcmw6ICdudW1iZXItc3RlcHBlci5jb21wb25lbnQuaHRtbCcsXG4gICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gICAgc3R5bGVVcmxzOiBbJ251bWJlci1zdGVwcGVyLmNvbXBvbmVudC5zY3NzJ10sXG4gICAgaW5wdXRzOiBbJ2NsYXNzTmFtZXM6IG54U2l6ZSddLFxuICAgIGhvc3Q6IHtcbiAgICAgICAgJ1tjbGFzcy5pcy1uZWdhdGl2ZV0nOiAnbmVnYXRpdmUnLFxuICAgICAgICAnW2NsYXNzLmlzLWRpc2FibGVkXSc6ICdkaXNhYmxlZCcsXG4gICAgfSxcbiAgICBwcm92aWRlcnM6IFtDVVNUT01fVkFMVUVfQUNDRVNTT1IsIENVU1RPTV9WQUxJREFUT1JdLFxufSlcbmV4cG9ydCBjbGFzcyBOeE51bWJlclN0ZXBwZXJDb21wb25lbnQgZXh0ZW5kcyBNYXBwZWRTdHlsZXMgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBDb250cm9sVmFsdWVBY2Nlc3NvciwgVmFsaWRhdG9yLCBPbkRlc3Ryb3kge1xuICAgIHByaXZhdGUgX3N0ZXAgPSAxO1xuICAgIHByaXZhdGUgX21pbiA9IDA7XG4gICAgcHJpdmF0ZSBfbWF4ID0gMTAwO1xuICAgIHByaXZhdGUgX3ZhbHVlOiBudW1iZXIgfCBudWxsID0gMDtcbiAgICBwcml2YXRlIF9sYWJlbCE6IHN0cmluZztcbiAgICBwcml2YXRlIF9pbmNyZW1lbnRBcmlhTGFiZWwgPSAnJztcbiAgICBwcml2YXRlIF9kZWNyZW1lbnRBcmlhTGFiZWwgPSAnJztcbiAgICBwcml2YXRlIF9pbnB1dEFyaWFMYWJlbCA9ICcnO1xuICAgIHByaXZhdGUgX3Jlc2l6ZSA9IGZhbHNlO1xuICAgIHByaXZhdGUgX25lZ2F0aXZlID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBfbGVhZGluZ1plcm8gPSB0cnVlO1xuICAgIHByaXZhdGUgX2Rpc2FibGVkID0gZmFsc2U7XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIG51bWJlcklucHV0VmFsdWUhOiBzdHJpbmc7XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIGlucHV0Q2xhc3NOYW1lczogc3RyaW5nID0gbWFwQ2xhc3NOYW1lcygncmVndWxhcicsIElOUFVUX0NMQVNTRVMpO1xuXG4gICAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgICBpbnB1dElkID0gYG54LW51bWJlci1zdGVwcGVyLSR7bmV4dFVuaXF1ZUlkKyt9YDtcblxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgaW5wdXRXaWR0aCE6IG51bWJlcjtcblxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgYXJpYURlc2NyaWJlZEJ5OiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgQFZpZXdDaGlsZCgnY3VzdG9tTGFiZWwnKSBuZ0NvbnRlbnRXcmFwcGVyITogRWxlbWVudFJlZjtcblxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgQFZpZXdDaGlsZChOeEF1dG9SZXNpemVEaXJlY3RpdmUsIHsgc3RhdGljOiB0cnVlIH0pIGF1dG9SZXNpemUhOiBOeEF1dG9SZXNpemVEaXJlY3RpdmU7XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIEBWaWV3Q2hpbGQoJ25hdGl2ZUlucHV0JykgbmF0aXZlSW5wdXQhOiBFbGVtZW50UmVmO1xuXG4gICAgLyoqIEFuIGV2ZW50IGVtaXR0ZWQgb24gdmFsdWUgY2hhbmdlLiAqL1xuICAgIEBPdXRwdXQoJ254VmFsdWVDaGFuZ2UnKSB2YWx1ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8bnVtYmVyPigpO1xuXG4gICAgLyoqIFdoZXRoZXIgdGhlIGlucHV0IHNob3VsZCBiZSByZXNpemVkLiBEZWZhdWx0OiBmYWxzZSAqL1xuICAgIEBJbnB1dCgnbnhSZXNpemUnKVxuICAgIHNldCByZXNpemUodmFsdWU6IEJvb2xlYW5JbnB1dCkge1xuICAgICAgICB0aGlzLl9yZXNpemUgPSBjb2VyY2VCb29sZWFuUHJvcGVydHkodmFsdWUpO1xuICAgICAgICB0aGlzLl9jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgfVxuICAgIGdldCByZXNpemUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZXNpemU7XG4gICAgfVxuXG4gICAgZ2V0IGxhYmVsKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sYWJlbDtcbiAgICB9XG5cbiAgICAvKiogRGVmaW5lcyB0aGUgdGhlIGxhYmVsIHNob3duIGFib3ZlIHRoZSBzdGVwcGVyIGlucHV0LiAqL1xuICAgIEBJbnB1dCgnbnhMYWJlbCcpXG4gICAgc2V0IGxhYmVsKHZhbHVlOiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKHRoaXMuX2xhYmVsICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fbGFiZWwgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuX2Nkci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBTZXRzIHRoZSBhcmlhLWxhYmVsIGZvciB0aGUgaW5jcmVtZW50IGJ1dHRvbi4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNldCBpbmNyZW1lbnRBcmlhTGFiZWwodmFsdWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLl9pbmNyZW1lbnRBcmlhTGFiZWwgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBnZXQgaW5jcmVtZW50QXJpYUxhYmVsKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbmNyZW1lbnRBcmlhTGFiZWw7XG4gICAgfVxuXG4gICAgLyoqIFNldHMgdGhlIGFyaWEtbGFiZWwgZm9yIHRoZSBkZWNyZW1lbnQgYnV0dG9uLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2V0IGRlY3JlbWVudEFyaWFMYWJlbCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX2RlY3JlbWVudEFyaWFMYWJlbCA9IHZhbHVlO1xuICAgIH1cblxuICAgIGdldCBkZWNyZW1lbnRBcmlhTGFiZWwoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RlY3JlbWVudEFyaWFMYWJlbDtcbiAgICB9XG5cbiAgICAvKiogU2V0cyB0aGUgYXJpYS1sYWJlbCBmb3IgdGhlIGlucHV0IG9mIHRoZSBudW1iZXIgc3RlcHBlci4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNldCBpbnB1dEFyaWFMYWJlbCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX2lucHV0QXJpYUxhYmVsID0gdmFsdWU7XG4gICAgfVxuXG4gICAgZ2V0IGlucHV0QXJpYUxhYmVsKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbnB1dEFyaWFMYWJlbDtcbiAgICB9XG5cbiAgICAvKiogU2V0cyB0aGUgc3RlcCBzaXplLiBEZWZhdWx0OiAxICovXG4gICAgQElucHV0KCdueFN0ZXAnKVxuICAgIHNldCBzdGVwKHZhbHVlOiBOdW1iZXJJbnB1dCkge1xuICAgICAgICAvLyBvbmx5IGludGVybmFsIGNoYW5nZXMgbm8gbmVlZCB0byBjYWxsIG1hcmtGb3JDaGVja1xuICAgICAgICB0aGlzLl9zdGVwID0gTnVtYmVyKHZhbHVlKTtcbiAgICB9XG5cbiAgICBnZXQgc3RlcCgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3RlcDtcbiAgICB9XG5cbiAgICAvKiogU2V0cyB0aGUgbWluaW11bSBhY2NlcHRlZCBudW1iZXIuIERlZmF1bHQ6IDAgKi9cbiAgICBASW5wdXQoJ254TWluJylcbiAgICBzZXQgbWluKHZhbHVlOiBOdW1iZXJJbnB1dCkge1xuICAgICAgICB0aGlzLl9taW4gPSBOdW1iZXIodmFsdWUpO1xuICAgIH1cblxuICAgIGdldCBtaW4oKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21pbjtcbiAgICB9XG5cbiAgICAvKiogU2V0cyB0aGUgbWF4aW11bSBhY2NlcHRlZCBudW1iZXIuIERlZmF1bHQ6IDEwMCAqL1xuICAgIEBJbnB1dCgnbnhNYXgnKVxuICAgIHNldCBtYXgodmFsdWU6IE51bWJlcklucHV0KSB7XG4gICAgICAgIHRoaXMuX21heCA9IE51bWJlcih2YWx1ZSk7XG4gICAgfVxuXG4gICAgZ2V0IG1heCgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5fbWF4O1xuICAgIH1cblxuICAgIGdldCB2YWx1ZSgpOiBudW1iZXIgfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgIH1cblxuICAgIC8qKiBTZXRzIHRoZSB2YWx1ZSBvZiB0aGUgbnVtYmVyLXN0ZXBwZXIuICovXG4gICAgQElucHV0KCdueFZhbHVlJylcbiAgICBzZXQgdmFsdWUodmFsdWU6IG51bWJlciB8IG51bGwpIHtcbiAgICAgICAgdGhpcy5fdmFsdWUgPSB2YWx1ZSBhcyBudW1iZXI7XG4gICAgICAgIGlmICh0aGlzLl92YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zZXRJbnB1dFZhbHVlKHRoaXMuX3ZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2V0SW5wdXRWYWx1ZSgwKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgfVxuXG4gICAgLyoqIFdoZXRoZXIgdGhlIG5lZ2F0aXZlIHNldCBvZiBzdHlsaW5nIHNob3VsZCBiZSB1c2VkLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2V0IG5lZ2F0aXZlKHZhbHVlOiBCb29sZWFuSW5wdXQpIHtcbiAgICAgICAgaWYgKHRoaXMuX25lZ2F0aXZlICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fbmVnYXRpdmUgPSBjb2VyY2VCb29sZWFuUHJvcGVydHkodmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5fY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBuZWdhdGl2ZSgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX25lZ2F0aXZlO1xuICAgIH1cblxuICAgIC8qKiBXaGV0aGVyIHRoZSBudW1iZXIgc3RlcHBlciB2YWx1ZSBzaG91bGQgaGF2ZSBhIGxlYWRpbmcgemVyby5cbiAgICAgKlxuICAgICAqIERlZmF1bHQgdmFsdWUgaXMgdHJ1ZS5cbiAgICAgKi9cbiAgICBASW5wdXQoKVxuICAgIHNldCBsZWFkaW5nWmVybyh2YWx1ZTogQm9vbGVhbklucHV0KSB7XG4gICAgICAgIGlmICh0aGlzLl9sZWFkaW5nWmVybyAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX2xlYWRpbmdaZXJvID0gY29lcmNlQm9vbGVhblByb3BlcnR5KHZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMuc2V0SW5wdXRWYWx1ZSh0aGlzLnZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMuX2Nkci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbGVhZGluZ1plcm8oKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sZWFkaW5nWmVybztcbiAgICB9XG5cbiAgICAvKiogV2hldGhlciB0aGUgdXNlciBpbnB1dCBpbiB0aGUgbnVtYmVyIHN0ZXBwZXIgc2hvdWxkIGJlIGRpc2FibGVkLlxuICAgICAqXG4gICAgICogRGVmYXVsdCB2YWx1ZSBpcyBmYWxzZS5cbiAgICAgKi9cbiAgICBASW5wdXQoJ254RGlzYWJsZWQnKVxuICAgIHNldCBkaXNhYmxlZCh2YWx1ZTogQm9vbGVhbklucHV0KSB7XG4gICAgICAgIHRoaXMuX2Rpc2FibGVkID0gY29lcmNlQm9vbGVhblByb3BlcnR5KHZhbHVlKTtcbiAgICB9XG5cbiAgICBnZXQgZGlzYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kaXNhYmxlZDtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlYWRvbmx5IF9kZXN0cm95ZWQgPSBuZXcgU3ViamVjdDx2b2lkPigpO1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBfY2RyOiBDaGFuZ2VEZXRlY3RvclJlZiwgX3JlbmRlcmVyOiBSZW5kZXJlcjIsIF9lbGVtZW50UmVmOiBFbGVtZW50UmVmLCBwdWJsaWMgX2ludGw6IE54TnVtYmVyU3RlcHBlckludGwpIHtcbiAgICAgICAgc3VwZXIoU0laRV9NQVBQSU5HLCBfZWxlbWVudFJlZiwgX3JlbmRlcmVyLCBERUZBVUxUX0NMQVNTRVMpO1xuXG4gICAgICAgIHRoaXMuX2ludGwuY2hhbmdlcy5waXBlKHRha2VVbnRpbCh0aGlzLl9kZXN0cm95ZWQpKS5zdWJzY3JpYmUoKCkgPT4gdGhpcy5fY2RyLm1hcmtGb3JDaGVjaygpKTtcbiAgICB9XG5cbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgICAgIGlmICh0aGlzLm5nQ29udGVudFdyYXBwZXIpIHtcbiAgICAgICAgICAgIHRoaXMuYXJpYURlc2NyaWJlZEJ5ID0gdGhpcy5uZ0NvbnRlbnRXcmFwcGVyLm5hdGl2ZUVsZW1lbnQuY2hpbGRyZW4ubGVuZ3RoID4gMCA/IGBsYWJlbC1mb3ItJHt0aGlzLmlucHV0SWR9YCA6ICcnO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0SW5wdXRWYWx1ZSh0aGlzLl92YWx1ZSk7XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuX2Rlc3Ryb3llZC5uZXh0KCk7XG4gICAgICAgIHRoaXMuX2Rlc3Ryb3llZC5jb21wbGV0ZSgpO1xuICAgIH1cblxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgc2V0SW5wdXRWYWx1ZSh2YWx1ZTogbnVtYmVyIHwgbnVsbCkge1xuICAgICAgICBjb25zdCBwYXJzZWRWYWx1ZSA9IHZhbHVlID8gdmFsdWUgOiAwO1xuICAgICAgICBpZiAodGhpcy5sZWFkaW5nWmVybykge1xuICAgICAgICAgICAgdGhpcy5udW1iZXJJbnB1dFZhbHVlID0gcGFkKHBhcnNlZFZhbHVlLnRvU3RyaW5nKCksIDIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5udW1iZXJJbnB1dFZhbHVlID0gcGFyc2VkVmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZUlucHV0KSB7XG4gICAgICAgICAgICAvLyB1cGRhdGUgdGhlIG5hdGl2ZSBpbnB1dCB2YWx1ZSB3aXRoIHRoZSB0cmFuc2Zvcm1lZCB2YWx1ZS5cbiAgICAgICAgICAgIHRoaXMubmF0aXZlSW5wdXQubmF0aXZlRWxlbWVudC52YWx1ZSA9IHRoaXMubnVtYmVySW5wdXRWYWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHVzZSB0aW1lb3V0IHRvIGdldCB0aGUgY3VycmVudCB2YWx1ZSBvZiBudW1iZXJJbnB1dFZhbHVlXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyUmVzaXplKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qIENvbnRyb2xWYWx1ZUFjY2Vzc29yIEltcGxlbWVudGF0aW9ucyAqL1xuICAgIHdyaXRlVmFsdWUodmFsdWU6IG51bWJlciB8IG51bGwpOiB2b2lkIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIH1cblxuICAgIHByaXZhdGUgb25DaGFuZ2VDYWxsYmFjazogKHZhbHVlOiBudW1iZXIgfCBudWxsKSA9PiB2b2lkID0gKCkgPT4ge307XG5cbiAgICByZWdpc3Rlck9uQ2hhbmdlKG9uQ2hhbmdlOiAodmFsdWU6IG51bWJlciB8IG51bGwpID0+IHZvaWQpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrID0gb25DaGFuZ2U7XG4gICAgfVxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgb25Ub3VjaGVkQ2FsbGJhY2s6ICgpID0+IHZvaWQgPSAoKSA9PiB7fTtcblxuICAgIHJlZ2lzdGVyT25Ub3VjaGVkKG9uVG91Y2hlZDogKCkgPT4gdm9pZCk6IHZvaWQge1xuICAgICAgICB0aGlzLm9uVG91Y2hlZENhbGxiYWNrID0gb25Ub3VjaGVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERpc2FibGVzIHRoZSBzdGVwcGVyLiBQYXJ0IG9mIHRoZSBDb250cm9sVmFsdWVBY2Nlc3NvciBpbnRlcmZhY2UgcmVxdWlyZWRcbiAgICAgKiB0byBpbnRlZ3JhdGUgd2l0aCBBbmd1bGFyJ3MgY29yZSBmb3JtcyBBUEkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXNEaXNhYmxlZCBTZXRzIHdoZXRoZXIgdGhlIGNvbXBvbmVudCBpcyBkaXNhYmxlZC5cbiAgICAgKi9cbiAgICBzZXREaXNhYmxlZFN0YXRlKGlzRGlzYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fZGlzYWJsZWQgPSBpc0Rpc2FibGVkO1xuICAgICAgICB0aGlzLl9jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgfVxuXG4gICAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgICBvbklucHV0Q2hhbmdlKGV2ZW50OiBFdmVudCkge1xuICAgICAgICBpZiAodGhpcy52YWxpZGF0ZVVzZXJJbnB1dCgoZXZlbnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLnZhbHVlKSkge1xuICAgICAgICAgICAgdGhpcy5fdmFsdWUgPSBOdW1iZXIoKGV2ZW50LnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50KS52YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl92YWx1ZSA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzZXRJbnB1dFZhbHVlKCkgc2hvdWxkIGJlIGNhbGxlZCBzbyB0aGF0IG51bWJlcklucHV0VmFsdWUgaXMgdXBkYXRlZCB3aXRoIHRoZSB1c2VyIGlucHV0XG4gICAgICAgIGlmICh0aGlzLl92YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5zZXRJbnB1dFZhbHVlKHRoaXMuX3ZhbHVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2UuZW1pdCh0aGlzLl92YWx1ZSEpO1xuICAgICAgICB0aGlzLm9uQ2hhbmdlQ2FsbGJhY2sodGhpcy5fdmFsdWUpO1xuICAgIH1cblxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgdmFsaWRhdGVVc2VySW5wdXQoaW5wdXQ6IHN0cmluZykge1xuICAgICAgICByZXR1cm4gISFpbnB1dC5tYXRjaChBTExPV0VEX0NIQVJBQ1RFUlMpO1xuICAgIH1cblxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgaW5jcmVtZW50T25DbGljaygpIHtcbiAgICAgICAgdGhpcy5faW5jcmVtZW50KCk7XG4gICAgICAgIHRoaXMub25Ub3VjaGVkQ2FsbGJhY2soKTtcbiAgICB9XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIGluY3JlbWVudE9uS2V5KGV2ZW50OiBFdmVudCkge1xuICAgICAgICB0aGlzLl9pbmNyZW1lbnQoKTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIF9pbmNyZW1lbnQoKSB7XG4gICAgICAgIGxldCBuZXdWYWx1ZTtcbiAgICAgICAgaWYgKHRoaXMuaXNCZXR3ZWVuTGltaXRzKHRoaXMuX3ZhbHVlIHx8IDApKSB7XG4gICAgICAgICAgICBuZXdWYWx1ZSA9IHRoaXMuZ2V0TmV4dEdyZWF0ZXJWYWx1ZSh0aGlzLl92YWx1ZSB8fCAwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ld1ZhbHVlID0gdGhpcy5lbmZvcmNlTGltaXRzKHRoaXMuX3ZhbHVlIHx8IDApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudmFsdWUgPSBuZXdWYWx1ZTtcbiAgICAgICAgdGhpcy5zZXRJbnB1dFZhbHVlKHRoaXMudmFsdWUpO1xuICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlLmVtaXQodGhpcy5fdmFsdWUhKTtcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKHRoaXMuX3ZhbHVlKTtcbiAgICB9XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIHRyaWdnZXJSZXNpemUoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc2l6ZSkge1xuICAgICAgICAgICAgdGhpcy5hdXRvUmVzaXplLnVwZGF0ZUlucHV0V2lkdGgoKTtcbiAgICAgICAgICAgIHRoaXMuX2Nkci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgZGVjcmVtZW50T25DbGljaygpIHtcbiAgICAgICAgdGhpcy5fZGVjcmVtZW50KCk7XG4gICAgICAgIHRoaXMub25Ub3VjaGVkQ2FsbGJhY2soKTtcbiAgICB9XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIGRlY3JlbWVudE9uS2V5KGV2ZW50OiBFdmVudCkge1xuICAgICAgICB0aGlzLl9kZWNyZW1lbnQoKTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIF9kZWNyZW1lbnQoKSB7XG4gICAgICAgIGxldCBuZXdWYWx1ZTtcbiAgICAgICAgaWYgKHRoaXMuaXNCZXR3ZWVuTGltaXRzKHRoaXMuX3ZhbHVlIHx8IDApKSB7XG4gICAgICAgICAgICBuZXdWYWx1ZSA9IHRoaXMuZ2V0TmV4dExvd2VyVmFsdWUodGhpcy5fdmFsdWUgfHwgMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXdWYWx1ZSA9IHRoaXMuZW5mb3JjZUxpbWl0cyh0aGlzLl92YWx1ZSB8fCAwKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZhbHVlID0gbmV3VmFsdWU7XG4gICAgICAgIHRoaXMuc2V0SW5wdXRWYWx1ZSh0aGlzLnZhbHVlKTtcbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZS5lbWl0KHRoaXMuX3ZhbHVlISk7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayh0aGlzLl92YWx1ZSk7XG4gICAgfVxuXG4gICAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgICBlbmZvcmNlTGltaXRzKHZhbHVlOiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICBpZiAodmFsdWUgPiB0aGlzLl9tYXgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tYXg7XG4gICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPCB0aGlzLl9taW4pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9taW47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgZ2V0TmV4dExvd2VyVmFsdWUoc3RhcnQ6IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIC8vIGlmIHRoZXJlIGlzIGFuIGludmFsaWQgaW5wdXQgc3RhcnQgaXMgbnVsbFxuICAgICAgICBpZiAoIXN0YXJ0KSB7XG4gICAgICAgICAgICBzdGFydCA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgbmV4dDogbnVtYmVyO1xuICAgICAgICBpZiAodGhpcy5pc1ZhbGlkU3RlcChzdGFydCkpIHtcbiAgICAgICAgICAgIG5leHQgPSBuZXcgRGVjaW1hbChzdGFydCkubWludXMobmV3IERlY2ltYWwodGhpcy5fc3RlcCkpLnRvTnVtYmVyKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXh0ID0gbmV3IERlY2ltYWwoc3RhcnQpLnRvTmVhcmVzdCh0aGlzLl9zdGVwLCBEZWNpbWFsLlJPVU5EX0RPV04pLnRvTnVtYmVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuZW5mb3JjZUxpbWl0cyhuZXh0KTtcbiAgICB9XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIGdldE5leHRHcmVhdGVyVmFsdWUoc3RhcnQ6IG51bWJlcikge1xuICAgICAgICBsZXQgbmV4dDtcbiAgICAgICAgaWYgKCFzdGFydCkge1xuICAgICAgICAgICAgc3RhcnQgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmlzVmFsaWRTdGVwKHN0YXJ0KSkge1xuICAgICAgICAgICAgbmV4dCA9IG5ldyBEZWNpbWFsKHN0YXJ0KS5wbHVzKG5ldyBEZWNpbWFsKHRoaXMuX3N0ZXApKS50b051bWJlcigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV4dCA9IG5ldyBEZWNpbWFsKHN0YXJ0KS50b05lYXJlc3QodGhpcy5fc3RlcCwgRGVjaW1hbC5ST1VORF9VUCkudG9OdW1iZXIoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5lbmZvcmNlTGltaXRzKG5leHQpO1xuICAgIH1cblxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgaXNCZXR3ZWVuTGltaXRzKHZhbHVlOiBudW1iZXIgfCBEZWNpbWFsKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSA8PSB0aGlzLl9tYXggJiYgdmFsdWUgPj0gdGhpcy5fbWluO1xuICAgIH1cblxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgaXNNaW5pbXVtKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWUgPT09IHRoaXMuX21pbjtcbiAgICB9XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIGlzTWF4aW11bSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlID09PSB0aGlzLl9tYXg7XG4gICAgfVxuXG4gICAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgICBpc1ZhbGlkU3RlcCh2YWx1ZTogbnVtYmVyIHwgRGVjaW1hbCB8IG51bGwpIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IG5ldyBEZWNpbWFsKDApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG1pbiA9IG5ldyBEZWNpbWFsKHRoaXMuX21pbik7XG4gICAgICAgIGNvbnN0IHZhbHVlRGVjID0gbmV3IERlY2ltYWwodmFsdWUpO1xuICAgICAgICBjb25zdCBjaGVja1ZhbHVlID0gbWluLm1pbnVzKHZhbHVlRGVjKS5tb2QobmV3IERlY2ltYWwodGhpcy5fc3RlcCkpLnRvTnVtYmVyKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuaXNCZXR3ZWVuTGltaXRzKHZhbHVlKSAmJiAodGhpcy5pc01pbmltdW0oKSB8fCB0aGlzLmlzTWF4aW11bSgpIHx8IGNoZWNrVmFsdWUgPT09IDApKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgICB1c2VySW5wdXRUb051bWJlcih2YWx1ZTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlSW50KHZhbHVlLCAxMCkgfHwgMDtcbiAgICB9XG5cbiAgICBfdmFsaWRhdGVGbigpIHtcbiAgICAgICAgLy8gdGhlIG1hbnVhbCB1c2VyIGlucHV0IG11c3QgbWF0Y2ggbWluICsgbiAqIHN0ZXAsIGUuZy4gbWluaW11bSAxIHN0ZXAgMjogMSwgMywgNSwgNyBldGMuXG4gICAgICAgIGlmICghdGhpcy5pc1ZhbGlkU3RlcCh0aGlzLl92YWx1ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB7IG54TnVtYmVyU3RlcHBlclN0ZXBFcnJvcjogJ1ZhbHVlIGlzIG5vdCBhIHZhbGlkIHN0ZXAnIH07XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5fdmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiB7IG54TnVtYmVyU3RlcHBlckZvcm1hdEVycm9yOiAnTm90IGEgdmFsaWQgbnVtYmVyJyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgdmFsaWRhdGUoYzogRm9ybUNvbnRyb2wpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbGlkYXRlRm4oKTtcbiAgICB9XG5cbiAgICBnZXQgX2J1dHRvblR5cGUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuICdzZWNvbmRhcnknICsgKHRoaXMubmVnYXRpdmUgPyAnIG5lZ2F0aXZlJyA6ICcnKTtcbiAgICB9XG59XG4iLCI8ZGl2ICpuZ0lmPVwibGFiZWxcIiBjbGFzcz1cIm54LXN0ZXBwZXJfX2xhYmVsXCI+XG4gICAgPGxhYmVsIFtmb3JdPVwiaW5wdXRJZFwiPlxuICAgICAgICB7eyBsYWJlbCB9fVxuICAgIDwvbGFiZWw+XG48L2Rpdj5cbjxkaXYgY2xhc3M9XCJueC1zdGVwcGVyX19sYWJlbFwiICNjdXN0b21MYWJlbCAqbmdJZj1cIiFsYWJlbFwiIFtpZF09XCJhcmlhRGVzY3JpYmVkQnlcIj5cbiAgICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XG48L2Rpdj5cbjxkaXYgY2xhc3M9XCJueC1zdGVwcGVyX19pbnB1dC1jb250YWluZXJcIj5cbiAgICA8YnV0dG9uXG4gICAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwiZGVjcmVtZW50QXJpYUxhYmVsIHx8IF9pbnRsLmRlY3JlbWVudEFyaWFMYWJlbFwiXG4gICAgICAgIFtueEJ1dHRvbl09XCJfYnV0dG9uVHlwZVwiXG4gICAgICAgIGNsYXNzPVwibngtc3RlcHBlcl9fZG93biBueC1zdGVwcGVyX19jb250cm9sXCJcbiAgICAgICAgKGNsaWNrKT1cImRlY3JlbWVudE9uQ2xpY2soKVwiXG4gICAgICAgIFtkaXNhYmxlZF09XCJkaXNhYmxlZCB8fCAodmFsdWUgfHwgMCkgPD0gbWluXCJcbiAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgPlxuICAgICAgICA8bngtaWNvbiBuYW1lPVwibWludXNcIiBzaXplPVwic1wiPjwvbngtaWNvbj5cbiAgICA8L2J1dHRvbj5cbiAgICA8ZGl2IGNsYXNzPVwibngtc3RlcHBlcl9faW5wdXQtd3JhcHBlclwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwibngtc3RlcHBlcl9faW5uZXItd3JhcHBlclwiPlxuICAgICAgICAgICAgPG5nLWNvbnRlbnQgc2VsZWN0PVwibngtbnVtYmVyLXN0ZXBwZXItcHJlZml4XCI+PC9uZy1jb250ZW50PlxuXG4gICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICB0eXBlPVwibnVtYmVyXCJcbiAgICAgICAgICAgICAgICBbbnhBdXRvUmVzaXplXT1cInJlc2l6ZVwiXG4gICAgICAgICAgICAgICAgW2F0dHIuYXJpYS1kZXNjcmliZWRieV09XCJhcmlhRGVzY3JpYmVkQnlcIlxuICAgICAgICAgICAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwiaW5wdXRBcmlhTGFiZWxcIlxuICAgICAgICAgICAgICAgIFtpZF09XCJpbnB1dElkXCJcbiAgICAgICAgICAgICAgICBbbmdDbGFzc109XCJpbnB1dENsYXNzTmFtZXNcIlxuICAgICAgICAgICAgICAgIChpbnB1dCk9XCJvbklucHV0Q2hhbmdlKCRldmVudClcIlxuICAgICAgICAgICAgICAgIChibHVyKT1cIm9uVG91Y2hlZENhbGxiYWNrKClcIlxuICAgICAgICAgICAgICAgIChrZXlkb3duLmFycm93dXApPVwiaW5jcmVtZW50T25LZXkoJGV2ZW50KVwiXG4gICAgICAgICAgICAgICAgKGtleWRvd24uYXJyb3dkb3duKT1cImRlY3JlbWVudE9uS2V5KCRldmVudClcIlxuICAgICAgICAgICAgICAgICNuYXRpdmVJbnB1dFxuICAgICAgICAgICAgICAgIHNwZWxsY2hlY2s9XCJmYWxzZVwiXG4gICAgICAgICAgICAgICAgW2Rpc2FibGVkXT1cImRpc2FibGVkXCJcbiAgICAgICAgICAgIC8+XG5cbiAgICAgICAgICAgIDxuZy1jb250ZW50IHNlbGVjdD1cIm54LW51bWJlci1zdGVwcGVyLXN1ZmZpeFwiPjwvbmctY29udGVudD5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJueC1zdGVwcGVyX19pbnB1dC11bmRlcmxpbmVcIj48L2Rpdj5cbiAgICA8L2Rpdj5cblxuICAgIDxidXR0b25cbiAgICAgICAgW2F0dHIuYXJpYS1sYWJlbF09XCJpbmNyZW1lbnRBcmlhTGFiZWwgfHwgX2ludGwuaW5jcmVtZW50QXJpYUxhYmVsXCJcbiAgICAgICAgW254QnV0dG9uXT1cIl9idXR0b25UeXBlXCJcbiAgICAgICAgY2xhc3M9XCJueC1zdGVwcGVyX191cCBueC1zdGVwcGVyX19jb250cm9sXCJcbiAgICAgICAgKGNsaWNrKT1cImluY3JlbWVudE9uQ2xpY2soKVwiXG4gICAgICAgIFtkaXNhYmxlZF09XCJkaXNhYmxlZCB8fCAodmFsdWUgfHwgMCkgPj0gbWF4XCJcbiAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgPlxuICAgICAgICA8bngtaWNvbiBuYW1lPVwicGx1c1wiIHNpemU9XCJzXCI+PC9ueC1pY29uPlxuICAgIDwvYnV0dG9uPlxuPC9kaXY+XG4iXX0=
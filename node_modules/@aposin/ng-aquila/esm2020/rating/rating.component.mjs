import { coerceBooleanProperty, coerceNumberProperty } from '@angular/cdk/coercion';
import { ENTER, LEFT_ARROW, RIGHT_ARROW } from '@angular/cdk/keycodes';
import { ChangeDetectionStrategy, Component, ElementRef, EventEmitter, forwardRef, Input, Output, ViewChildren, } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { NxIconComponent } from '@aposin/ng-aquila/icon';
import * as i0 from "@angular/core";
import * as i1 from "@angular/cdk/a11y";
import * as i2 from "@aposin/ng-aquila/icon";
import * as i3 from "@angular/common";
export class NxRatingComponent {
    constructor(_cdr, _focusMonitor) {
        this._cdr = _cdr;
        this._focusMonitor = _focusMonitor;
        this._value = 0;
        this._hover = 0;
        this._disabled = false;
        this._negative = false;
        this._startLabel = '';
        this._endLabel = null;
        this._ariaLabel = ['1/5', '2/5', '3/5', '4/5', '5/5'];
        this._iconColor = '';
        /** An event is dispatched each time when the rating changes. */
        this.valueChange = new EventEmitter();
        this.onTouchedCallback = () => { };
        this.onChangeCallback = (option) => { };
    }
    /** Sets the selected rating 1 - 5. */
    set value(newValue) {
        this._value = coerceNumberProperty(newValue);
        this._cdr.markForCheck();
    }
    get value() {
        return this._value;
    }
    /** Whether the rating component should be disabled. */
    set disabled(newValue) {
        if (this._disabled === newValue) {
            return;
        }
        this._disabled = coerceBooleanProperty(newValue);
        this._cdr.markForCheck();
    }
    get disabled() {
        return this._disabled;
    }
    /** Whether the negative colors be used. */
    set negative(newValue) {
        if (this._negative === newValue) {
            return;
        }
        this._negative = coerceBooleanProperty(newValue);
        this._cdr.markForCheck();
    }
    get negative() {
        return this._negative;
    }
    /** Sets the label painted at the start of the rating component. */
    set startLabel(newValue) {
        this._startLabel = newValue;
        this._cdr.markForCheck();
    }
    get startLabel() {
        return this._startLabel;
    }
    /** Sets the label painted at the end of the rating component. */
    set endLabel(newValue) {
        this._endLabel = newValue;
        this._cdr.markForCheck();
    }
    get endLabel() {
        return this._endLabel;
    }
    set ariaLabel(newAriaLabels) {
        this._ariaLabel = newAriaLabels;
        this._cdr.markForCheck();
    }
    get ariaLabel() {
        return this._ariaLabel;
    }
    set iconColor(color) {
        this._iconColor = color;
        this._cdr.markForCheck();
    }
    get iconColor() {
        return this._iconColor;
    }
    ngAfterViewInit() {
        this.icons.forEach(icon => this._focusMonitor.monitor(icon));
    }
    ngOnDestroy() {
        this.icons.forEach(icon => this._focusMonitor.stopMonitoring(icon));
    }
    /** Whether the given rating is selected. */
    isSelected(index) {
        return index <= this.value || index <= this._hover;
    }
    /** Allows to set the rating. */
    setSelection(value) {
        if (!this.disabled) {
            this.value = value;
            this.valueChange.emit(value);
            this.onTouchedCallback();
            this.onChangeCallback(this.value);
        }
    }
    /** @docs-private */
    handleKeyUp(event, rating) {
        const keyCode = event.keyCode;
        event.preventDefault();
        event.stopPropagation();
        if (keyCode === ENTER) {
            this.setSelection(rating);
        }
        if (keyCode === RIGHT_ARROW) {
            this.value = Math.min(this.value + 1, 5);
            const elementRef = this.icons.toArray()[this.value - 1];
            this._focusMonitor.focusVia(elementRef, 'keyboard');
        }
        if (keyCode === LEFT_ARROW) {
            this.value = Math.max(this.value - 1, 1);
            const elementRef = this.icons.toArray()[this.value - 1];
            this._focusMonitor.focusVia(elementRef, 'keyboard');
        }
    }
    writeValue(value) {
        this.value = value;
    }
    registerOnChange(callback) {
        this.onChangeCallback = callback;
    }
    registerOnTouched(callback) {
        this.onTouchedCallback = callback;
    }
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
    }
    /** @docs-private */
    getAriaLabel(rating) {
        return this.ariaLabel[rating - 1];
    }
    /** @docs-private */
    getIconName(rating) {
        return 'star' + (this.isSelected(rating) ? '' : '-o');
    }
    /** @docs-private */
    setHover(rating) {
        if (this.disabled) {
            return;
        }
        this._hover = rating;
    }
}
NxRatingComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.3.1", ngImport: i0, type: NxRatingComponent, deps: [{ token: i0.ChangeDetectorRef }, { token: i1.FocusMonitor }], target: i0.ɵɵFactoryTarget.Component });
NxRatingComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.3.1", type: NxRatingComponent, selector: "nx-rating", inputs: { value: ["nxValue", "value"], disabled: ["nxDisabled", "disabled"], negative: ["nxNegative", "negative"], startLabel: ["nxStartLabel", "startLabel"], endLabel: ["nxEndLabel", "endLabel"], ariaLabel: ["nxAriaLabel", "ariaLabel"], iconColor: ["nxIconColor", "iconColor"] }, outputs: { valueChange: "nxValueChange" }, host: { properties: { "class.nx-rating--negative": "negative", "class.nx-rating--disabled": "disabled", "style.--iconColor": "iconColor" } }, providers: [
        {
            provide: NG_VALUE_ACCESSOR,
            useExisting: forwardRef(() => NxRatingComponent),
            multi: true,
        },
    ], viewQueries: [{ propertyName: "icons", predicate: NxIconComponent, descendants: true, read: ElementRef }], ngImport: i0, template: "<div class=\"nx-rating__container\" role=\"radiogroup\">\n    <nx-icon\n        *ngFor=\"let rating of [1, 2, 3, 4, 5]\"\n        (click)=\"setSelection(rating)\"\n        (keyup)=\"handleKeyUp($event, rating)\"\n        role=\"radio\"\n        [attr.aria-label]=\"getAriaLabel(rating)\"\n        [attr.aria-checked]=\"isSelected(rating)\"\n        [tabindex]=\"disabled ? -1 : 0\"\n        class=\"nx-rating__icon\"\n        [name]=\"getIconName(rating)\"\n        (mouseenter)=\"setHover(rating)\"\n        (mouseleave)=\"setHover(0)\"\n        size=\"m\"\n    >\n    </nx-icon>\n</div>\n<div class=\"nx-rating__label\" *ngIf=\"startLabel || endLabel\">\n    <span class=\"nx-rating__label--start\">{{ startLabel }}</span>\n    <span class=\"nx-rating__label--end\">{{ endLabel }}</span>\n</div>\n", styles: [":host{display:inline-block}:host(.nx-rating--negative) .nx-rating__label,:host(.nx-rating--negative) .nx-rating__icon{color:var(--negative)}:host(.nx-rating--disabled){cursor:not-allowed;outline:none}:host(.nx-rating--disabled) .nx-rating__label{color:var(--rating-disabled-label-color)}:host(.nx-rating--disabled) .nx-rating__icon{color:var(--rating-disabled-icon-color);cursor:not-allowed}.nx-rating__container{display:flex}.nx-rating__label{display:flex;font-size:var(--rating-label-font-size);line-height:var(--rating-label-line-height);font-weight:var(--rating-label-font-weight);letter-spacing:var(--rating-label-letter-spacing);color:var(--rating-label-color)}.nx-rating__label--end{margin-left:auto}:host-context([dir=rtl]) .nx-rating__label--end{margin-right:auto;margin-left:0;margin-left:initial}.nx-rating__icon{font-size:var(--rating-icon-size);color:var(--rating-icon-color);color:var(--iconColor, var(--rating-icon-color));width:auto;background:none;border:none;margin-right:16px;cursor:pointer;outline:none}:host-context([dir=rtl]) .nx-rating__icon{margin-right:0;margin-right:initial;margin-left:16px}.nx-rating__icon:last-child{margin-right:0}:host-context([dir=rtl]) .nx-rating__icon:last-child{margin-right:0;margin-right:initial;margin-left:0}.nx-rating__icon.cdk-keyboard-focused{box-shadow:var(--focus-box-shadow);border-radius:4px}@media screen and (-ms-high-contrast: active),(forced-colors: active){.nx-rating__icon.cdk-keyboard-focused{box-shadow:0 0 0 2px background,0 0 0 6px windowText;outline:4px solid CanvasText;outline-offset:2px}}@media screen and (-ms-high-contrast: active){:host .nx-rating__icon,:host.nx-rating--negative .nx-rating__icon{color:buttonText}:host .nx-rating__label,:host.nx-rating--negative .nx-rating__label{-ms-high-contrast-adjust:none;color:CanvasText}:host(.nx-rating--disabled) .nx-rating__icon{color:GrayText}:host(.nx-rating--disabled) .nx-rating__label{color:windowText}}\n"], components: [{ type: i2.NxIconComponent, selector: "nx-icon", inputs: ["name", "outline", "fill", "size", "font"] }], directives: [{ type: i3.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i3.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.3.1", ngImport: i0, type: NxRatingComponent, decorators: [{
            type: Component,
            args: [{ selector: 'nx-rating', changeDetection: ChangeDetectionStrategy.OnPush, providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef(() => NxRatingComponent),
                            multi: true,
                        },
                    ], host: {
                        '[class.nx-rating--negative]': 'negative',
                        '[class.nx-rating--disabled]': 'disabled',
                        '[style.--iconColor]': 'iconColor',
                    }, template: "<div class=\"nx-rating__container\" role=\"radiogroup\">\n    <nx-icon\n        *ngFor=\"let rating of [1, 2, 3, 4, 5]\"\n        (click)=\"setSelection(rating)\"\n        (keyup)=\"handleKeyUp($event, rating)\"\n        role=\"radio\"\n        [attr.aria-label]=\"getAriaLabel(rating)\"\n        [attr.aria-checked]=\"isSelected(rating)\"\n        [tabindex]=\"disabled ? -1 : 0\"\n        class=\"nx-rating__icon\"\n        [name]=\"getIconName(rating)\"\n        (mouseenter)=\"setHover(rating)\"\n        (mouseleave)=\"setHover(0)\"\n        size=\"m\"\n    >\n    </nx-icon>\n</div>\n<div class=\"nx-rating__label\" *ngIf=\"startLabel || endLabel\">\n    <span class=\"nx-rating__label--start\">{{ startLabel }}</span>\n    <span class=\"nx-rating__label--end\">{{ endLabel }}</span>\n</div>\n", styles: [":host{display:inline-block}:host(.nx-rating--negative) .nx-rating__label,:host(.nx-rating--negative) .nx-rating__icon{color:var(--negative)}:host(.nx-rating--disabled){cursor:not-allowed;outline:none}:host(.nx-rating--disabled) .nx-rating__label{color:var(--rating-disabled-label-color)}:host(.nx-rating--disabled) .nx-rating__icon{color:var(--rating-disabled-icon-color);cursor:not-allowed}.nx-rating__container{display:flex}.nx-rating__label{display:flex;font-size:var(--rating-label-font-size);line-height:var(--rating-label-line-height);font-weight:var(--rating-label-font-weight);letter-spacing:var(--rating-label-letter-spacing);color:var(--rating-label-color)}.nx-rating__label--end{margin-left:auto}:host-context([dir=rtl]) .nx-rating__label--end{margin-right:auto;margin-left:0;margin-left:initial}.nx-rating__icon{font-size:var(--rating-icon-size);color:var(--rating-icon-color);color:var(--iconColor, var(--rating-icon-color));width:auto;background:none;border:none;margin-right:16px;cursor:pointer;outline:none}:host-context([dir=rtl]) .nx-rating__icon{margin-right:0;margin-right:initial;margin-left:16px}.nx-rating__icon:last-child{margin-right:0}:host-context([dir=rtl]) .nx-rating__icon:last-child{margin-right:0;margin-right:initial;margin-left:0}.nx-rating__icon.cdk-keyboard-focused{box-shadow:var(--focus-box-shadow);border-radius:4px}@media screen and (-ms-high-contrast: active),(forced-colors: active){.nx-rating__icon.cdk-keyboard-focused{box-shadow:0 0 0 2px background,0 0 0 6px windowText;outline:4px solid CanvasText;outline-offset:2px}}@media screen and (-ms-high-contrast: active){:host .nx-rating__icon,:host.nx-rating--negative .nx-rating__icon{color:buttonText}:host .nx-rating__label,:host.nx-rating--negative .nx-rating__label{-ms-high-contrast-adjust:none;color:CanvasText}:host(.nx-rating--disabled) .nx-rating__icon{color:GrayText}:host(.nx-rating--disabled) .nx-rating__label{color:windowText}}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.ChangeDetectorRef }, { type: i1.FocusMonitor }]; }, propDecorators: { value: [{
                type: Input,
                args: ['nxValue']
            }], disabled: [{
                type: Input,
                args: ['nxDisabled']
            }], negative: [{
                type: Input,
                args: ['nxNegative']
            }], startLabel: [{
                type: Input,
                args: ['nxStartLabel']
            }], endLabel: [{
                type: Input,
                args: ['nxEndLabel']
            }], ariaLabel: [{
                type: Input,
                args: ['nxAriaLabel']
            }], iconColor: [{
                type: Input,
                args: ['nxIconColor']
            }], valueChange: [{
                type: Output,
                args: ['nxValueChange']
            }], icons: [{
                type: ViewChildren,
                args: [NxIconComponent, { read: ElementRef }]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmF0aW5nLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL25nLWFxdWlsYS9zcmMvcmF0aW5nL3JhdGluZy5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi9wcm9qZWN0cy9uZy1hcXVpbGEvc3JjL3JhdGluZy9yYXRpbmcuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFnQixxQkFBcUIsRUFBRSxvQkFBb0IsRUFBZSxNQUFNLHVCQUF1QixDQUFDO0FBQy9HLE9BQU8sRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLFdBQVcsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ3ZFLE9BQU8sRUFFSCx1QkFBdUIsRUFFdkIsU0FBUyxFQUNULFVBQVUsRUFDVixZQUFZLEVBQ1osVUFBVSxFQUNWLEtBQUssRUFFTCxNQUFNLEVBRU4sWUFBWSxHQUNmLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBd0IsaUJBQWlCLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUN6RSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7Ozs7O0FBb0J6RCxNQUFNLE9BQU8saUJBQWlCO0lBNkYxQixZQUFvQixJQUF1QixFQUFVLGFBQTJCO1FBQTVELFNBQUksR0FBSixJQUFJLENBQW1CO1FBQVUsa0JBQWEsR0FBYixhQUFhLENBQWM7UUE1RnhFLFdBQU0sR0FBRyxDQUFDLENBQUM7UUFXWCxXQUFNLEdBQUcsQ0FBQyxDQUFDO1FBRVgsY0FBUyxHQUFHLEtBQUssQ0FBQztRQWVsQixjQUFTLEdBQUcsS0FBSyxDQUFDO1FBY2xCLGdCQUFXLEdBQUcsRUFBRSxDQUFDO1FBV2pCLGNBQVMsR0FBa0IsSUFBSSxDQUFDO1FBV2hDLGVBQVUsR0FBYSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztRQWtCM0QsZUFB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YW5ndWxhci9jZGsvYTExeSc7XG5pbXBvcnQgeyBCb29sZWFuSW5wdXQsIGNvZXJjZUJvb2xlYW5Qcm9wZXJ0eSwgY29lcmNlTnVtYmVyUHJvcGVydHksIE51bWJlcklucHV0IH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2NvZXJjaW9uJztcbmltcG9ydCB7IEVOVEVSLCBMRUZUX0FSUk9XLCBSSUdIVF9BUlJPVyB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9rZXljb2Rlcyc7XG5pbXBvcnQge1xuICAgIEFmdGVyVmlld0luaXQsXG4gICAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gICAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgQ29tcG9uZW50LFxuICAgIEVsZW1lbnRSZWYsXG4gICAgRXZlbnRFbWl0dGVyLFxuICAgIGZvcndhcmRSZWYsXG4gICAgSW5wdXQsXG4gICAgT25EZXN0cm95LFxuICAgIE91dHB1dCxcbiAgICBRdWVyeUxpc3QsXG4gICAgVmlld0NoaWxkcmVuLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBOR19WQUxVRV9BQ0NFU1NPUiB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7IE54SWNvbkNvbXBvbmVudCB9IGZyb20gJ0BhcG9zaW4vbmctYXF1aWxhL2ljb24nO1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ254LXJhdGluZycsXG4gICAgdGVtcGxhdGVVcmw6ICcuL3JhdGluZy5jb21wb25lbnQuaHRtbCcsXG4gICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gICAgc3R5bGVVcmxzOiBbJy4vcmF0aW5nLmNvbXBvbmVudC5zY3NzJ10sXG4gICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgICAgICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gTnhSYXRpbmdDb21wb25lbnQpLFxuICAgICAgICAgICAgbXVsdGk6IHRydWUsXG4gICAgICAgIH0sXG4gICAgXSxcbiAgICBob3N0OiB7XG4gICAgICAgICdbY2xhc3MubngtcmF0aW5nLS1uZWdhdGl2ZV0nOiAnbmVnYXRpdmUnLFxuICAgICAgICAnW2NsYXNzLm54LXJhdGluZy0tZGlzYWJsZWRdJzogJ2Rpc2FibGVkJyxcbiAgICAgICAgJ1tzdHlsZS4tLWljb25Db2xvcl0nOiAnaWNvbkNvbG9yJyxcbiAgICB9LFxufSlcbmV4cG9ydCBjbGFzcyBOeFJhdGluZ0NvbXBvbmVudCBpbXBsZW1lbnRzIENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3kge1xuICAgIHByaXZhdGUgX3ZhbHVlID0gMDtcbiAgICAvKiogU2V0cyB0aGUgc2VsZWN0ZWQgcmF0aW5nIDEgLSA1LiAqL1xuICAgIEBJbnB1dCgnbnhWYWx1ZScpXG4gICAgc2V0IHZhbHVlKG5ld1ZhbHVlOiBOdW1iZXJJbnB1dCkge1xuICAgICAgICB0aGlzLl92YWx1ZSA9IGNvZXJjZU51bWJlclByb3BlcnR5KG5ld1ZhbHVlKTtcbiAgICAgICAgdGhpcy5fY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICBnZXQgdmFsdWUoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2hvdmVyID0gMDtcblxuICAgIHByaXZhdGUgX2Rpc2FibGVkID0gZmFsc2U7XG5cbiAgICAvKiogV2hldGhlciB0aGUgcmF0aW5nIGNvbXBvbmVudCBzaG91bGQgYmUgZGlzYWJsZWQuICovXG4gICAgQElucHV0KCdueERpc2FibGVkJylcbiAgICBzZXQgZGlzYWJsZWQobmV3VmFsdWU6IEJvb2xlYW5JbnB1dCkge1xuICAgICAgICBpZiAodGhpcy5fZGlzYWJsZWQgPT09IG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZGlzYWJsZWQgPSBjb2VyY2VCb29sZWFuUHJvcGVydHkobmV3VmFsdWUpO1xuICAgICAgICB0aGlzLl9jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgfVxuICAgIGdldCBkaXNhYmxlZCgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Rpc2FibGVkO1xuICAgIH1cblxuICAgIHByaXZhdGUgX25lZ2F0aXZlID0gZmFsc2U7XG4gICAgLyoqIFdoZXRoZXIgdGhlIG5lZ2F0aXZlIGNvbG9ycyBiZSB1c2VkLiAqL1xuICAgIEBJbnB1dCgnbnhOZWdhdGl2ZScpXG4gICAgc2V0IG5lZ2F0aXZlKG5ld1ZhbHVlOiBCb29sZWFuSW5wdXQpIHtcbiAgICAgICAgaWYgKHRoaXMuX25lZ2F0aXZlID09PSBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX25lZ2F0aXZlID0gY29lcmNlQm9vbGVhblByb3BlcnR5KG5ld1ZhbHVlKTtcbiAgICAgICAgdGhpcy5fY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICBnZXQgbmVnYXRpdmUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9uZWdhdGl2ZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9zdGFydExhYmVsID0gJyc7XG4gICAgLyoqIFNldHMgdGhlIGxhYmVsIHBhaW50ZWQgYXQgdGhlIHN0YXJ0IG9mIHRoZSByYXRpbmcgY29tcG9uZW50LiAqL1xuICAgIEBJbnB1dCgnbnhTdGFydExhYmVsJylcbiAgICBzZXQgc3RhcnRMYWJlbChuZXdWYWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX3N0YXJ0TGFiZWwgPSBuZXdWYWx1ZTtcbiAgICAgICAgdGhpcy5fY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICBnZXQgc3RhcnRMYWJlbCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3RhcnRMYWJlbDtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9lbmRMYWJlbDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gICAgLyoqIFNldHMgdGhlIGxhYmVsIHBhaW50ZWQgYXQgdGhlIGVuZCBvZiB0aGUgcmF0aW5nIGNvbXBvbmVudC4gKi9cbiAgICBASW5wdXQoJ254RW5kTGFiZWwnKVxuICAgIHNldCBlbmRMYWJlbChuZXdWYWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX2VuZExhYmVsID0gbmV3VmFsdWU7XG4gICAgICAgIHRoaXMuX2Nkci5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG4gICAgZ2V0IGVuZExhYmVsKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLl9lbmRMYWJlbCBhcyBzdHJpbmc7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfYXJpYUxhYmVsOiBzdHJpbmdbXSA9IFsnMS81JywgJzIvNScsICczLzUnLCAnNC81JywgJzUvNSddO1xuICAgIEBJbnB1dCgnbnhBcmlhTGFiZWwnKVxuICAgIC8qKiBTZXRzIGFuIGFycmF5IG9mIGN1c3RvbSBhcmlhLWRlc2NyaWJlZGJ5IGF0dHJpYnV0ZXMgZm9yIGVhY2ggb2YgdGhlIHN0YXJzIGluIHRoZSBjb21wb25lbnQuICovXG4gICAgc2V0IGFyaWFMYWJlbChuZXdBcmlhTGFiZWxzOiBzdHJpbmdbXSkge1xuICAgICAgICB0aGlzLl9hcmlhTGFiZWwgPSBuZXdBcmlhTGFiZWxzO1xuICAgICAgICB0aGlzLl9jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgfVxuICAgIGdldCBhcmlhTGFiZWwoKTogc3RyaW5nW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJpYUxhYmVsO1xuICAgIH1cblxuICAgIEBJbnB1dCgnbnhJY29uQ29sb3InKSAvKiogU2V0cyB0aGUgY29sb3Igb2YgcmF0aW5nIGljb24uICovIHNldCBpY29uQ29sb3IoY29sb3I6IHN0cmluZykge1xuICAgICAgICB0aGlzLl9pY29uQ29sb3IgPSBjb2xvcjtcbiAgICAgICAgdGhpcy5fY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICBnZXQgaWNvbkNvbG9yKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pY29uQ29sb3I7XG4gICAgfVxuICAgIHByaXZhdGUgX2ljb25Db2xvciA9ICcnO1xuXG4gICAgLyoqIEFuIGV2ZW50IGlzIGRpc3BhdGNoZWQgZWFjaCB0aW1lIHdoZW4gdGhlIHJhdGluZyBjaGFuZ2VzLiAqL1xuICAgIEBPdXRwdXQoJ254VmFsdWVDaGFuZ2UnKSB2YWx1ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8bnVtYmVyPigpO1xuXG4gICAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgICBAVmlld0NoaWxkcmVuKE54SWNvbkNvbXBvbmVudCwgeyByZWFkOiBFbGVtZW50UmVmIH0pIGljb25zITogUXVlcnlMaXN0PEVsZW1lbnRSZWY+O1xuICAgIHByaXZhdGUgb25Ub3VjaGVkQ2FsbGJhY2s6ICgpID0+IHZvaWQgPSAoKSA9PiB7fTtcbiAgICBwcml2YXRlIG9uQ2hhbmdlQ2FsbGJhY2s6IChvcHRpb246IGFueSkgPT4gYW55ID0gKG9wdGlvbjogYW55KSA9PiB7fTtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgX2NkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsIHByaXZhdGUgX2ZvY3VzTW9uaXRvcjogRm9jdXNNb25pdG9yKSB7fVxuXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgICAgICB0aGlzLmljb25zLmZvckVhY2goaWNvbiA9PiB0aGlzLl9mb2N1c01vbml0b3IubW9uaXRvcihpY29uKSk7XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuaWNvbnMuZm9yRWFjaChpY29uID0+IHRoaXMuX2ZvY3VzTW9uaXRvci5zdG9wTW9uaXRvcmluZyhpY29uKSk7XG4gICAgfVxuXG4gICAgLyoqIFdoZXRoZXIgdGhlIGdpdmVuIHJhdGluZyBpcyBzZWxlY3RlZC4gKi9cbiAgICBpc1NlbGVjdGVkKGluZGV4OiBudW1iZXIpIHtcbiAgICAgICAgcmV0dXJuIGluZGV4IDw9IHRoaXMudmFsdWUgfHwgaW5kZXggPD0gdGhpcy5faG92ZXI7XG4gICAgfVxuXG4gICAgLyoqIEFsbG93cyB0byBzZXQgdGhlIHJhdGluZy4gKi9cbiAgICBzZXRTZWxlY3Rpb24odmFsdWU6IG51bWJlcikge1xuICAgICAgICBpZiAoIXRoaXMuZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMudmFsdWVDaGFuZ2UuZW1pdCh2YWx1ZSk7XG4gICAgICAgICAgICB0aGlzLm9uVG91Y2hlZENhbGxiYWNrKCk7XG4gICAgICAgICAgICB0aGlzLm9uQ2hhbmdlQ2FsbGJhY2sodGhpcy52YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIGhhbmRsZUtleVVwKGV2ZW50OiBLZXlib2FyZEV2ZW50LCByYXRpbmc6IG51bWJlcikge1xuICAgICAgICBjb25zdCBrZXlDb2RlID0gZXZlbnQua2V5Q29kZTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgaWYgKGtleUNvZGUgPT09IEVOVEVSKSB7XG4gICAgICAgICAgICB0aGlzLnNldFNlbGVjdGlvbihyYXRpbmcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGtleUNvZGUgPT09IFJJR0hUX0FSUk9XKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gTWF0aC5taW4odGhpcy52YWx1ZSArIDEsIDUpO1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudFJlZjogRWxlbWVudFJlZiA9IHRoaXMuaWNvbnMudG9BcnJheSgpW3RoaXMudmFsdWUgLSAxXTtcbiAgICAgICAgICAgIHRoaXMuX2ZvY3VzTW9uaXRvci5mb2N1c1ZpYShlbGVtZW50UmVmLCAna2V5Ym9hcmQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChrZXlDb2RlID09PSBMRUZUX0FSUk9XKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gTWF0aC5tYXgodGhpcy52YWx1ZSAtIDEsIDEpO1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudFJlZjogRWxlbWVudFJlZiA9IHRoaXMuaWNvbnMudG9BcnJheSgpW3RoaXMudmFsdWUgLSAxXTtcbiAgICAgICAgICAgIHRoaXMuX2ZvY3VzTW9uaXRvci5mb2N1c1ZpYShlbGVtZW50UmVmLCAna2V5Ym9hcmQnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHdyaXRlVmFsdWUodmFsdWU6IG51bWJlcik6IHZvaWQge1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgcmVnaXN0ZXJPbkNoYW5nZShjYWxsYmFjazogKG9wdGlvbjogYW55KSA9PiBhbnkpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgfVxuXG4gICAgcmVnaXN0ZXJPblRvdWNoZWQoY2FsbGJhY2s6ICgpID0+IHZvaWQpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH1cblxuICAgIHNldERpc2FibGVkU3RhdGUoaXNEaXNhYmxlZDogYm9vbGVhbik6IHZvaWQge1xuICAgICAgICB0aGlzLmRpc2FibGVkID0gaXNEaXNhYmxlZDtcbiAgICB9XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIGdldEFyaWFMYWJlbChyYXRpbmc6IG51bWJlcikge1xuICAgICAgICByZXR1cm4gdGhpcy5hcmlhTGFiZWxbcmF0aW5nIC0gMV07XG4gICAgfVxuXG4gICAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgICBnZXRJY29uTmFtZShyYXRpbmc6IG51bWJlcikge1xuICAgICAgICByZXR1cm4gJ3N0YXInICsgKHRoaXMuaXNTZWxlY3RlZChyYXRpbmcpID8gJycgOiAnLW8nKTtcbiAgICB9XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIHNldEhvdmVyKHJhdGluZzogbnVtYmVyKSB7XG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faG92ZXIgPSByYXRpbmc7XG4gICAgfVxufVxuIiwiPGRpdiBjbGFzcz1cIm54LXJhdGluZ19fY29udGFpbmVyXCIgcm9sZT1cInJhZGlvZ3JvdXBcIj5cbiAgICA8bngtaWNvblxuICAgICAgICAqbmdGb3I9XCJsZXQgcmF0aW5nIG9mIFsxLCAyLCAzLCA0LCA1XVwiXG4gICAgICAgIChjbGljayk9XCJzZXRTZWxlY3Rpb24ocmF0aW5nKVwiXG4gICAgICAgIChrZXl1cCk9XCJoYW5kbGVLZXlVcCgkZXZlbnQsIHJhdGluZylcIlxuICAgICAgICByb2xlPVwicmFkaW9cIlxuICAgICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cImdldEFyaWFMYWJlbChyYXRpbmcpXCJcbiAgICAgICAgW2F0dHIuYXJpYS1jaGVja2VkXT1cImlzU2VsZWN0ZWQocmF0aW5nKVwiXG4gICAgICAgIFt0YWJpbmRleF09XCJkaXNhYmxlZCA/IC0xIDogMFwiXG4gICAgICAgIGNsYXNzPVwibngtcmF0aW5nX19pY29uXCJcbiAgICAgICAgW25hbWVdPVwiZ2V0SWNvbk5hbWUocmF0aW5nKVwiXG4gICAgICAgIChtb3VzZWVudGVyKT1cInNldEhvdmVyKHJhdGluZylcIlxuICAgICAgICAobW91c2VsZWF2ZSk9XCJzZXRIb3ZlcigwKVwiXG4gICAgICAgIHNpemU9XCJtXCJcbiAgICA+XG4gICAgPC9ueC1pY29uPlxuPC9kaXY+XG48ZGl2IGNsYXNzPVwibngtcmF0aW5nX19sYWJlbFwiICpuZ0lmPVwic3RhcnRMYWJlbCB8fCBlbmRMYWJlbFwiPlxuICAgIDxzcGFuIGNsYXNzPVwibngtcmF0aW5nX19sYWJlbC0tc3RhcnRcIj57eyBzdGFydExhYmVsIH19PC9zcGFuPlxuICAgIDxzcGFuIGNsYXNzPVwibngtcmF0aW5nX19sYWJlbC0tZW5kXCI+e3sgZW5kTGFiZWwgfX08L3NwYW4+XG48L2Rpdj5cbiJdfQ==
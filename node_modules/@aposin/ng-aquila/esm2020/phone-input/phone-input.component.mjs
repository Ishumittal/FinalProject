var _NxPhoneInputComponent_required;
import { __classPrivateFieldGet, __classPrivateFieldSet } from "tslib";
import { coerceBooleanProperty } from '@angular/cdk/coercion';
import { ChangeDetectionStrategy, Component, Input, Optional, Self, ViewChild, } from '@angular/core';
import { NxDropdownComponent } from '@aposin/ng-aquila/dropdown';
import { NxFormfieldControl } from '@aposin/ng-aquila/formfield';
import { Subject } from 'rxjs';
import { takeUntil } from 'rxjs/operators';
import { getCountryCallingCodeFromNumber, getCountryCodeforCallingCode, getDialCodeByCountryCode, getSortedCountryCodes } from './country-data';
import * as i0 from "@angular/core";
import * as i1 from "@angular/cdk/a11y";
import * as i2 from "@aposin/ng-aquila/utils";
import * as i3 from "./phone-input-intl";
import * as i4 from "@aposin/ng-aquila/formfield";
import * as i5 from "@angular/forms";
import * as i6 from "@aposin/ng-aquila/dropdown";
import * as i7 from "@angular/common";
let next = 0;
export class NxPhoneInputComponent {
    constructor(_elementRef, _focusMonitor, _cdr, _errorStateMatcher, _intl, formFieldComponent, 
    /** @docs-private */ ngControl, _parentForm, _parentFormGroup) {
        this._elementRef = _elementRef;
        this._focusMonitor = _focusMonitor;
        this._cdr = _cdr;
        this._errorStateMatcher = _errorStateMatcher;
        this._intl = _intl;
        this.formFieldComponent = formFieldComponent;
        this.ngControl = ngControl;
        this._parentForm = _parentForm;
        this._parentFormGroup = _parentFormGroup;
        this._inputValue = '';
        this._describedBy = '';
        this.stateChanges = new Subject();
        this.focused = false;
        this._uid = 'phone-input-' + next++;
        _NxPhoneInputComponent_required.set(this, false);
        this._disabled = false;
        this._readonly = false;
        this._countryCode = 'DE';
        this._initialCountryCode = 'DE';
        this._placeholder = '';
        // TODO we are disabling the floating label for now. the problem is: the label
        // is supposed to float next to the dropdown. we could introduce some changes to the
        // formfield that a control can also give something like an offset for the floating label
        // but for capacity reasons this has to be done at a later stage.
        this.shouldLabelFloat = true;
        /** @docs-private */
        this.errorState = false;
        this.controlType = 'nx-phone-input';
        this._countryCallingCode = getDialCodeByCountryCode(this.countryCode);
        this._destroyed = new Subject();
        this._inputFormatter = (inputValue, countryCode) => this._removeLeadingZero(inputValue);
        /** `View -> model callback called when value changes` */
        this._onChange = () => { };
        /** `View -> model callback called when select has been touched` */
        this._onTouched = () => { };
        if (this.ngControl) {
            // Note: we provide the value accessor through here, instead of
            // the `providers` to avoid running into a circular import.
            this.ngControl.valueAccessor = this;
        }
        _intl.changes.pipe(takeUntil(this._destroyed)).subscribe(_ => {
            this._sortCountries();
            this._cdr.detectChanges();
        });
    }
    get empty() {
        return !!this._inputValue;
    }
    /** Sets the id of the phone input component. */
    get id() {
        return this._id || this._uid;
    }
    set id(value) {
        this._id = value;
        this.stateChanges.next();
    }
    /** Whether the component should be required. */
    set required(value) {
        const coercedValue = coerceBooleanProperty(value);
        if (__classPrivateFieldGet(this, _NxPhoneInputComponent_required, "f") !== coercedValue) {
            __classPrivateFieldSet(this, _NxPhoneInputComponent_required, coercedValue, "f");
            this._cdr.markForCheck();
        }
    }
    get required() {
        return __classPrivateFieldGet(this, _NxPhoneInputComponent_required, "f");
    }
    /** Whether the component should be disabled. */
    get disabled() {
        return this._disabled;
    }
    set disabled(value) {
        this._disabled = value; // TODO properly coerce input value
    }
    /** Whether the component should be read only. */
    get readonly() {
        return this._readonly;
    }
    set readonly(value) {
        this._readonly = coerceBooleanProperty(value);
        this.stateChanges.next();
    }
    /** Sets the initial country to be selected in the dropdown. Format is the international
     * country code like DE, US.
     * If there is already a number in the input field changing this property has no effect.
     */
    set countryCode(value) {
        if (this._inputValue) {
            return;
        }
        this._initialCountryCode = value;
        this._countryCode = value;
    }
    get countryCode() {
        return this._countryCode;
    }
    /** Set the text at the top of the dropdown. The default value is 'Area Code'. */
    get areaCodeLabel() {
        return this._areaCodeLabel || this._intl.areaCodeLabel;
    }
    set areaCodeLabel(value) {
        this._areaCodeLabel = value;
    }
    /** Set the translations of the countries. */
    get countryNames() {
        return this._countryNames || this._intl.countryNames;
    }
    set countryNames(value) {
        this._countryNames = value;
        this._sortCountries();
    }
    /** The placeholder to be shown in the input field. */
    get placeholder() {
        return this._placeholder;
    }
    set placeholder(value) {
        this._placeholder = value;
        this.stateChanges.next();
    }
    /**
     * Function to format the value in the input part of the component.
     * The function is called on blur. The default function removes leading zeros.
     * Please note: to determine the model value the component will remove parenthesis,
     * whitespace and dash characters from the formatted input.
     */
    get inputFormatter() {
        return this._inputFormatter;
    }
    set inputFormatter(formatFn) {
        this._inputFormatter = formatFn;
        this._inputValue = this._inputFormatter(this._inputValue, this._countryCallingCode);
    }
    ngDoCheck() {
        if (this.ngControl) {
            // We need to re-evaluate this on every change detection cycle, because there are some
            // error triggers that we can't subscribe to (e.g. parent form submissions). This means
            // that whatever logic is in here has to be super lean or we risk destroying the performance.
            this.updateErrorState();
        }
    }
    ngOnInit() {
        this._sortCountries();
    }
    ngAfterViewInit() {
        this._focusMonitor.monitor(this.dropdown.elementRef);
    }
    ngOnDestroy() {
        this._destroyed.next();
        this._destroyed.complete();
    }
    setDescribedByIds(ids) {
        this._describedBy = ids.join(' ');
        this.dropdown.setDescribedByIds(ids);
    }
    get _ariaLabelledBy() {
        return this.formFieldComponent?.labelId;
    }
    get elementRef() {
        return this._elementRef;
    }
    writeValue(value) {
        if (typeof value === 'string') {
            const noWhitespaceNumber = value.replace(/\s/g, '');
            const { countryCallingCode, number } = getCountryCallingCodeFromNumber(noWhitespaceNumber || '+' + getDialCodeByCountryCode(this.countryCode)); // requires string starting with '+'
            this._countryCallingCode = countryCallingCode;
            this._inputValue = this.inputFormatter(number, countryCallingCode);
            this._countryCode = getCountryCodeforCallingCode(countryCallingCode);
        }
        else {
            this.value = '';
            this._inputValue = '';
            this._countryCode = this._initialCountryCode;
        }
        this._cdr.markForCheck();
    }
    registerOnChange(fn) {
        this._onChange = fn;
    }
    registerOnTouched(fn) {
        this._onTouched = fn;
    }
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
        this._cdr.markForCheck();
        this.stateChanges.next();
    }
    updateErrorState() {
        const oldState = this.errorState;
        const parent = this._parentFormGroup || this._parentForm;
        const control = this.ngControl ? this.ngControl.control : null;
        const newState = this._errorStateMatcher.isErrorState(control, parent);
        if (newState !== oldState) {
            this.errorState = newState;
            this.stateChanges.next();
        }
    }
    _onInputBlur() {
        this._onTouched();
        this._inputValue = this.inputFormatter(this._inputValue, this._countryCallingCode);
    }
    _onInput() {
        this.updateModel();
    }
    _onCountryChange(countryCode) {
        this._countryCode = countryCode;
        this._countryCallingCode = getDialCodeByCountryCode(this.countryCode);
        this._inputValue = this.inputFormatter(this._inputValue, this._countryCallingCode);
        this._onInput();
    }
    updateModel() {
        const hasNumber = typeof this._inputValue === 'string' && this._removeLeadingZero(this._trimInputValue(this._inputValue)).length > 0;
        if (hasNumber) {
            this._onChange(this.getModelValue());
        }
        else {
            this._onChange('');
        }
    }
    _trimInputValue(value) {
        return value.replace(/[\s()\-/]/g, '');
    }
    _removeLeadingZero(value) {
        return value.replace(/^0/, '');
    }
    /** Returns the combined string of selected calling code + input number */
    getModelValue() {
        return '+' + this._getCallingCode(this.dropdown.value) + this._trimInputValue(this._removeLeadingZero(this._inputValue));
    }
    _getCallingCode(country) {
        return getDialCodeByCountryCode(country);
    }
    _sortCountries() {
        this._sortedCountries = getSortedCountryCodes(this.countryNames).map(country => this._getDropdownOption(country));
    }
    _getDropdownOption(country) {
        return {
            value: country,
            label: `${this._getCountryName(country)} (+${this._getCallingCode(country)})`,
        };
    }
    _getCountryName(countryCode) {
        const name = this.countryNames[countryCode];
        return Array.isArray(name) ? name[0] : name;
    }
    _getReadonlyValue() {
        return this.getModelValue();
    }
}
_NxPhoneInputComponent_required = new WeakMap();
NxPhoneInputComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.3.1", ngImport: i0, type: NxPhoneInputComponent, deps: [{ token: i0.ElementRef }, { token: i1.FocusMonitor }, { token: i0.ChangeDetectorRef }, { token: i2.ErrorStateMatcher }, { token: i3.NxPhoneInputIntl }, { token: i4.NxFormfieldComponent, optional: true }, { token: i5.NgControl, optional: true, self: true }, { token: i5.NgForm, optional: true }, { token: i5.FormGroupDirective, optional: true }], target: i0.ɵɵFactoryTarget.Component });
NxPhoneInputComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.3.1", type: NxPhoneInputComponent, selector: "nx-phone-input", inputs: { id: "id", required: "required", disabled: "disabled", readonly: "readonly", countryCode: "countryCode", areaCodeLabel: "areaCodeLabel", countryNames: "countryNames", placeholder: "placeholder", inputFormatter: "inputFormatter" }, host: { properties: { "attr.id": "id" } }, providers: [{ provide: NxFormfieldControl, useExisting: NxPhoneInputComponent }], viewQueries: [{ propertyName: "dropdown", first: true, predicate: NxDropdownComponent, descendants: true, static: true }], ngImport: i0, template: "<div class=\"wrapper\">\n    <nx-dropdown\n        [class.hide]=\"readonly && !disabled\"\n        [nxValue]=\"countryCode\"\n        #dropdown\n        [nxShowFilter]=\"true\"\n        [nxDisabled]=\"disabled\"\n        [nxOverlayLabel]=\"areaCodeLabel\"\n        (nxValueChange)=\"_onCountryChange($event)\"\n        [options]=\"_sortedCountries\"\n    >\n        <span *nxClosedLabel>+{{ _getCallingCode(dropdown.value) }}</span>\n    </nx-dropdown>\n\n    <!-- adding c-input for the styles and to not get the overhead of the nxInput directive -->\n    <input\n        class=\"c-input\"\n        [class.hide]=\"readonly && !disabled\"\n        type=\"tel\"\n        (blur)=\"_onInputBlur()\"\n        [(ngModel)]=\"_inputValue\"\n        (ngModelChange)=\"_onInput()\"\n        [attr.aria-describedby]=\"_describedBy\"\n        [attr.aria-labelledby]=\"_ariaLabelledBy\"\n        [attr.required]=\"required || null\"\n        [attr.disabled]=\"disabled || null\"\n        [attr.placeholder]=\"placeholder || null\"\n    />\n\n    <input\n        class=\"c-input readonly-input\"\n        *ngIf=\"readonly && !disabled\"\n        type=\"tel\"\n        [attr.readonly]=\"readonly || null\"\n        [attr.aria-readonly]=\"readonly || null\"\n        [value]=\"_getReadonlyValue()\"\n        [attr.aria-describedby]=\"_describedBy\"\n        [attr.aria-labelledby]=\"_ariaLabelledBy\"\n    />\n</div>\n", styles: [":host{display:block;width:100%}.wrapper{display:flex;height:100%;align-items:center}.hide{display:none;visibility:hidden}input{flex:1}.readonly-input{margin-left:7px}nx-dropdown{width:auto;margin-right:8px}nx-dropdown.cdk-keyboard-focused{box-shadow:var(--focus-box-shadow);border-radius:4px}@media screen and (-ms-high-contrast: active),(forced-colors: active){nx-dropdown.cdk-keyboard-focused{box-shadow:0 0 0 2px background,0 0 0 6px windowText;outline:4px solid CanvasText;outline-offset:2px}}nx-dropdown ::ng-deep .nx-dropdown__container{padding-right:0}nx-dropdown ::ng-deep .nx-dropdown__icon{margin-left:8px}nx-dropdown ::ng-deep .nx-dropdown__rendered{font-size:16px;line-height:24px}:host-context(.nx-formfield.has-outline) nx-dropdown{margin-left:7px}:host-context(.nx-formfield.has-outline) input{padding-left:0}:host-context(.nx-formfield.has-outline) ::ng-deep .nx-dropdown__container{padding:0}:host-context(.is-disabled) input{cursor:not-allowed}input{text-align:inherit;font-size:inherit;font-weight:inherit;background:0 0;color:inherit;border:none;outline:0;padding:0;margin:0}:host-context([dir=rtl]) nx-dropdown{margin-right:0;margin-left:8px}:host-context([dir=rtl]) nx-dropdown ::ng-deep .nx-dropdown__icon{margin-right:8px;margin-left:0}:host-context([dir=rtl]):host-context(.nx-formfield.has-outline) nx-dropdown{margin-right:7px;margin-left:8px}:host-context([dir=rtl]):host-context(.nx-formfield.has-outline) input{padding-left:7px;padding-right:0}\n"], components: [{ type: i6.NxDropdownComponent, selector: "nx-dropdown", inputs: ["options", "filterInputType", "tabIndex", "nxValue", "nxDisabled", "nxIsMultiselect", "nxRequired", "nxStyle", "placeholder", "nxIgnoreItemTrunctation", "nxShowFilter", "nxFilterPlaceholder", "nxOverlayLabel", "nxValueFormatter", "compareWith", "filterFn"], outputs: ["openedChange", "filterResult", "opened", "closed", "filterInput", "nxValueChange", "selectionChange"] }], directives: [{ type: i6.NxDropdownClosedLabelDirective, selector: "[nxClosedLabel]" }, { type: i5.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { type: i5.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { type: i5.NgModel, selector: "[ngModel]:not([formControlName]):not([formControl])", inputs: ["name", "disabled", "ngModel", "ngModelOptions"], outputs: ["ngModelChange"], exportAs: ["ngModel"] }, { type: i5.RequiredValidator, selector: ":not([type=checkbox])[required][formControlName],:not([type=checkbox])[required][formControl],:not([type=checkbox])[required][ngModel]", inputs: ["required"] }, { type: i7.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.3.1", ngImport: i0, type: NxPhoneInputComponent, decorators: [{
            type: Component,
            args: [{ selector: 'nx-phone-input', changeDetection: ChangeDetectionStrategy.OnPush, providers: [{ provide: NxFormfieldControl, useExisting: NxPhoneInputComponent }], host: {
                        '[attr.id]': 'id',
                    }, template: "<div class=\"wrapper\">\n    <nx-dropdown\n        [class.hide]=\"readonly && !disabled\"\n        [nxValue]=\"countryCode\"\n        #dropdown\n        [nxShowFilter]=\"true\"\n        [nxDisabled]=\"disabled\"\n        [nxOverlayLabel]=\"areaCodeLabel\"\n        (nxValueChange)=\"_onCountryChange($event)\"\n        [options]=\"_sortedCountries\"\n    >\n        <span *nxClosedLabel>+{{ _getCallingCode(dropdown.value) }}</span>\n    </nx-dropdown>\n\n    <!-- adding c-input for the styles and to not get the overhead of the nxInput directive -->\n    <input\n        class=\"c-input\"\n        [class.hide]=\"readonly && !disabled\"\n        type=\"tel\"\n        (blur)=\"_onInputBlur()\"\n        [(ngModel)]=\"_inputValue\"\n        (ngModelChange)=\"_onInput()\"\n        [attr.aria-describedby]=\"_describedBy\"\n        [attr.aria-labelledby]=\"_ariaLabelledBy\"\n        [attr.required]=\"required || null\"\n        [attr.disabled]=\"disabled || null\"\n        [attr.placeholder]=\"placeholder || null\"\n    />\n\n    <input\n        class=\"c-input readonly-input\"\n        *ngIf=\"readonly && !disabled\"\n        type=\"tel\"\n        [attr.readonly]=\"readonly || null\"\n        [attr.aria-readonly]=\"readonly || null\"\n        [value]=\"_getReadonlyValue()\"\n        [attr.aria-describedby]=\"_describedBy\"\n        [attr.aria-labelledby]=\"_ariaLabelledBy\"\n    />\n</div>\n", styles: [":host{display:block;width:100%}.wrapper{display:flex;height:100%;align-items:center}.hide{display:none;visibility:hidden}input{flex:1}.readonly-input{margin-left:7px}nx-dropdown{width:auto;margin-right:8px}nx-dropdown.cdk-keyboard-focused{box-shadow:var(--focus-box-shadow);border-radius:4px}@media screen and (-ms-high-contrast: active),(forced-colors: active){nx-dropdown.cdk-keyboard-focused{box-shadow:0 0 0 2px background,0 0 0 6px windowText;outline:4px solid CanvasText;outline-offset:2px}}nx-dropdown ::ng-deep .nx-dropdown__container{padding-right:0}nx-dropdown ::ng-deep .nx-dropdown__icon{margin-left:8px}nx-dropdown ::ng-deep .nx-dropdown__rendered{font-size:16px;line-height:24px}:host-context(.nx-formfield.has-outline) nx-dropdown{margin-left:7px}:host-context(.nx-formfield.has-outline) input{padding-left:0}:host-context(.nx-formfield.has-outline) ::ng-deep .nx-dropdown__container{padding:0}:host-context(.is-disabled) input{cursor:not-allowed}input{text-align:inherit;font-size:inherit;font-weight:inherit;background:0 0;color:inherit;border:none;outline:0;padding:0;margin:0}:host-context([dir=rtl]) nx-dropdown{margin-right:0;margin-left:8px}:host-context([dir=rtl]) nx-dropdown ::ng-deep .nx-dropdown__icon{margin-right:8px;margin-left:0}:host-context([dir=rtl]):host-context(.nx-formfield.has-outline) nx-dropdown{margin-right:7px;margin-left:8px}:host-context([dir=rtl]):host-context(.nx-formfield.has-outline) input{padding-left:7px;padding-right:0}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i1.FocusMonitor }, { type: i0.ChangeDetectorRef }, { type: i2.ErrorStateMatcher }, { type: i3.NxPhoneInputIntl }, { type: i4.NxFormfieldComponent, decorators: [{
                    type: Optional
                }] }, { type: i5.NgControl, decorators: [{
                    type: Optional
                }, {
                    type: Self
                }] }, { type: i5.NgForm, decorators: [{
                    type: Optional
                }] }, { type: i5.FormGroupDirective, decorators: [{
                    type: Optional
                }] }]; }, propDecorators: { dropdown: [{
                type: ViewChild,
                args: [NxDropdownComponent, { static: true }]
            }], id: [{
                type: Input
            }], required: [{
                type: Input
            }], disabled: [{
                type: Input
            }], readonly: [{
                type: Input
            }], countryCode: [{
                type: Input
            }], areaCodeLabel: [{
                type: Input
            }], countryNames: [{
                type: Input
            }], placeholder: [{
                type: Input
            }], inputFormatter: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGhvbmUtaW5wdXQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvbmctYXF1aWxhL3NyYy9waG9uZS1pbnB1dC9waG9uZS1pbnB1dC5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi9wcm9qZWN0cy9uZy1hcXVpbGEvc3JjL3Bob25lLWlucHV0L3Bob25lLWlucHV0LmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsT0FBTyxFQUFnQixxQkFBcUIsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQzVFLE9BQU8sRUFFSCx1QkFBdUIsRUFFdkIsU0FBUyxFQUdULEtBQUssRUFHTCxRQUFRLEVBQ1IsSUFBSSxFQUNKLFNBQVMsR0FDWixNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQUUsbUJBQW1CLEVBQW9CLE1BQU0sNEJBQTRCLENBQUM7QUFDbkYsT0FBTyxFQUF3QixrQkFBa0IsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBR3ZGLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0IsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRTNDLE9BQU8sRUFBRSwrQkFBK0IsRUFBRSw0QkFBNEIsRUFBRSx3QkFBd0IsRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDOzs7Ozs7Ozs7QUFHaEosSUFBSSxJQUFJLEdBQUcsQ0FBQyxDQUFDO0FBWWIsTUFBTSxPQUFPLHFCQUFxQjtJQThKOUIsWUFDWSxXQUF1QixFQUN2QixhQUEyQixFQUMzQixJQUF1QixFQUN2QixrQkFBcUMsRUFDckMsS0FBdUIsRUFDWCxrQkFBK0M7SUFDbkUsb0JBQW9CLENBQTRCLFNBQTJCLEVBQ3ZELFdBQTBCLEVBQzFCLGdCQUEyQztRQVJ2RCxnQkFBVyxHQUFYLFdBQVcsQ0FBWTtRQUN2QixrQkFBYSxHQUFiLGFBQWEsQ0FBYztRQUMzQixTQUFJ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QUksSUFBSTs7MEJBQ3JDLFFBQVE7OzBCQUNSLFFBQVE7NENBdEtxQyxRQUFRO3NCQUF6RCxTQUFTO3VCQUFDLG1CQUFtQixFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtnQkFzQjVDLEVBQUU7c0JBREwsS0FBSztnQkFVTyxRQUFRO3NCQUFwQixLQUFLO2dCQWdCRixRQUFRO3NCQURYLEtBQUs7Z0JBWUYsUUFBUTtzQkFEWCxLQUFLO2dCQWlCRixXQUFXO3NCQURkLEtBQUs7Z0JBZ0JGLGFBQWE7c0JBRGhCLEtBQUs7Z0JBWUYsWUFBWTtzQkFEZixLQUFLO2dCQWFGLFdBQVc7c0JBRGQsS0FBSztnQkFnQkYsY0FBYztzQkFEakIsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEZvY3VzTW9uaXRvciB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9hMTF5JztcbmltcG9ydCB7IEJvb2xlYW5JbnB1dCwgY29lcmNlQm9vbGVhblByb3BlcnR5IH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2NvZXJjaW9uJztcbmltcG9ydCB7XG4gICAgQWZ0ZXJWaWV3SW5pdCxcbiAgICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICBDb21wb25lbnQsXG4gICAgRG9DaGVjayxcbiAgICBFbGVtZW50UmVmLFxuICAgIElucHV0LFxuICAgIE9uRGVzdHJveSxcbiAgICBPbkluaXQsXG4gICAgT3B0aW9uYWwsXG4gICAgU2VsZixcbiAgICBWaWV3Q2hpbGQsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29udHJvbFZhbHVlQWNjZXNzb3IsIEZvcm1Db250cm9sLCBGb3JtR3JvdXBEaXJlY3RpdmUsIE5nQ29udHJvbCwgTmdGb3JtIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgTnhEcm9wZG93bkNvbXBvbmVudCwgTnhEcm9wZG93bk9wdGlvbiB9IGZyb20gJ0BhcG9zaW4vbmctYXF1aWxhL2Ryb3Bkb3duJztcbmltcG9ydCB7IE54Rm9ybWZpZWxkQ29tcG9uZW50LCBOeEZvcm1maWVsZENvbnRyb2wgfSBmcm9tICdAYXBvc2luL25nLWFxdWlsYS9mb3JtZmllbGQnO1xuaW1wb3J0IHsgRXJyb3JTdGF0ZU1hdGNoZXIgfSBmcm9tICdAYXBvc2luL25nLWFxdWlsYS91dGlscyc7XG5pbXBvcnQgeyBMb2NhbGl6ZWRDb3VudHJ5TmFtZXMgfSBmcm9tICdpMThuLWlzby1jb3VudHJpZXMnO1xuaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgdGFrZVVudGlsIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5pbXBvcnQgeyBnZXRDb3VudHJ5Q2FsbGluZ0NvZGVGcm9tTnVtYmVyLCBnZXRDb3VudHJ5Q29kZWZvckNhbGxpbmdDb2RlLCBnZXREaWFsQ29kZUJ5Q291bnRyeUNvZGUsIGdldFNvcnRlZENvdW50cnlDb2RlcyB9IGZyb20gJy4vY291bnRyeS1kYXRhJztcbmltcG9ydCB7IE54UGhvbmVJbnB1dEludGwgfSBmcm9tICcuL3Bob25lLWlucHV0LWludGwnO1xuXG5sZXQgbmV4dCA9IDA7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnbngtcGhvbmUtaW5wdXQnLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9waG9uZS1pbnB1dC5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vcGhvbmUtaW5wdXQuY29tcG9uZW50LnNjc3MnXSxcbiAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgICBwcm92aWRlcnM6IFt7IHByb3ZpZGU6IE54Rm9ybWZpZWxkQ29udHJvbCwgdXNlRXhpc3Rpbmc6IE54UGhvbmVJbnB1dENvbXBvbmVudCB9XSxcbiAgICBob3N0OiB7XG4gICAgICAgICdbYXR0ci5pZF0nOiAnaWQnLFxuICAgIH0sXG59KVxuZXhwb3J0IGNsYXNzIE54UGhvbmVJbnB1dENvbXBvbmVudCBpbXBsZW1lbnRzIENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBOeEZvcm1maWVsZENvbnRyb2w8YW55PiwgT25EZXN0cm95LCBEb0NoZWNrLCBPbkluaXQsIEFmdGVyVmlld0luaXQge1xuICAgIEBWaWV3Q2hpbGQoTnhEcm9wZG93bkNvbXBvbmVudCwgeyBzdGF0aWM6IHRydWUgfSkgZHJvcGRvd24hOiBOeERyb3Bkb3duQ29tcG9uZW50O1xuXG4gICAgdmFsdWU6IGFueTtcblxuICAgIF9pbnB1dFZhbHVlID0gJyc7XG5cbiAgICBfZGVzY3JpYmVkQnkgPSAnJztcblxuICAgIHJlYWRvbmx5IHN0YXRlQ2hhbmdlcyA9IG5ldyBTdWJqZWN0PGFueT4oKTtcblxuICAgIGdldCBlbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5faW5wdXRWYWx1ZTtcbiAgICB9XG5cbiAgICBmb2N1c2VkID0gZmFsc2U7XG5cbiAgICBwcml2YXRlIF91aWQgPSAncGhvbmUtaW5wdXQtJyArIG5leHQrKztcblxuICAgIHByaXZhdGUgX2lkITogc3RyaW5nO1xuXG4gICAgLyoqIFNldHMgdGhlIGlkIG9mIHRoZSBwaG9uZSBpbnB1dCBjb21wb25lbnQuICovXG4gICAgQElucHV0KClcbiAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pZCB8fCB0aGlzLl91aWQ7XG4gICAgfVxuICAgIHNldCBpZCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX2lkID0gdmFsdWU7XG4gICAgICAgIHRoaXMuc3RhdGVDaGFuZ2VzLm5leHQoKTtcbiAgICB9XG5cbiAgICAvKiogV2hldGhlciB0aGUgY29tcG9uZW50IHNob3VsZCBiZSByZXF1aXJlZC4gKi9cbiAgICBASW5wdXQoKSBzZXQgcmVxdWlyZWQodmFsdWU6IEJvb2xlYW5JbnB1dCkge1xuICAgICAgICBjb25zdCBjb2VyY2VkVmFsdWUgPSBjb2VyY2VCb29sZWFuUHJvcGVydHkodmFsdWUpO1xuICAgICAgICBpZiAodGhpcy4jcmVxdWlyZWQgIT09IGNvZXJjZWRWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy4jcmVxdWlyZWQgPSBjb2VyY2VkVmFsdWU7XG4gICAgICAgICAgICB0aGlzLl9jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IHJlcXVpcmVkKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy4jcmVxdWlyZWQ7XG4gICAgfVxuICAgICNyZXF1aXJlZCA9IGZhbHNlO1xuXG4gICAgcHJpdmF0ZSBfZGlzYWJsZWQgPSBmYWxzZTtcblxuICAgIC8qKiBXaGV0aGVyIHRoZSBjb21wb25lbnQgc2hvdWxkIGJlIGRpc2FibGVkLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgZ2V0IGRpc2FibGVkKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGlzYWJsZWQ7XG4gICAgfVxuICAgIHNldCBkaXNhYmxlZCh2YWx1ZTogQm9vbGVhbklucHV0KSB7XG4gICAgICAgIHRoaXMuX2Rpc2FibGVkID0gdmFsdWUhIGFzIGFueTsgLy8gVE9ETyBwcm9wZXJseSBjb2VyY2UgaW5wdXQgdmFsdWVcbiAgICB9XG5cbiAgICBwcml2YXRlIF9yZWFkb25seSA9IGZhbHNlO1xuXG4gICAgLyoqIFdoZXRoZXIgdGhlIGNvbXBvbmVudCBzaG91bGQgYmUgcmVhZCBvbmx5LiAqL1xuICAgIEBJbnB1dCgpXG4gICAgZ2V0IHJlYWRvbmx5KCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVhZG9ubHk7XG4gICAgfVxuICAgIHNldCByZWFkb25seSh2YWx1ZTogQm9vbGVhbklucHV0KSB7XG4gICAgICAgIHRoaXMuX3JlYWRvbmx5ID0gY29lcmNlQm9vbGVhblByb3BlcnR5KHZhbHVlKTtcbiAgICAgICAgdGhpcy5zdGF0ZUNoYW5nZXMubmV4dCgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2NvdW50cnlDb2RlID0gJ0RFJztcbiAgICBwcml2YXRlIF9pbml0aWFsQ291bnRyeUNvZGUgPSAnREUnO1xuXG4gICAgLyoqIFNldHMgdGhlIGluaXRpYWwgY291bnRyeSB0byBiZSBzZWxlY3RlZCBpbiB0aGUgZHJvcGRvd24uIEZvcm1hdCBpcyB0aGUgaW50ZXJuYXRpb25hbFxuICAgICAqIGNvdW50cnkgY29kZSBsaWtlIERFLCBVUy5cbiAgICAgKiBJZiB0aGVyZSBpcyBhbHJlYWR5IGEgbnVtYmVyIGluIHRoZSBpbnB1dCBmaWVsZCBjaGFuZ2luZyB0aGlzIHByb3BlcnR5IGhhcyBubyBlZmZlY3QuXG4gICAgICovXG4gICAgQElucHV0KClcbiAgICBzZXQgY291bnRyeUNvZGUodmFsdWU6IHN0cmluZykge1xuICAgICAgICBpZiAodGhpcy5faW5wdXRWYWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2luaXRpYWxDb3VudHJ5Q29kZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLl9jb3VudHJ5Q29kZSA9IHZhbHVlO1xuICAgIH1cbiAgICBnZXQgY291bnRyeUNvZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb3VudHJ5Q29kZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9hcmVhQ29kZUxhYmVsITogc3RyaW5nO1xuXG4gICAgLyoqIFNldCB0aGUgdGV4dCBhdCB0aGUgdG9wIG9mIHRoZSBkcm9wZG93bi4gVGhlIGRlZmF1bHQgdmFsdWUgaXMgJ0FyZWEgQ29kZScuICovXG4gICAgQElucHV0KClcbiAgICBnZXQgYXJlYUNvZGVMYWJlbCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FyZWFDb2RlTGFiZWwgfHwgdGhpcy5faW50bC5hcmVhQ29kZUxhYmVsO1xuICAgIH1cbiAgICBzZXQgYXJlYUNvZGVMYWJlbCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX2FyZWFDb2RlTGFiZWwgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9jb3VudHJ5TmFtZXMhOiBMb2NhbGl6ZWRDb3VudHJ5TmFtZXM8YW55PjtcblxuICAgIC8qKiBTZXQgdGhlIHRyYW5zbGF0aW9ucyBvZiB0aGUgY291bnRyaWVzLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgZ2V0IGNvdW50cnlOYW1lcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvdW50cnlOYW1lcyB8fCB0aGlzLl9pbnRsLmNvdW50cnlOYW1lcztcbiAgICB9XG4gICAgc2V0IGNvdW50cnlOYW1lcyh2YWx1ZTogTG9jYWxpemVkQ291bnRyeU5hbWVzPGFueT4pIHtcbiAgICAgICAgdGhpcy5fY291bnRyeU5hbWVzID0gdmFsdWU7XG4gICAgICAgIHRoaXMuX3NvcnRDb3VudHJpZXMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9wbGFjZWhvbGRlciA9ICcnO1xuXG4gICAgLyoqIFRoZSBwbGFjZWhvbGRlciB0byBiZSBzaG93biBpbiB0aGUgaW5wdXQgZmllbGQuICovXG4gICAgQElucHV0KClcbiAgICBnZXQgcGxhY2Vob2xkZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wbGFjZWhvbGRlcjtcbiAgICB9XG4gICAgc2V0IHBsYWNlaG9sZGVyKHZhbHVlOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5zdGF0ZUNoYW5nZXMubmV4dCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRvIGZvcm1hdCB0aGUgdmFsdWUgaW4gdGhlIGlucHV0IHBhcnQgb2YgdGhlIGNvbXBvbmVudC5cbiAgICAgKiBUaGUgZnVuY3Rpb24gaXMgY2FsbGVkIG9uIGJsdXIuIFRoZSBkZWZhdWx0IGZ1bmN0aW9uIHJlbW92ZXMgbGVhZGluZyB6ZXJvcy5cbiAgICAgKiBQbGVhc2Ugbm90ZTogdG8gZGV0ZXJtaW5lIHRoZSBtb2RlbCB2YWx1ZSB0aGUgY29tcG9uZW50IHdpbGwgcmVtb3ZlIHBhcmVudGhlc2lzLFxuICAgICAqIHdoaXRlc3BhY2UgYW5kIGRhc2ggY2hhcmFjdGVycyBmcm9tIHRoZSBmb3JtYXR0ZWQgaW5wdXQuXG4gICAgICovXG4gICAgQElucHV0KClcbiAgICBnZXQgaW5wdXRGb3JtYXR0ZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbnB1dEZvcm1hdHRlcjtcbiAgICB9XG4gICAgc2V0IGlucHV0Rm9ybWF0dGVyKGZvcm1hdEZuKSB7XG4gICAgICAgIHRoaXMuX2lucHV0Rm9ybWF0dGVyID0gZm9ybWF0Rm47XG4gICAgICAgIHRoaXMuX2lucHV0VmFsdWUgPSB0aGlzLl9pbnB1dEZvcm1hdHRlcih0aGlzLl9pbnB1dFZhbHVlLCB0aGlzLl9jb3VudHJ5Q2FsbGluZ0NvZGUpO1xuICAgIH1cblxuICAgIC8vIFRPRE8gd2UgYXJlIGRpc2FibGluZyB0aGUgZmxvYXRpbmcgbGFiZWwgZm9yIG5vdy4gdGhlIHByb2JsZW0gaXM6IHRoZSBsYWJlbFxuICAgIC8vIGlzIHN1cHBvc2VkIHRvIGZsb2F0IG5leHQgdG8gdGhlIGRyb3Bkb3duLiB3ZSBjb3VsZCBpbnRyb2R1Y2Ugc29tZSBjaGFuZ2VzIHRvIHRoZVxuICAgIC8vIGZvcm1maWVsZCB0aGF0IGEgY29udHJvbCBjYW4gYWxzbyBnaXZlIHNvbWV0aGluZyBsaWtlIGFuIG9mZnNldCBmb3IgdGhlIGZsb2F0aW5nIGxhYmVsXG4gICAgLy8gYnV0IGZvciBjYXBhY2l0eSByZWFzb25zIHRoaXMgaGFzIHRvIGJlIGRvbmUgYXQgYSBsYXRlciBzdGFnZS5cbiAgICByZWFkb25seSBzaG91bGRMYWJlbEZsb2F0PzogYm9vbGVhbiA9IHRydWU7XG4gICAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgICBlcnJvclN0YXRlID0gZmFsc2U7XG4gICAgcmVhZG9ubHkgY29udHJvbFR5cGU/OiBzdHJpbmcgPSAnbngtcGhvbmUtaW5wdXQnO1xuXG4gICAgX3NvcnRlZENvdW50cmllcyE6IE54RHJvcGRvd25PcHRpb25bXTtcbiAgICBfY291bnRyeUNhbGxpbmdDb2RlID0gZ2V0RGlhbENvZGVCeUNvdW50cnlDb2RlKHRoaXMuY291bnRyeUNvZGUpO1xuXG4gICAgcHJpdmF0ZSByZWFkb25seSBfZGVzdHJveWVkID0gbmV3IFN1YmplY3Q8dm9pZD4oKTtcblxuICAgIHByaXZhdGUgX2lucHV0Rm9ybWF0dGVyID0gKGlucHV0VmFsdWU6IHN0cmluZywgY291bnRyeUNvZGU6IHN0cmluZykgPT4gdGhpcy5fcmVtb3ZlTGVhZGluZ1plcm8oaW5wdXRWYWx1ZSk7XG5cbiAgICAvKiogYFZpZXcgLT4gbW9kZWwgY2FsbGJhY2sgY2FsbGVkIHdoZW4gdmFsdWUgY2hhbmdlc2AgKi9cbiAgICBfb25DaGFuZ2U6ICh2YWx1ZTogYW55KSA9PiB2b2lkID0gKCkgPT4ge307XG5cbiAgICAvKiogYFZpZXcgLT4gbW9kZWwgY2FsbGJhY2sgY2FsbGVkIHdoZW4gc2VsZWN0IGhhcyBiZWVuIHRvdWNoZWRgICovXG4gICAgX29uVG91Y2hlZCA9ICgpID0+IHt9O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgX2VsZW1lbnRSZWY6IEVsZW1lbnRSZWYsXG4gICAgICAgIHByaXZhdGUgX2ZvY3VzTW9uaXRvcjogRm9jdXNNb25pdG9yLFxuICAgICAgICBwcml2YXRlIF9jZHI6IENoYW5nZURldGVjdG9yUmVmLFxuICAgICAgICBwcml2YXRlIF9lcnJvclN0YXRlTWF0Y2hlcjogRXJyb3JTdGF0ZU1hdGNoZXIsXG4gICAgICAgIHByaXZhdGUgX2ludGw6IE54UGhvbmVJbnB1dEludGwsXG4gICAgICAgIEBPcHRpb25hbCgpIHByaXZhdGUgZm9ybUZpZWxkQ29tcG9uZW50OiBOeEZvcm1maWVsZENvbXBvbmVudCB8IG51bGwsXG4gICAgICAgIC8qKiBAZG9jcy1wcml2YXRlICovIEBPcHRpb25hbCgpIEBTZWxmKCkgcHVibGljIG5nQ29udHJvbDogTmdDb250cm9sIHwgbnVsbCxcbiAgICAgICAgQE9wdGlvbmFsKCkgcHJpdmF0ZSBfcGFyZW50Rm9ybTogTmdGb3JtIHwgbnVsbCxcbiAgICAgICAgQE9wdGlvbmFsKCkgcHJpdmF0ZSBfcGFyZW50Rm9ybUdyb3VwOiBGb3JtR3JvdXBEaXJlY3RpdmUgfCBudWxsLFxuICAgICkge1xuICAgICAgICBpZiAodGhpcy5uZ0NvbnRyb2wpIHtcbiAgICAgICAgICAgIC8vIE5vdGU6IHdlIHByb3ZpZGUgdGhlIHZhbHVlIGFjY2Vzc29yIHRocm91Z2ggaGVyZSwgaW5zdGVhZCBvZlxuICAgICAgICAgICAgLy8gdGhlIGBwcm92aWRlcnNgIHRvIGF2b2lkIHJ1bm5pbmcgaW50byBhIGNpcmN1bGFyIGltcG9ydC5cbiAgICAgICAgICAgIHRoaXMubmdDb250cm9sLnZhbHVlQWNjZXNzb3IgPSB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgX2ludGwuY2hhbmdlcy5waXBlKHRha2VVbnRpbCh0aGlzLl9kZXN0cm95ZWQpKS5zdWJzY3JpYmUoXyA9PiB7XG4gICAgICAgICAgICB0aGlzLl9zb3J0Q291bnRyaWVzKCk7XG4gICAgICAgICAgICB0aGlzLl9jZHIuZGV0ZWN0Q2hhbmdlcygpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBuZ0RvQ2hlY2soKSB7XG4gICAgICAgIGlmICh0aGlzLm5nQ29udHJvbCkge1xuICAgICAgICAgICAgLy8gV2UgbmVlZCB0byByZS1ldmFsdWF0ZSB0aGlzIG9uIGV2ZXJ5IGNoYW5nZSBkZXRlY3Rpb24gY3ljbGUsIGJlY2F1c2UgdGhlcmUgYXJlIHNvbWVcbiAgICAgICAgICAgIC8vIGVycm9yIHRyaWdnZXJzIHRoYXQgd2UgY2FuJ3Qgc3Vic2NyaWJlIHRvIChlLmcuIHBhcmVudCBmb3JtIHN1Ym1pc3Npb25zKS4gVGhpcyBtZWFuc1xuICAgICAgICAgICAgLy8gdGhhdCB3aGF0ZXZlciBsb2dpYyBpcyBpbiBoZXJlIGhhcyB0byBiZSBzdXBlciBsZWFuIG9yIHdlIHJpc2sgZGVzdHJveWluZyB0aGUgcGVyZm9ybWFuY2UuXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUVycm9yU3RhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLl9zb3J0Q291bnRyaWVzKCk7XG4gICAgfVxuXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgICAgICB0aGlzLl9mb2N1c01vbml0b3IubW9uaXRvcih0aGlzLmRyb3Bkb3duLmVsZW1lbnRSZWYpO1xuICAgIH1cblxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICB0aGlzLl9kZXN0cm95ZWQubmV4dCgpO1xuICAgICAgICB0aGlzLl9kZXN0cm95ZWQuY29tcGxldGUoKTtcbiAgICB9XG5cbiAgICBzZXREZXNjcmliZWRCeUlkcyhpZHM6IHN0cmluZ1tdKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX2Rlc2NyaWJlZEJ5ID0gaWRzLmpvaW4oJyAnKTtcbiAgICAgICAgdGhpcy5kcm9wZG93bi5zZXREZXNjcmliZWRCeUlkcyhpZHMpO1xuICAgIH1cblxuICAgIGdldCBfYXJpYUxhYmVsbGVkQnkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvcm1GaWVsZENvbXBvbmVudD8ubGFiZWxJZDtcbiAgICB9XG5cbiAgICBnZXQgZWxlbWVudFJlZigpOiBFbGVtZW50UmVmPGFueT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudFJlZjtcbiAgICB9XG5cbiAgICB3cml0ZVZhbHVlKHZhbHVlOiBhbnkpOiB2b2lkIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnN0IG5vV2hpdGVzcGFjZU51bWJlciA9IHZhbHVlLnJlcGxhY2UoL1xccy9nLCAnJyk7XG4gICAgICAgICAgICBjb25zdCB7IGNvdW50cnlDYWxsaW5nQ29kZSwgbnVtYmVyIH0gPSBnZXRDb3VudHJ5Q2FsbGluZ0NvZGVGcm9tTnVtYmVyKG5vV2hpdGVzcGFjZU51bWJlciB8fCAnKycgKyBnZXREaWFsQ29kZUJ5Q291bnRyeUNvZGUodGhpcy5jb3VudHJ5Q29kZSkpOyAvLyByZXF1aXJlcyBzdHJpbmcgc3RhcnRpbmcgd2l0aCAnKydcbiAgICAgICAgICAgIHRoaXMuX2NvdW50cnlDYWxsaW5nQ29kZSA9IGNvdW50cnlDYWxsaW5nQ29kZTtcbiAgICAgICAgICAgIHRoaXMuX2lucHV0VmFsdWUgPSB0aGlzLmlucHV0Rm9ybWF0dGVyKG51bWJlciwgY291bnRyeUNhbGxpbmdDb2RlKTtcbiAgICAgICAgICAgIHRoaXMuX2NvdW50cnlDb2RlID0gZ2V0Q291bnRyeUNvZGVmb3JDYWxsaW5nQ29kZShjb3VudHJ5Q2FsbGluZ0NvZGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9ICcnO1xuICAgICAgICAgICAgdGhpcy5faW5wdXRWYWx1ZSA9ICcnO1xuICAgICAgICAgICAgdGhpcy5fY291bnRyeUNvZGUgPSB0aGlzLl9pbml0aWFsQ291bnRyeUNvZGU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cblxuICAgIHJlZ2lzdGVyT25DaGFuZ2UoZm46IGFueSk6IHZvaWQge1xuICAgICAgICB0aGlzLl9vbkNoYW5nZSA9IGZuO1xuICAgIH1cblxuICAgIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiBhbnkpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fb25Ub3VjaGVkID0gZm47XG4gICAgfVxuXG4gICAgc2V0RGlzYWJsZWRTdGF0ZShpc0Rpc2FibGVkOiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZGlzYWJsZWQgPSBpc0Rpc2FibGVkO1xuICAgICAgICB0aGlzLl9jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgICAgIHRoaXMuc3RhdGVDaGFuZ2VzLm5leHQoKTtcbiAgICB9XG5cbiAgICB1cGRhdGVFcnJvclN0YXRlKCkge1xuICAgICAgICBjb25zdCBvbGRTdGF0ZSA9IHRoaXMuZXJyb3JTdGF0ZTtcbiAgICAgICAgY29uc3QgcGFyZW50ID0gdGhpcy5fcGFyZW50Rm9ybUdyb3VwIHx8IHRoaXMuX3BhcmVudEZvcm07XG4gICAgICAgIGNvbnN0IGNvbnRyb2wgPSB0aGlzLm5nQ29udHJvbCA/ICh0aGlzLm5nQ29udHJvbC5jb250cm9sIGFzIEZvcm1Db250cm9sKSA6IG51bGw7XG4gICAgICAgIGNvbnN0IG5ld1N0YXRlID0gdGhpcy5fZXJyb3JTdGF0ZU1hdGNoZXIuaXNFcnJvclN0YXRlKGNvbnRyb2wsIHBhcmVudCk7XG5cbiAgICAgICAgaWYgKG5ld1N0YXRlICE9PSBvbGRTdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5lcnJvclN0YXRlID0gbmV3U3RhdGU7XG4gICAgICAgICAgICB0aGlzLnN0YXRlQ2hhbmdlcy5uZXh0KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfb25JbnB1dEJsdXIoKSB7XG4gICAgICAgIHRoaXMuX29uVG91Y2hlZCgpO1xuICAgICAgICB0aGlzLl9pbnB1dFZhbHVlID0gdGhpcy5pbnB1dEZvcm1hdHRlcih0aGlzLl9pbnB1dFZhbHVlLCB0aGlzLl9jb3VudHJ5Q2FsbGluZ0NvZGUpO1xuICAgIH1cblxuICAgIF9vbklucHV0KCkge1xuICAgICAgICB0aGlzLnVwZGF0ZU1vZGVsKCk7XG4gICAgfVxuXG4gICAgX29uQ291bnRyeUNoYW5nZShjb3VudHJ5Q29kZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX2NvdW50cnlDb2RlID0gY291bnRyeUNvZGU7XG4gICAgICAgIHRoaXMuX2NvdW50cnlDYWxsaW5nQ29kZSA9IGdldERpYWxDb2RlQnlDb3VudHJ5Q29kZSh0aGlzLmNvdW50cnlDb2RlKTtcbiAgICAgICAgdGhpcy5faW5wdXRWYWx1ZSA9IHRoaXMuaW5wdXRGb3JtYXR0ZXIodGhpcy5faW5wdXRWYWx1ZSwgdGhpcy5fY291bnRyeUNhbGxpbmdDb2RlKTtcblxuICAgICAgICB0aGlzLl9vbklucHV0KCk7XG4gICAgfVxuXG4gICAgdXBkYXRlTW9kZWwoKSB7XG4gICAgICAgIGNvbnN0IGhhc051bWJlciA9IHR5cGVvZiB0aGlzLl9pbnB1dFZhbHVlID09PSAnc3RyaW5nJyAmJiB0aGlzLl9yZW1vdmVMZWFkaW5nWmVybyh0aGlzLl90cmltSW5wdXRWYWx1ZSh0aGlzLl9pbnB1dFZhbHVlKSkubGVuZ3RoID4gMDtcblxuICAgICAgICBpZiAoaGFzTnVtYmVyKSB7XG4gICAgICAgICAgICB0aGlzLl9vbkNoYW5nZSh0aGlzLmdldE1vZGVsVmFsdWUoKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9vbkNoYW5nZSgnJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIF90cmltSW5wdXRWYWx1ZSh2YWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKC9bXFxzKClcXC0vXS9nLCAnJyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfcmVtb3ZlTGVhZGluZ1plcm8odmFsdWU6IHN0cmluZykge1xuICAgICAgICByZXR1cm4gdmFsdWUucmVwbGFjZSgvXjAvLCAnJyk7XG4gICAgfVxuXG4gICAgLyoqIFJldHVybnMgdGhlIGNvbWJpbmVkIHN0cmluZyBvZiBzZWxlY3RlZCBjYWxsaW5nIGNvZGUgKyBpbnB1dCBudW1iZXIgKi9cbiAgICBnZXRNb2RlbFZhbHVlKCkge1xuICAgICAgICByZXR1cm4gJysnICsgdGhpcy5fZ2V0Q2FsbGluZ0NvZGUodGhpcy5kcm9wZG93bi52YWx1ZSkgKyB0aGlzLl90cmltSW5wdXRWYWx1ZSh0aGlzLl9yZW1vdmVMZWFkaW5nWmVybyh0aGlzLl9pbnB1dFZhbHVlKSk7XG4gICAgfVxuXG4gICAgX2dldENhbGxpbmdDb2RlKGNvdW50cnk6IHN0cmluZykge1xuICAgICAgICByZXR1cm4gZ2V0RGlhbENvZGVCeUNvdW50cnlDb2RlKGNvdW50cnkpO1xuICAgIH1cblxuICAgIF9zb3J0Q291bnRyaWVzKCkge1xuICAgICAgICB0aGlzLl9zb3J0ZWRDb3VudHJpZXMgPSBnZXRTb3J0ZWRDb3VudHJ5Q29kZXModGhpcy5jb3VudHJ5TmFtZXMpLm1hcChjb3VudHJ5ID0+IHRoaXMuX2dldERyb3Bkb3duT3B0aW9uKGNvdW50cnkpKTtcbiAgICB9XG5cbiAgICBfZ2V0RHJvcGRvd25PcHRpb24oY291bnRyeTogc3RyaW5nKTogTnhEcm9wZG93bk9wdGlvbiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogY291bnRyeSxcbiAgICAgICAgICAgIGxhYmVsOiBgJHt0aGlzLl9nZXRDb3VudHJ5TmFtZShjb3VudHJ5KX0gKCske3RoaXMuX2dldENhbGxpbmdDb2RlKGNvdW50cnkpfSlgLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIF9nZXRDb3VudHJ5TmFtZShjb3VudHJ5Q29kZTogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmNvdW50cnlOYW1lc1tjb3VudHJ5Q29kZV07XG4gICAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KG5hbWUpID8gbmFtZVswXSA6IG5hbWU7XG4gICAgfVxuXG4gICAgX2dldFJlYWRvbmx5VmFsdWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE1vZGVsVmFsdWUoKTtcbiAgICB9XG59XG4iLCI8ZGl2IGNsYXNzPVwid3JhcHBlclwiPlxuICAgIDxueC1kcm9wZG93blxuICAgICAgICBbY2xhc3MuaGlkZV09XCJyZWFkb25seSAmJiAhZGlzYWJsZWRcIlxuICAgICAgICBbbnhWYWx1ZV09XCJjb3VudHJ5Q29kZVwiXG4gICAgICAgICNkcm9wZG93blxuICAgICAgICBbbnhTaG93RmlsdGVyXT1cInRydWVcIlxuICAgICAgICBbbnhEaXNhYmxlZF09XCJkaXNhYmxlZFwiXG4gICAgICAgIFtueE92ZXJsYXlMYWJlbF09XCJhcmVhQ29kZUxhYmVsXCJcbiAgICAgICAgKG54VmFsdWVDaGFuZ2UpPVwiX29uQ291bnRyeUNoYW5nZSgkZXZlbnQpXCJcbiAgICAgICAgW29wdGlvbnNdPVwiX3NvcnRlZENvdW50cmllc1wiXG4gICAgPlxuICAgICAgICA8c3BhbiAqbnhDbG9zZWRMYWJlbD4re3sgX2dldENhbGxpbmdDb2RlKGRyb3Bkb3duLnZhbHVlKSB9fTwvc3Bhbj5cbiAgICA8L254LWRyb3Bkb3duPlxuXG4gICAgPCEtLSBhZGRpbmcgYy1pbnB1dCBmb3IgdGhlIHN0eWxlcyBhbmQgdG8gbm90IGdldCB0aGUgb3ZlcmhlYWQgb2YgdGhlIG54SW5wdXQgZGlyZWN0aXZlIC0tPlxuICAgIDxpbnB1dFxuICAgICAgICBjbGFzcz1cImMtaW5wdXRcIlxuICAgICAgICBbY2xhc3MuaGlkZV09XCJyZWFkb25seSAmJiAhZGlzYWJsZWRcIlxuICAgICAgICB0eXBlPVwidGVsXCJcbiAgICAgICAgKGJsdXIpPVwiX29uSW5wdXRCbHVyKClcIlxuICAgICAgICBbKG5nTW9kZWwpXT1cIl9pbnB1dFZhbHVlXCJcbiAgICAgICAgKG5nTW9kZWxDaGFuZ2UpPVwiX29uSW5wdXQoKVwiXG4gICAgICAgIFthdHRyLmFyaWEtZGVzY3JpYmVkYnldPVwiX2Rlc2NyaWJlZEJ5XCJcbiAgICAgICAgW2F0dHIuYXJpYS1sYWJlbGxlZGJ5XT1cIl9hcmlhTGFiZWxsZWRCeVwiXG4gICAgICAgIFthdHRyLnJlcXVpcmVkXT1cInJlcXVpcmVkIHx8IG51bGxcIlxuICAgICAgICBbYXR0ci5kaXNhYmxlZF09XCJkaXNhYmxlZCB8fCBudWxsXCJcbiAgICAgICAgW2F0dHIucGxhY2Vob2xkZXJdPVwicGxhY2Vob2xkZXIgfHwgbnVsbFwiXG4gICAgLz5cblxuICAgIDxpbnB1dFxuICAgICAgICBjbGFzcz1cImMtaW5wdXQgcmVhZG9ubHktaW5wdXRcIlxuICAgICAgICAqbmdJZj1cInJlYWRvbmx5ICYmICFkaXNhYmxlZFwiXG4gICAgICAgIHR5cGU9XCJ0ZWxcIlxuICAgICAgICBbYXR0ci5yZWFkb25seV09XCJyZWFkb25seSB8fCBudWxsXCJcbiAgICAgICAgW2F0dHIuYXJpYS1yZWFkb25seV09XCJyZWFkb25seSB8fCBudWxsXCJcbiAgICAgICAgW3ZhbHVlXT1cIl9nZXRSZWFkb25seVZhbHVlKClcIlxuICAgICAgICBbYXR0ci5hcmlhLWRlc2NyaWJlZGJ5XT1cIl9kZXNjcmliZWRCeVwiXG4gICAgICAgIFthdHRyLmFyaWEtbGFiZWxsZWRieV09XCJfYXJpYUxhYmVsbGVkQnlcIlxuICAgIC8+XG48L2Rpdj5cbiJdfQ==
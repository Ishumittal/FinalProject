import { coerceBooleanProperty } from '@angular/cdk/coercion';
import { ChangeDetectionStrategy, Component, EventEmitter, forwardRef, HostListener, Input, Optional, Output, Self, ViewChild, } from '@angular/core';
import { NxMobileToggleButtonComponent } from '../mobile-toggle-button/mobile-toggle-button.component';
import { ToggleButton } from './toggle-button';
import * as i0 from "@angular/core";
import * as i1 from "../circle-toggle-group/circle-toggle-group.component";
import * as i2 from "@angular/cdk/collections";
import * as i3 from "@angular/cdk/a11y";
import * as i4 from "@angular/forms";
import * as i5 from "../icon-toggle-button/icon-toggle-button.component";
import * as i6 from "../mobile-toggle-button/mobile-toggle-button.component";
import * as i7 from "@angular/common";
export class ToggleChangeEvent {
    constructor(button, value) {
        this.button = button;
        this.value = value;
    }
}
let nextId = 0;
export class NxCircleToggleComponent extends ToggleButton {
    constructor(
    /** @docs-private */ toggleGroup, _checkedDispatcher, _cdr, _focusMonitor, ngControl) {
        super();
        this.toggleGroup = toggleGroup;
        this._checkedDispatcher = _checkedDispatcher;
        this._cdr = _cdr;
        this._focusMonitor = _focusMonitor;
        this.ngControl = ngControl;
        this._id = `toggle-button-${nextId++}`;
        /** @docs-private */
        this.inGroup = false;
        this.errorState = false;
        this._name = null;
        /**
         * An event that is emitted when the checked state fo the circle toggle changes.
         */
        this.checkedChange = new EventEmitter();
        /**
         * An event that is emitted when the checked state of the circle toggle changes.
         * The event object contains the circle toggle itself and its value (see ToggleChangeEvent).
         */
        this.selectionChange = new EventEmitter();
        this._checked = false;
        this._value = null;
        this._iconName = null;
        this._svg = null;
        this._svgChecked = null;
        this._circleText = null;
        this._label = null;
        this._hint = null;
        this._hover = false;
        /** touched is set to true on touch devices. */
        this._touched = false;
        this._removeUniqueSelectionListener = () => { };
        this.onChangeCallback = (checked) => { };
        this.onTouchedCallback = () => { };
        if (this.toggleGroup) {
            this.name = this.toggleGroup.name;
        }
        if (this.ngControl) {
            // Note: we provide the value accessor through here, instead of
            // the `providers` to avoid running into a circular import.
            this.ngControl.valueAccessor = this;
        }
    }
    /**
     * Id of the circle toggle.
     *
     * If not set, the circle toggle gets an incremented value by default.
     */
    set id(value) {
        this._id = value;
        this._cdr.markForCheck();
    }
    get id() {
        return this._id;
    }
    /** Name that is used for accessibility. */
    set name(value) {
        this._name = value;
        this._cdr.markForCheck();
    }
    get name() {
        return this._name;
    }
    /** Whether the circle toggle is checked. */
    set checked(value) {
        const newValue = coerceBooleanProperty(value);
        if (this.checked !== newValue) {
            this._checked = newValue;
            this._cdr.markForCheck();
        }
    }
    get checked() {
        return this._checked;
    }
    /** The value that is used in the model. */
    set value(newValue) {
        this._value = newValue;
        this._cdr.markForCheck();
    }
    get value() {
        return this._value;
    }
    /** Id of the icon that should be displayed. */
    set iconName(name) {
        this._iconName = name;
        this._cdr.markForCheck();
    }
    get iconName() {
        return this._iconName;
    }
    /** SVG that is displayed if the circle toggle is unchecked. */
    set svg(src) {
        this._svg = src;
        this._cdr.markForCheck();
    }
    get svg() {
        return this._svg;
    }
    /** SVG that is displayed if the circle toggle is checked. */
    set svgChecked(src) {
        this._svgChecked = src;
        this._cdr.markForCheck();
    }
    get svgChecked() {
        return this._svgChecked;
    }
    /** A text that is displayed inside the circle toggle. */
    set circleText(value) {
        if (value !== this._circleText) {
            this._circleText = value;
            this._cdr.markForCheck();
        }
    }
    get circleText() {
        return this._circleText;
    }
    /** Label displayed below the circle. */
    set label(value) {
        this._label = value;
        this._cdr.markForCheck();
    }
    get label() {
        return this._label;
    }
    /** Additional hint displayed below the label. */
    set hint(value) {
        this._hint = value;
        this._cdr.markForCheck();
    }
    get hint() {
        return this._hint;
    }
    /** Whether the circle toggle uses the negative set of styling. */
    set negative(value) {
        const newValue = coerceBooleanProperty(value);
        if (this.negative !== newValue) {
            this._negative = newValue;
            this._cdr.markForCheck();
        }
    }
    get negative() {
        return !!this._negative;
    }
    /** Whether the circle toggle has a responsive behavior. */
    set responsive(value) {
        const newValue = coerceBooleanProperty(value);
        if (this.responsive !== newValue) {
            this._responsive = newValue;
            this._cdr.markForCheck();
        }
    }
    get responsive() {
        return !!this._responsive;
    }
    /** Whether the circle toggle is disabled. */
    set disabled(value) {
        const newValue = coerceBooleanProperty(value);
        if (this.disabled !== newValue) {
            this._disabled = newValue;
            this._cdr.markForCheck();
        }
    }
    get disabled() {
        return !!this._disabled;
    }
    /** @docs-private */
    onMouseEnter() {
        if (!this._touched) {
            this._hover = true;
        }
    }
    /** @docs-private */
    onMouseLeave() {
        if (!this._touched) {
            this._hover = false;
        }
    }
    /** @docs-private */
    onTouchStart() {
        this._touched = true;
    }
    ngOnInit() {
        if (this.toggleGroup) {
            this.attachListenerForGroup();
        }
    }
    ngDoCheck() {
        if (this.ngControl) {
            // We need to re-evaluate this on every change detection cycle, because there are some
            // error triggers that we can't subscribe to (e.g. parent form submissions). This means
            // that whatever logic is in here has to be super lean or we risk destroying the performance.
            this.errorState = !this.ngControl.valid;
        }
    }
    ngAfterViewInit() {
        Promise.resolve().then(() => {
            if (this.toggleGroup) {
                this.inGroup = true;
                this.negative = this.toggleGroup.negative;
                this.disabled = this.toggleGroup.disabled;
                this.responsive = this.toggleGroup.responsive;
                this.id = this.toggleGroup.id + `-button-${nextId++}`;
            }
        });
        this._focusMonitor.monitor(this._nativeInput);
    }
    ngOnDestroy() {
        // function returned by the listener
        this._removeUniqueSelectionListener();
        this._focusMonitor.stopMonitoring(this._nativeInput);
    }
    /** @docs-private */
    attachListenerForGroup() {
        this._removeUniqueSelectionListener = this._checkedDispatcher.listen((groupId, buttonId) => {
            if (this.id !== buttonId && groupId === this.toggleGroup?.id) {
                this.checked = false;
            }
        });
    }
    writeValue(newValue) {
        this.checked = newValue;
    }
    registerOnChange(fn) {
        this.onChangeCallback = fn;
    }
    registerOnTouched(fn) {
        this.onTouchedCallback = fn;
    }
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
    }
    /** Focuses the radio button element. */
    focus(focusOrigin) {
        this._focusMonitor.focusVia(this._nativeInput, focusOrigin);
    }
    /** @docs-private */
    toggle(event) {
        event.preventDefault();
        event.stopPropagation();
        // TODO simplify if statement
        if (!((this.toggleGroup && this.checked) || this.disabled)) {
            this.checked = !this.checked;
            this.onChangeCallback(this.checked);
            this.checkedChange.emit(this.checked);
            this.selectionChange.emit(new ToggleChangeEvent(this, this.value));
            if (this.toggleGroup) {
                this._checkedDispatcher.notify(this.toggleGroup.id, this.id);
            }
        }
    }
    /**
     * @docs-private
     *
     * method called by the group if the internal value of the group is changed programatically,
     * does not trigger change emission
     */
    setGroupSelection() {
        if (!this.toggleGroup) {
            return;
        }
        // propagate changes only if the value in the group is different than the button checked value
        if (!this.checked) {
            this.checked = !this.checked;
            this.onChangeCallback(this.checked);
            this._checkedDispatcher.notify(this.toggleGroup.id, this.id);
        }
    }
    /** @docs-private */
    get svgButton() {
        return !!this.svg && !!this.svgChecked;
    }
    /** @docs-private */
    get svgUrl() {
        let useFilledSvg = this.checked || (!this.disabled && this._hover);
        if (this.negative) {
            useFilledSvg = !useFilledSvg;
        }
        return useFilledSvg ? this.svgChecked : this.svg;
    }
    /** @docs-private */
    get type() {
        return this.toggleGroup ? 'radio' : 'checkbox';
    }
    /** @docs-private */
    handleEnterKey(event) {
        if (!this.toggleGroup) {
            this.toggle(event);
        }
    }
}
NxCircleToggleComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.3.1", ngImport: i0, type: NxCircleToggleComponent, deps: [{ token: i1.NxCircleToggleGroupComponent, optional: true }, { token: i2.UniqueSelectionDispatcher }, { token: i0.ChangeDetectorRef }, { token: i3.FocusMonitor }, { token: i4.NgControl, optional: true, self: true }], target: i0.ɵɵFactoryTarget.Component });
NxCircleToggleComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.3.1", type: NxCircleToggleComponent, selector: "nx-circle-toggle", inputs: { name: "name", checked: "checked", value: "value", iconName: ["icon", "iconName"], svg: "svg", svgChecked: "svgChecked", circleText: "circleText", label: "label", hint: "hint", negative: "negative", responsive: "responsive", disabled: "disabled" }, outputs: { checkedChange: "checkedChange", selectionChange: "selectionChange" }, host: { listeners: { "mouseenter": "onMouseEnter()", "mouseleave": "onMouseLeave()", "touchstart": "onTouchStart()" }, properties: { "class.nx-toggle-circle": "true", "class.in-group": "inGroup", "class.is-disabled": "disabled", "class.is-responsive": "responsive", "class.has-error": "errorState" } }, providers: [
        {
            provide: ToggleButton,
            useExisting: forwardRef(() => NxCircleToggleComponent),
        },
    ], viewQueries: [{ propertyName: "_nativeInput", first: true, predicate: ["input"], descendants: true }, { propertyName: "toggleButton", first: true, predicate: NxMobileToggleButtonComponent, descendants: true, static: true }], usesInheritance: true, ngImport: i0, template: "<input\n    #input\n    [id]=\"id + '-input'\"\n    class=\"nx-circle-toggle__input\"\n    [attr.aria-labelledby]=\"id + '-label'\"\n    [type]=\"type\"\n    [attr.name]=\"name\"\n    [checked]=\"checked\"\n    [disabled]=\"disabled\"\n    [attr.aria-checked]=\"checked\"\n    (keydown.enter)=\"handleEnterKey($event)\"\n    (click)=\"toggle($event)\"\n/>\n<label class=\"nx-circle-toggle__label\" [for]=\"id + '-input'\" [id]=\"id + '-label'\">\n    <nx-icon-toggle-button\n        [label]=\"label\"\n        [hint]=\"hint\"\n        [checked]=\"checked\"\n        [icon]=\"iconName\"\n        [negative]=\"negative\"\n        [svg]=\"svgUrl\"\n        [disabled]=\"disabled\"\n        [inGroup]=\"inGroup\"\n        [touched]=\"_touched\"\n        [circleText]=\"circleText\"\n    >\n    </nx-icon-toggle-button>\n    <!-- The mobile toggle button is needed for the responsive mobile version of the component.\n    The display swtich is handled in the css. -->\n    <nx-mobile-toggle-button [label]=\"label\" [hint]=\"hint\" [checked]=\"checked\" [negative]=\"negative\" [disabled]=\"disabled\" [circleText]=\"circleText\">\n    </nx-mobile-toggle-button>\n    <ng-content select=\"nx-error\" *ngIf=\"errorState\"></ng-content>\n</label>\n", styles: [":host{display:inline-block;vertical-align:top;position:relative}:host:not(.is-responsive){opacity:.9999}:host .nx-circle-toggle__input{opacity:0;position:absolute}:host:not(.in-group){margin-right:64px}@media (max-width: 703px){:host:not(.in-group){margin-right:48px}}[dir=rtl] :host:not(.in-group){margin-right:0;margin-right:initial;margin-left:64px}@media (max-width: 703px){[dir=rtl] :host:not(.in-group){margin-right:0;margin-right:initial;margin-left:48px}}:host .nx-circle-toggle__input.cdk-keyboard-focused+.nx-circle-toggle__label ::ng-deep .nx-toggle-circle__icon-wrapper,:host .nx-circle-toggle__input.cdk-keyboard-focused+.nx-circle-toggle__label ::ng-deep .nx-toggle-circle__check-focus{box-shadow:var(--focus-box-shadow)}@media screen and (-ms-high-contrast: active),(forced-colors: active){:host .nx-circle-toggle__input.cdk-keyboard-focused+.nx-circle-toggle__label ::ng-deep .nx-toggle-circle__icon-wrapper,:host .nx-circle-toggle__input.cdk-keyboard-focused+.nx-circle-toggle__label ::ng-deep .nx-toggle-circle__check-focus{box-shadow:0 0 0 2px background,0 0 0 6px windowText;outline:4px solid CanvasText;outline-offset:2px}}:host .nx-circle-toggle__input.cdk-keyboard-focused+.nx-circle-toggle__label ::ng-deep nx-mobile-toggle-button{box-shadow:var(--focus-box-shadow);z-index:1}@media screen and (-ms-high-contrast: active),(forced-colors: active){:host .nx-circle-toggle__input.cdk-keyboard-focused+.nx-circle-toggle__label ::ng-deep nx-mobile-toggle-button{box-shadow:0 0 0 2px background,0 0 0 6px windowText;outline:4px solid CanvasText;outline-offset:2px}}:host(.has-error) ::ng-deep .is-flipped .nx-toggle-circle__check-icon,:host(.has-error) ::ng-deep .is-flipped .nx-toggle-circle__icon-wrapper{background-color:var(--danger)!important}:host(.has-error) ::ng-deep .nx-toggle-circle__icon-wrapper{border-color:var(--danger)!important}\n"], components: [{ type: i5.NxIconToggleButtonComponent, selector: "nx-icon-toggle-button", inputs: ["inGroup", "hint", "label", "checked", "icon", "svg", "disabled", "negative", "touched", "circleText"] }, { type: i6.NxMobileToggleButtonComponent, selector: "nx-mobile-toggle-button", inputs: ["checked", "negative", "disabled", "hint", "label", "circleText"] }], directives: [{ type: i7.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.3.1", ngImport: i0, type: NxCircleToggleComponent, decorators: [{
            type: Component,
            args: [{ selector: 'nx-circle-toggle', changeDetection: ChangeDetectionStrategy.OnPush, providers: [
                        {
                            provide: ToggleButton,
                            useExisting: forwardRef(() => NxCircleToggleComponent),
                        },
                    ], host: {
                        '[class.nx-toggle-circle]': 'true',
                        '[class.in-group]': 'inGroup',
                        '[class.is-disabled]': 'disabled',
                        '[class.is-responsive]': 'responsive',
                        '[class.has-error]': 'errorState',
                    }, template: "<input\n    #input\n    [id]=\"id + '-input'\"\n    class=\"nx-circle-toggle__input\"\n    [attr.aria-labelledby]=\"id + '-label'\"\n    [type]=\"type\"\n    [attr.name]=\"name\"\n    [checked]=\"checked\"\n    [disabled]=\"disabled\"\n    [attr.aria-checked]=\"checked\"\n    (keydown.enter)=\"handleEnterKey($event)\"\n    (click)=\"toggle($event)\"\n/>\n<label class=\"nx-circle-toggle__label\" [for]=\"id + '-input'\" [id]=\"id + '-label'\">\n    <nx-icon-toggle-button\n        [label]=\"label\"\n        [hint]=\"hint\"\n        [checked]=\"checked\"\n        [icon]=\"iconName\"\n        [negative]=\"negative\"\n        [svg]=\"svgUrl\"\n        [disabled]=\"disabled\"\n        [inGroup]=\"inGroup\"\n        [touched]=\"_touched\"\n        [circleText]=\"circleText\"\n    >\n    </nx-icon-toggle-button>\n    <!-- The mobile toggle button is needed for the responsive mobile version of the component.\n    The display swtich is handled in the css. -->\n    <nx-mobile-toggle-button [label]=\"label\" [hint]=\"hint\" [checked]=\"checked\" [negative]=\"negative\" [disabled]=\"disabled\" [circleText]=\"circleText\">\n    </nx-mobile-toggle-button>\n    <ng-content select=\"nx-error\" *ngIf=\"errorState\"></ng-content>\n</label>\n", styles: [":host{display:inline-block;vertical-align:top;position:relative}:host:not(.is-responsive){opacity:.9999}:host .nx-circle-toggle__input{opacity:0;position:absolute}:host:not(.in-group){margin-right:64px}@media (max-width: 703px){:host:not(.in-group){margin-right:48px}}[dir=rtl] :host:not(.in-group){margin-right:0;margin-right:initial;margin-left:64px}@media (max-width: 703px){[dir=rtl] :host:not(.in-group){margin-right:0;margin-right:initial;margin-left:48px}}:host .nx-circle-toggle__input.cdk-keyboard-focused+.nx-circle-toggle__label ::ng-deep .nx-toggle-circle__icon-wrapper,:host .nx-circle-toggle__input.cdk-keyboard-focused+.nx-circle-toggle__label ::ng-deep .nx-toggle-circle__check-focus{box-shadow:var(--focus-box-shadow)}@media screen and (-ms-high-contrast: active),(forced-colors: active){:host .nx-circle-toggle__input.cdk-keyboard-focused+.nx-circle-toggle__label ::ng-deep .nx-toggle-circle__icon-wrapper,:host .nx-circle-toggle__input.cdk-keyboard-focused+.nx-circle-toggle__label ::ng-deep .nx-toggle-circle__check-focus{box-shadow:0 0 0 2px background,0 0 0 6px windowText;outline:4px solid CanvasText;outline-offset:2px}}:host .nx-circle-toggle__input.cdk-keyboard-focused+.nx-circle-toggle__label ::ng-deep nx-mobile-toggle-button{box-shadow:var(--focus-box-shadow);z-index:1}@media screen and (-ms-high-contrast: active),(forced-colors: active){:host .nx-circle-toggle__input.cdk-keyboard-focused+.nx-circle-toggle__label ::ng-deep nx-mobile-toggle-button{box-shadow:0 0 0 2px background,0 0 0 6px windowText;outline:4px solid CanvasText;outline-offset:2px}}:host(.has-error) ::ng-deep .is-flipped .nx-toggle-circle__check-icon,:host(.has-error) ::ng-deep .is-flipped .nx-toggle-circle__icon-wrapper{background-color:var(--danger)!important}:host(.has-error) ::ng-deep .nx-toggle-circle__icon-wrapper{border-color:var(--danger)!important}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.NxCircleToggleGroupComponent, decorators: [{
                    type: Optional
                }] }, { type: i2.UniqueSelectionDispatcher }, { type: i0.ChangeDetectorRef }, { type: i3.FocusMonitor }, { type: i4.NgControl, decorators: [{
                    type: Optional
                }, {
                    type: Self
                }] }]; }, propDecorators: { _nativeInput: [{
                type: ViewChild,
                args: ['input']
            }], name: [{
                type: Input
            }], checkedChange: [{
                type: Output
            }], selectionChange: [{
                type: Output
            }], checked: [{
                type: Input
            }], value: [{
                type: Input
            }], iconName: [{
                type: Input,
                args: ['icon']
            }], svg: [{
                type: Input
            }], svgChecked: [{
                type: Input
            }], circleText: [{
                type: Input
            }], label: [{
                type: Input
            }], hint: [{
                type: Input
            }], negative: [{
                type: Input
            }], responsive: [{
                type: Input
            }], disabled: [{
                type: Input
            }], toggleButton: [{
                type: ViewChild,
                args: [NxMobileToggleButtonComponent, { static: true }]
            }], onMouseEnter: [{
                type: HostListener,
                args: ['mouseenter']
            }], onMouseLeave: [{
                type: HostListener,
                args: ['mouseleave']
            }], onTouchStart: [{
                type: HostListener,
                args: ['touchstart']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2lyY2xlLXRvZ2dsZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9uZy1hcXVpbGEvc3JjL2NpcmNsZS10b2dnbGUvY2lyY2xlLXRvZ2dsZS9jaXJjbGUtdG9nZ2xlLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL25nLWFxdWlsYS9zcmMvY2lyY2xlLXRvZ2dsZS9jaXJjbGUtdG9nZ2xlL2NpcmNsZS10b2dnbGUuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFnQixxQkFBcUIsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBRTVFLE9BQU8sRUFFSCx1QkFBdUIsRUFFdkIsU0FBUyxFQUdULFlBQVksRUFDWixVQUFVLEVBQ1YsWUFBWSxFQUNaLEtBQUssRUFHTCxRQUFRLEVBQ1IsTUFBTSxFQUNOLElBQUksRUFDSixTQUFTLEdBQ1osTUFBTSxlQUFlLENBQUM7QUFJdkIsT0FBTyxFQUFFLDZCQUE2QixFQUFFLE1BQU0sd0RBQXdELENBQUM7QUFDdkcsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFDOzs7Ozs7Ozs7QUFFL0MsTUFBTSxPQUFPLGlCQUFpQjtJQU8xQixZQUFZLE1BQW9CLEVBQUUsS0FBYTtRQUMzQyxJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztRQUNyQixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztJQUN2QixDQUFDO0NBQ0o7QUFFRCxJQUFJLE1BQU0sR0FBRyxDQUFDLENBQUM7QUFxQmYsTUFBTSxPQUFPLHVCQUF3QixTQUFRLFlBQVk7SUFvT3JEO0lBQ0ksb0JBQW9CLENBQW9CLFdBQWdELEVBQ2hGLGtCQUE2QyxFQUM3QyxJQUF1QixFQUN2QixhQUEyQixFQUNSLFNBQTJCO1FBRXRELEtBQUssRUFBRSxDQUFDO1FBTmdDLGdCQUFXLEdBQVgsV0FBVyxDQUFxQztRQUNo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QkFBdkMsWUFBWTt1QkFBQyxZQUFZO2dCQU9FLFlBQVk7c0JBQXZDLFlBQVk7dUJBQUMsWUFBWTtnQkFPRSxZQUFZO3NCQUF2QyxZQUFZO3VCQUFDLFlBQVkiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBGb2N1c01vbml0b3IsIEZvY3VzT3JpZ2luIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2ExMXknO1xuaW1wb3J0IHsgQm9vbGVhbklucHV0LCBjb2VyY2VCb29sZWFuUHJvcGVydHkgfSBmcm9tICdAYW5ndWxhci9jZGsvY29lcmNpb24nO1xuaW1wb3J0IHsgVW5pcXVlU2VsZWN0aW9uRGlzcGF0Y2hlciB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9jb2xsZWN0aW9ucyc7XG5pbXBvcnQge1xuICAgIEFmdGVyVmlld0luaXQsXG4gICAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gICAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgQ29tcG9uZW50LFxuICAgIERvQ2hlY2ssXG4gICAgRWxlbWVudFJlZixcbiAgICBFdmVudEVtaXR0ZXIsXG4gICAgZm9yd2FyZFJlZixcbiAgICBIb3N0TGlzdGVuZXIsXG4gICAgSW5wdXQsXG4gICAgT25EZXN0cm95LFxuICAgIE9uSW5pdCxcbiAgICBPcHRpb25hbCxcbiAgICBPdXRwdXQsXG4gICAgU2VsZixcbiAgICBWaWV3Q2hpbGQsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29udHJvbFZhbHVlQWNjZXNzb3IsIE5nQ29udHJvbCB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcblxuaW1wb3J0IHsgTnhDaXJjbGVUb2dnbGVHcm91cENvbXBvbmVudCB9IGZyb20gJy4uL2NpcmNsZS10b2dnbGUtZ3JvdXAvY2lyY2xlLXRvZ2dsZS1ncm91cC5jb21wb25lbnQnO1xuaW1wb3J0IHsgTnhNb2JpbGVUb2dnbGVCdXR0b25Db21wb25lbnQgfSBmcm9tICcuLi9tb2JpbGUtdG9nZ2xlLWJ1dHRvbi9tb2JpbGUtdG9nZ2xlLWJ1dHRvbi5jb21wb25lbnQnO1xuaW1wb3J0IHsgVG9nZ2xlQnV0dG9uIH0gZnJvbSAnLi90b2dnbGUtYnV0dG9uJztcblxuZXhwb3J0IGNsYXNzIFRvZ2dsZUNoYW5nZUV2ZW50IHtcbiAgICAvKiogQSB0b2dnbGUgYnV0dG9uICovXG4gICAgYnV0dG9uOiBUb2dnbGVCdXR0b247XG5cbiAgICAvKiogVGhlIHZhbHVlIG9mIHRoZSB0b2dnbGUgYnV0dG9uIHRoYXQgaXMgc2VudCB3aXRoIHRoZSBldmVudC4gKi9cbiAgICB2YWx1ZTogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IoYnV0dG9uOiBUb2dnbGVCdXR0b24sIHZhbHVlOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5idXR0b24gPSBidXR0b247XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB9XG59XG5cbmxldCBuZXh0SWQgPSAwO1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ254LWNpcmNsZS10b2dnbGUnLFxuICAgIHRlbXBsYXRlVXJsOiAnY2lyY2xlLXRvZ2dsZS5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJ2NpcmNsZS10b2dnbGUuY29tcG9uZW50LnNjc3MnXSxcbiAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgICBwcm92aWRlcnM6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgcHJvdmlkZTogVG9nZ2xlQnV0dG9uLFxuICAgICAgICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gTnhDaXJjbGVUb2dnbGVDb21wb25lbnQpLFxuICAgICAgICB9LFxuICAgIF0sXG4gICAgaG9zdDoge1xuICAgICAgICAnW2NsYXNzLm54LXRvZ2dsZS1jaXJjbGVdJzogJ3RydWUnLFxuICAgICAgICAnW2NsYXNzLmluLWdyb3VwXSc6ICdpbkdyb3VwJyxcbiAgICAgICAgJ1tjbGFzcy5pcy1kaXNhYmxlZF0nOiAnZGlzYWJsZWQnLFxuICAgICAgICAnW2NsYXNzLmlzLXJlc3BvbnNpdmVdJzogJ3Jlc3BvbnNpdmUnLFxuICAgICAgICAnW2NsYXNzLmhhcy1lcnJvcl0nOiAnZXJyb3JTdGF0ZScsXG4gICAgfSxcbn0pXG5leHBvcnQgY2xhc3MgTnhDaXJjbGVUb2dnbGVDb21wb25lbnQgZXh0ZW5kcyBUb2dnbGVCdXR0b24gaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSwgQWZ0ZXJWaWV3SW5pdCwgQ29udHJvbFZhbHVlQWNjZXNzb3IsIERvQ2hlY2sge1xuICAgIHByaXZhdGUgX2lkID0gYHRvZ2dsZS1idXR0b24tJHtuZXh0SWQrK31gO1xuXG4gICAgQFZpZXdDaGlsZCgnaW5wdXQnKSBfbmF0aXZlSW5wdXQhOiBFbGVtZW50UmVmPEhUTUxFbGVtZW50PjtcblxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgaW5Hcm91cCA9IGZhbHNlO1xuXG4gICAgZXJyb3JTdGF0ZSA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogSWQgb2YgdGhlIGNpcmNsZSB0b2dnbGUuXG4gICAgICpcbiAgICAgKiBJZiBub3Qgc2V0LCB0aGUgY2lyY2xlIHRvZ2dsZSBnZXRzIGFuIGluY3JlbWVudGVkIHZhbHVlIGJ5IGRlZmF1bHQuXG4gICAgICovXG4gICAgc2V0IGlkKHZhbHVlOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5faWQgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5fY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICBnZXQgaWQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lkO1xuICAgIH1cblxuICAgIHByaXZhdGUgX25hbWU6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuXG4gICAgLyoqIE5hbWUgdGhhdCBpcyB1c2VkIGZvciBhY2Nlc3NpYmlsaXR5LiAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2V0IG5hbWUodmFsdWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLl9uYW1lID0gdmFsdWU7XG4gICAgICAgIHRoaXMuX2Nkci5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX25hbWUgYXMgc3RyaW5nO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFuIGV2ZW50IHRoYXQgaXMgZW1pdHRlZCB3aGVuIHRoZSBjaGVja2VkIHN0YXRlIGZvIHRoZSBjaXJjbGUgdG9nZ2xlIGNoYW5nZXMuXG4gICAgICovXG4gICAgQE91dHB1dCgpXG4gICAgY2hlY2tlZENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8Ym9vbGVhbj4oKTtcblxuICAgIC8qKlxuICAgICAqIEFuIGV2ZW50IHRoYXQgaXMgZW1pdHRlZCB3aGVuIHRoZSBjaGVja2VkIHN0YXRlIG9mIHRoZSBjaXJjbGUgdG9nZ2xlIGNoYW5nZXMuXG4gICAgICogVGhlIGV2ZW50IG9iamVjdCBjb250YWlucyB0aGUgY2lyY2xlIHRvZ2dsZSBpdHNlbGYgYW5kIGl0cyB2YWx1ZSAoc2VlIFRvZ2dsZUNoYW5nZUV2ZW50KS5cbiAgICAgKi9cbiAgICBAT3V0cHV0KClcbiAgICBzZWxlY3Rpb25DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPFRvZ2dsZUNoYW5nZUV2ZW50PigpO1xuXG4gICAgX2NoZWNrZWQgPSBmYWxzZTtcbiAgICAvKiogV2hldGhlciB0aGUgY2lyY2xlIHRvZ2dsZSBpcyBjaGVja2VkLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2V0IGNoZWNrZWQodmFsdWU6IEJvb2xlYW5JbnB1dCkge1xuICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IGNvZXJjZUJvb2xlYW5Qcm9wZXJ0eSh2YWx1ZSk7XG4gICAgICAgIGlmICh0aGlzLmNoZWNrZWQgIT09IG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9jaGVja2VkID0gbmV3VmFsdWU7XG4gICAgICAgICAgICB0aGlzLl9jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGNoZWNrZWQoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jaGVja2VkO1xuICAgIH1cblxuICAgIHByaXZhdGUgX3ZhbHVlOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuICAgIC8qKiBUaGUgdmFsdWUgdGhhdCBpcyB1c2VkIGluIHRoZSBtb2RlbC4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNldCB2YWx1ZShuZXdWYWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX3ZhbHVlID0gbmV3VmFsdWU7XG4gICAgICAgIHRoaXMuX2Nkci5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG4gICAgZ2V0IHZhbHVlKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLl92YWx1ZSBhcyBzdHJpbmc7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfaWNvbk5hbWU6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICAgIC8qKiBJZCBvZiB0aGUgaWNvbiB0aGF0IHNob3VsZCBiZSBkaXNwbGF5ZWQuICovXG4gICAgQElucHV0KCdpY29uJylcbiAgICBzZXQgaWNvbk5hbWUobmFtZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX2ljb25OYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5fY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICBnZXQgaWNvbk5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ljb25OYW1lIGFzIHN0cmluZztcbiAgICB9XG5cbiAgICBwcml2YXRlIF9zdmc6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuXG4gICAgLyoqIFNWRyB0aGF0IGlzIGRpc3BsYXllZCBpZiB0aGUgY2lyY2xlIHRvZ2dsZSBpcyB1bmNoZWNrZWQuICovXG4gICAgQElucHV0KClcbiAgICBzZXQgc3ZnKHNyYzogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX3N2ZyA9IHNyYztcbiAgICAgICAgdGhpcy5fY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICBnZXQgc3ZnKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdmcgYXMgc3RyaW5nO1xuICAgIH1cblxuICAgIHByaXZhdGUgX3N2Z0NoZWNrZWQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuXG4gICAgLyoqIFNWRyB0aGF0IGlzIGRpc3BsYXllZCBpZiB0aGUgY2lyY2xlIHRvZ2dsZSBpcyBjaGVja2VkLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2V0IHN2Z0NoZWNrZWQoc3JjOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5fc3ZnQ2hlY2tlZCA9IHNyYztcbiAgICAgICAgdGhpcy5fY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICBnZXQgc3ZnQ2hlY2tlZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3ZnQ2hlY2tlZCBhcyBzdHJpbmc7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfY2lyY2xlVGV4dDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbiAgICAvKiogQSB0ZXh0IHRoYXQgaXMgZGlzcGxheWVkIGluc2lkZSB0aGUgY2lyY2xlIHRvZ2dsZS4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNldCBjaXJjbGVUZXh0KHZhbHVlOiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLl9jaXJjbGVUZXh0KSB7XG4gICAgICAgICAgICB0aGlzLl9jaXJjbGVUZXh0ID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLl9jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGNpcmNsZVRleHQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NpcmNsZVRleHQgYXMgc3RyaW5nO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2xhYmVsOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuICAgIC8qKiBMYWJlbCBkaXNwbGF5ZWQgYmVsb3cgdGhlIGNpcmNsZS4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNldCBsYWJlbCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX2xhYmVsID0gdmFsdWU7XG4gICAgICAgIHRoaXMuX2Nkci5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG4gICAgZ2V0IGxhYmVsKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sYWJlbCBhcyBzdHJpbmc7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfaGludDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbiAgICAvKiogQWRkaXRpb25hbCBoaW50IGRpc3BsYXllZCBiZWxvdyB0aGUgbGFiZWwuICovXG4gICAgQElucHV0KClcbiAgICBzZXQgaGludCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX2hpbnQgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5fY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICBnZXQgaGludCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5faGludCBhcyBzdHJpbmc7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfbmVnYXRpdmU6IGJvb2xlYW4gfCB1bmRlZmluZWQ7XG5cbiAgICAvKiogV2hldGhlciB0aGUgY2lyY2xlIHRvZ2dsZSB1c2VzIHRoZSBuZWdhdGl2ZSBzZXQgb2Ygc3R5bGluZy4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNldCBuZWdhdGl2ZSh2YWx1ZTogQm9vbGVhbklucHV0KSB7XG4gICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gY29lcmNlQm9vbGVhblByb3BlcnR5KHZhbHVlKTtcbiAgICAgICAgaWYgKHRoaXMubmVnYXRpdmUgIT09IG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9uZWdhdGl2ZSA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IG5lZ2F0aXZlKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gISF0aGlzLl9uZWdhdGl2ZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9yZXNwb25zaXZlOiBib29sZWFuIHwgdW5kZWZpbmVkO1xuXG4gICAgLyoqIFdoZXRoZXIgdGhlIGNpcmNsZSB0b2dnbGUgaGFzIGEgcmVzcG9uc2l2ZSBiZWhhdmlvci4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNldCByZXNwb25zaXZlKHZhbHVlOiBCb29sZWFuSW5wdXQpIHtcbiAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBjb2VyY2VCb29sZWFuUHJvcGVydHkodmFsdWUpO1xuICAgICAgICBpZiAodGhpcy5yZXNwb25zaXZlICE9PSBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fcmVzcG9uc2l2ZSA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IHJlc3BvbnNpdmUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAhIXRoaXMuX3Jlc3BvbnNpdmU7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfZGlzYWJsZWQ6IGJvb2xlYW4gfCB1bmRlZmluZWQ7XG5cbiAgICAvKiogV2hldGhlciB0aGUgY2lyY2xlIHRvZ2dsZSBpcyBkaXNhYmxlZC4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNldCBkaXNhYmxlZCh2YWx1ZTogQm9vbGVhbklucHV0KSB7XG4gICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gY29lcmNlQm9vbGVhblByb3BlcnR5KHZhbHVlKTtcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQgIT09IG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9kaXNhYmxlZCA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IGRpc2FibGVkKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gISF0aGlzLl9kaXNhYmxlZDtcbiAgICB9XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIEBWaWV3Q2hpbGQoTnhNb2JpbGVUb2dnbGVCdXR0b25Db21wb25lbnQsIHsgc3RhdGljOiB0cnVlIH0pXG4gICAgdG9nZ2xlQnV0dG9uITogTnhNb2JpbGVUb2dnbGVCdXR0b25Db21wb25lbnQ7XG5cbiAgICBwcml2YXRlIF9ob3ZlciA9IGZhbHNlO1xuXG4gICAgLyoqIHRvdWNoZWQgaXMgc2V0IHRvIHRydWUgb24gdG91Y2ggZGV2aWNlcy4gKi9cbiAgICBfdG91Y2hlZCA9IGZhbHNlO1xuXG4gICAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgICBASG9zdExpc3RlbmVyKCdtb3VzZWVudGVyJykgb25Nb3VzZUVudGVyKCkge1xuICAgICAgICBpZiAoIXRoaXMuX3RvdWNoZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX2hvdmVyID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgQEhvc3RMaXN0ZW5lcignbW91c2VsZWF2ZScpIG9uTW91c2VMZWF2ZSgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl90b3VjaGVkKSB7XG4gICAgICAgICAgICB0aGlzLl9ob3ZlciA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgICBASG9zdExpc3RlbmVyKCd0b3VjaHN0YXJ0Jykgb25Ub3VjaFN0YXJ0KCkge1xuICAgICAgICB0aGlzLl90b3VjaGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBfcmVtb3ZlVW5pcXVlU2VsZWN0aW9uTGlzdGVuZXI6ICgpID0+IHZvaWQgPSAoKSA9PiB7fTtcblxuICAgIHByaXZhdGUgb25DaGFuZ2VDYWxsYmFjayA9IChjaGVja2VkOiBib29sZWFuKSA9PiB7fTtcbiAgICBwcml2YXRlIG9uVG91Y2hlZENhbGxiYWNrID0gKCkgPT4ge307XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgLyoqIEBkb2NzLXByaXZhdGUgKi8gQE9wdGlvbmFsKCkgcHVibGljIHRvZ2dsZUdyb3VwOiBOeENpcmNsZVRvZ2dsZUdyb3VwQ29tcG9uZW50IHwgbnVsbCxcbiAgICAgICAgcHJpdmF0ZSBfY2hlY2tlZERpc3BhdGNoZXI6IFVuaXF1ZVNlbGVjdGlvbkRpc3BhdGNoZXIsXG4gICAgICAgIHByaXZhdGUgX2NkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgICAgIHByaXZhdGUgX2ZvY3VzTW9uaXRvcjogRm9jdXNNb25pdG9yLFxuICAgICAgICBAT3B0aW9uYWwoKSBAU2VsZigpIHB1YmxpYyBuZ0NvbnRyb2w6IE5nQ29udHJvbCB8IG51bGwsXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgaWYgKHRoaXMudG9nZ2xlR3JvdXApIHtcbiAgICAgICAgICAgIHRoaXMubmFtZSA9IHRoaXMudG9nZ2xlR3JvdXAubmFtZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5uZ0NvbnRyb2wpIHtcbiAgICAgICAgICAgIC8vIE5vdGU6IHdlIHByb3ZpZGUgdGhlIHZhbHVlIGFjY2Vzc29yIHRocm91Z2ggaGVyZSwgaW5zdGVhZCBvZlxuICAgICAgICAgICAgLy8gdGhlIGBwcm92aWRlcnNgIHRvIGF2b2lkIHJ1bm5pbmcgaW50byBhIGNpcmN1bGFyIGltcG9ydC5cbiAgICAgICAgICAgIHRoaXMubmdDb250cm9sLnZhbHVlQWNjZXNzb3IgPSB0aGlzO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIGlmICh0aGlzLnRvZ2dsZUdyb3VwKSB7XG4gICAgICAgICAgICB0aGlzLmF0dGFjaExpc3RlbmVyRm9yR3JvdXAoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG5nRG9DaGVjaygpIHtcbiAgICAgICAgaWYgKHRoaXMubmdDb250cm9sKSB7XG4gICAgICAgICAgICAvLyBXZSBuZWVkIHRvIHJlLWV2YWx1YXRlIHRoaXMgb24gZXZlcnkgY2hhbmdlIGRldGVjdGlvbiBjeWNsZSwgYmVjYXVzZSB0aGVyZSBhcmUgc29tZVxuICAgICAgICAgICAgLy8gZXJyb3IgdHJpZ2dlcnMgdGhhdCB3ZSBjYW4ndCBzdWJzY3JpYmUgdG8gKGUuZy4gcGFyZW50IGZvcm0gc3VibWlzc2lvbnMpLiBUaGlzIG1lYW5zXG4gICAgICAgICAgICAvLyB0aGF0IHdoYXRldmVyIGxvZ2ljIGlzIGluIGhlcmUgaGFzIHRvIGJlIHN1cGVyIGxlYW4gb3Igd2UgcmlzayBkZXN0cm95aW5nIHRoZSBwZXJmb3JtYW5jZS5cbiAgICAgICAgICAgIHRoaXMuZXJyb3JTdGF0ZSA9ICF0aGlzLm5nQ29udHJvbC52YWxpZDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy50b2dnbGVHcm91cCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5Hcm91cCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5uZWdhdGl2ZSA9IHRoaXMudG9nZ2xlR3JvdXAubmVnYXRpdmU7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlZCA9IHRoaXMudG9nZ2xlR3JvdXAuZGlzYWJsZWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNwb25zaXZlID0gdGhpcy50b2dnbGVHcm91cC5yZXNwb25zaXZlO1xuICAgICAgICAgICAgICAgIHRoaXMuaWQgPSB0aGlzLnRvZ2dsZUdyb3VwLmlkICsgYC1idXR0b24tJHtuZXh0SWQrK31gO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9mb2N1c01vbml0b3IubW9uaXRvcih0aGlzLl9uYXRpdmVJbnB1dCk7XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIC8vIGZ1bmN0aW9uIHJldHVybmVkIGJ5IHRoZSBsaXN0ZW5lclxuICAgICAgICB0aGlzLl9yZW1vdmVVbmlxdWVTZWxlY3Rpb25MaXN0ZW5lcigpO1xuICAgICAgICB0aGlzLl9mb2N1c01vbml0b3Iuc3RvcE1vbml0b3JpbmcodGhpcy5fbmF0aXZlSW5wdXQpO1xuICAgIH1cblxuICAgIC8qKiBAZG9jcy1wcml2YXRlICovXG4gICAgYXR0YWNoTGlzdGVuZXJGb3JHcm91cCgpIHtcbiAgICAgICAgdGhpcy5fcmVtb3ZlVW5pcXVlU2VsZWN0aW9uTGlzdGVuZXIgPSB0aGlzLl9jaGVja2VkRGlzcGF0Y2hlci5saXN0ZW4oKGdyb3VwSWQ6IHN0cmluZywgYnV0dG9uSWQ6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuaWQgIT09IGJ1dHRvbklkICYmIGdyb3VwSWQgPT09IHRoaXMudG9nZ2xlR3JvdXA/LmlkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHdyaXRlVmFsdWUobmV3VmFsdWU6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jaGVja2VkID0gbmV3VmFsdWU7XG4gICAgfVxuXG4gICAgcmVnaXN0ZXJPbkNoYW5nZShmbjogYW55KTogdm9pZCB7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayA9IGZuO1xuICAgIH1cblxuICAgIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiBhbnkpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjayA9IGZuO1xuICAgIH1cblxuICAgIHNldERpc2FibGVkU3RhdGU/KGlzRGlzYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7XG4gICAgfVxuXG4gICAgLyoqIEZvY3VzZXMgdGhlIHJhZGlvIGJ1dHRvbiBlbGVtZW50LiAqL1xuICAgIGZvY3VzKGZvY3VzT3JpZ2luPzogRm9jdXNPcmlnaW4pIHtcbiAgICAgICAgdGhpcy5fZm9jdXNNb25pdG9yLmZvY3VzVmlhKHRoaXMuX25hdGl2ZUlucHV0LCBmb2N1c09yaWdpbiBhcyBGb2N1c09yaWdpbik7XG4gICAgfVxuXG4gICAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgICB0b2dnbGUoZXZlbnQ6IEV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIC8vIFRPRE8gc2ltcGxpZnkgaWYgc3RhdGVtZW50XG4gICAgICAgIGlmICghKCh0aGlzLnRvZ2dsZUdyb3VwICYmIHRoaXMuY2hlY2tlZCkgfHwgdGhpcy5kaXNhYmxlZCkpIHtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tlZCA9ICF0aGlzLmNoZWNrZWQ7XG4gICAgICAgICAgICB0aGlzLm9uQ2hhbmdlQ2FsbGJhY2sodGhpcy5jaGVja2VkKTtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tlZENoYW5nZS5lbWl0KHRoaXMuY2hlY2tlZCk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbkNoYW5nZS5lbWl0KG5ldyBUb2dnbGVDaGFuZ2VFdmVudCh0aGlzLCB0aGlzLnZhbHVlKSk7XG4gICAgICAgICAgICBpZiAodGhpcy50b2dnbGVHcm91cCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrZWREaXNwYXRjaGVyLm5vdGlmeSh0aGlzLnRvZ2dsZUdyb3VwLmlkLCB0aGlzLmlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBkb2NzLXByaXZhdGVcbiAgICAgKlxuICAgICAqIG1ldGhvZCBjYWxsZWQgYnkgdGhlIGdyb3VwIGlmIHRoZSBpbnRlcm5hbCB2YWx1ZSBvZiB0aGUgZ3JvdXAgaXMgY2hhbmdlZCBwcm9ncmFtYXRpY2FsbHksXG4gICAgICogZG9lcyBub3QgdHJpZ2dlciBjaGFuZ2UgZW1pc3Npb25cbiAgICAgKi9cbiAgICBzZXRHcm91cFNlbGVjdGlvbigpIHtcbiAgICAgICAgaWYgKCF0aGlzLnRvZ2dsZUdyb3VwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gcHJvcGFnYXRlIGNoYW5nZXMgb25seSBpZiB0aGUgdmFsdWUgaW4gdGhlIGdyb3VwIGlzIGRpZmZlcmVudCB0aGFuIHRoZSBidXR0b24gY2hlY2tlZCB2YWx1ZVxuICAgICAgICBpZiAoIXRoaXMuY2hlY2tlZCkge1xuICAgICAgICAgICAgdGhpcy5jaGVja2VkID0gIXRoaXMuY2hlY2tlZDtcbiAgICAgICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayh0aGlzLmNoZWNrZWQpO1xuICAgICAgICAgICAgdGhpcy5fY2hlY2tlZERpc3BhdGNoZXIubm90aWZ5KHRoaXMudG9nZ2xlR3JvdXAuaWQsIHRoaXMuaWQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgICBnZXQgc3ZnQnV0dG9uKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gISF0aGlzLnN2ZyAmJiAhIXRoaXMuc3ZnQ2hlY2tlZDtcbiAgICB9XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIGdldCBzdmdVcmwoKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IHVzZUZpbGxlZFN2ZyA9IHRoaXMuY2hlY2tlZCB8fCAoIXRoaXMuZGlzYWJsZWQgJiYgdGhpcy5faG92ZXIpO1xuICAgICAgICBpZiAodGhpcy5uZWdhdGl2ZSkge1xuICAgICAgICAgICAgdXNlRmlsbGVkU3ZnID0gIXVzZUZpbGxlZFN2ZztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdXNlRmlsbGVkU3ZnID8gdGhpcy5zdmdDaGVja2VkIDogdGhpcy5zdmc7XG4gICAgfVxuXG4gICAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgICBnZXQgdHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9nZ2xlR3JvdXAgPyAncmFkaW8nIDogJ2NoZWNrYm94JztcbiAgICB9XG5cbiAgICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICAgIGhhbmRsZUVudGVyS2V5KGV2ZW50OiBFdmVudCkge1xuICAgICAgICBpZiAoIXRoaXMudG9nZ2xlR3JvdXApIHtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlKGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsIjxpbnB1dFxuICAgICNpbnB1dFxuICAgIFtpZF09XCJpZCArICctaW5wdXQnXCJcbiAgICBjbGFzcz1cIm54LWNpcmNsZS10b2dnbGVfX2lucHV0XCJcbiAgICBbYXR0ci5hcmlhLWxhYmVsbGVkYnldPVwiaWQgKyAnLWxhYmVsJ1wiXG4gICAgW3R5cGVdPVwidHlwZVwiXG4gICAgW2F0dHIubmFtZV09XCJuYW1lXCJcbiAgICBbY2hlY2tlZF09XCJjaGVja2VkXCJcbiAgICBbZGlzYWJsZWRdPVwiZGlzYWJsZWRcIlxuICAgIFthdHRyLmFyaWEtY2hlY2tlZF09XCJjaGVja2VkXCJcbiAgICAoa2V5ZG93bi5lbnRlcik9XCJoYW5kbGVFbnRlcktleSgkZXZlbnQpXCJcbiAgICAoY2xpY2spPVwidG9nZ2xlKCRldmVudClcIlxuLz5cbjxsYWJlbCBjbGFzcz1cIm54LWNpcmNsZS10b2dnbGVfX2xhYmVsXCIgW2Zvcl09XCJpZCArICctaW5wdXQnXCIgW2lkXT1cImlkICsgJy1sYWJlbCdcIj5cbiAgICA8bngtaWNvbi10b2dnbGUtYnV0dG9uXG4gICAgICAgIFtsYWJlbF09XCJsYWJlbFwiXG4gICAgICAgIFtoaW50XT1cImhpbnRcIlxuICAgICAgICBbY2hlY2tlZF09XCJjaGVja2VkXCJcbiAgICAgICAgW2ljb25dPVwiaWNvbk5hbWVcIlxuICAgICAgICBbbmVnYXRpdmVdPVwibmVnYXRpdmVcIlxuICAgICAgICBbc3ZnXT1cInN2Z1VybFwiXG4gICAgICAgIFtkaXNhYmxlZF09XCJkaXNhYmxlZFwiXG4gICAgICAgIFtpbkdyb3VwXT1cImluR3JvdXBcIlxuICAgICAgICBbdG91Y2hlZF09XCJfdG91Y2hlZFwiXG4gICAgICAgIFtjaXJjbGVUZXh0XT1cImNpcmNsZVRleHRcIlxuICAgID5cbiAgICA8L254LWljb24tdG9nZ2xlLWJ1dHRvbj5cbiAgICA8IS0tIFRoZSBtb2JpbGUgdG9nZ2xlIGJ1dHRvbiBpcyBuZWVkZWQgZm9yIHRoZSByZXNwb25zaXZlIG1vYmlsZSB2ZXJzaW9uIG9mIHRoZSBjb21wb25lbnQuXG4gICAgVGhlIGRpc3BsYXkgc3d0aWNoIGlzIGhhbmRsZWQgaW4gdGhlIGNzcy4gLS0+XG4gICAgPG54LW1vYmlsZS10b2dnbGUtYnV0dG9uIFtsYWJlbF09XCJsYWJlbFwiIFtoaW50XT1cImhpbnRcIiBbY2hlY2tlZF09XCJjaGVja2VkXCIgW25lZ2F0aXZlXT1cIm5lZ2F0aXZlXCIgW2Rpc2FibGVkXT1cImRpc2FibGVkXCIgW2NpcmNsZVRleHRdPVwiY2lyY2xlVGV4dFwiPlxuICAgIDwvbngtbW9iaWxlLXRvZ2dsZS1idXR0b24+XG4gICAgPG5nLWNvbnRlbnQgc2VsZWN0PVwibngtZXJyb3JcIiAqbmdJZj1cImVycm9yU3RhdGVcIj48L25nLWNvbnRlbnQ+XG48L2xhYmVsPlxuIl19